import{_ as e}from"./BaseInput.vue-iInHQMIA.js";import{a as s,ad as a,z as l,r as t,S as i,c as r,E as n,b as d,e as o,w as u,u as m,an as c,o as f,p,f as x,t as v,F as g,B as h,af as w,O as y,q as k,k as j,x as b,X as _,s as P,Y as C,ag as V,_ as B,g as $,ao as F}from"../e/entry-8qgg5CL-.js";import{_ as N}from"./BasePagination.vue-eKZkqxB7.js";import{_ as S}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as q}from"./usePermissions-zbVS2zgJ.js";import{_ as z,a as L}from"./placeholder-search-1-dark-6GG3FkNl.js";import{z as T,u as U,t as A,F as E}from"./vee-validate.esm-n59zZCC5.js";import"./input-id-wZ-Ta08j.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";const I={class:"pb-10"},M={class:"w-full"},O={key:0,class:"space-y-4"},R={class:"flex flex-col items-center justify-center gap-3 text-center sm:flex-row sm:justify-start sm:text-left"},W={class:"space-y-2"},X={class:"flex flex-col gap-4 pt-4 sm:ms-auto sm:flex-row sm:items-center sm:justify-end sm:pt-0"},Y={class:"flex w-full items-center justify-center sm:w-[160px] sm:justify-end"},D={class:"ptablet:hidden divide-muted-200 dark:divide-muted-700 flex items-center justify-center divide-x"},G={class:"flex flex-col gap-1 px-4 text-center"},H={class:"flex flex-col gap-1 px-4 text-center"},J={class:"flex flex-col gap-1 px-4 text-center"},K={class:"ptablet:hidden flex w-full items-center justify-center gap-1 py-3 sm:w-[160px] sm:justify-end sm:py-0"},Q={class:"sm:ms-6"},Z={key:1},ee=x("img",{class:"block dark:hidden",src:z,alt:"Placeholder image"},null,-1),se=x("img",{class:"hidden dark:block",src:L,alt:"Placeholder image"},null,-1),ae={key:2,class:"space-y-4"},le={class:"flex flex-col items-center justify-start gap-3 text-center sm:flex-row sm:justify-start sm:text-left"},te={class:"flex flex-col gap-4 pt-4 sm:ms-auto sm:flex-row sm:items-center sm:justify-end sm:pt-0"},ie={class:"divide-muted-200 dark:divide-muted-700 flex items-center justify-center divide-x"},re={class:"flex flex-col gap-1 px-4 text-center"},ne={class:"flex w-full items-center justify-between p-4 md:p-6"},de={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},oe={class:"p-4 md:p-6"},ue={class:"mx-auto w-full text-start"},me={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},ce={class:"p-4 md:p-6"},fe={class:"flex gap-x-2"},pe=s({__name:"index",setup(s){const{activePermission:z,getPermissions:L,createPermission:pe}=q(),{toast:xe}=a(),ve=l(),ge=t(!0);i().getProfile;const he=t(""),we=t(10),ye=r((()=>parseInt(ve.query.page??"1"))),ke=t(!1),je=t([]);async function be(){const e=await L();je.value=e.data.result}n((async()=>{0===je.value.length&&(ge.value=!0,await be(),ge.value=!1)}));const _e=r((()=>je.value&&Array.isArray(je.value)?je.value.filter((e=>e.name.includes(he.value))):[])),Pe=r((()=>{const e=(ye.value-1)*we.value,s=e+we.value;return _e.value.slice(e,s)})),Ce=T.object({name:T.string().nonempty("Name is required")}),Ve=r((()=>({name:""}))),{handleSubmit:Be,isSubmitting:$e,meta:Fe,resetForm:Ne}=U({validationSchema:A(Ce),initialValues:Ve}),Se=Be((async e=>{if(je.value.some((s=>s.name===e.name)))return xe.warning("Permission already exists"),void(ke.value=!1);try{const s=await pe(e);xe.response(s),"success"===s.status&&(Ne(),await be())}catch(s){xe.danger(s)}ke.value=!1}));return(s,a)=>{const l=e,t=b,i=_,r=P,n=C,q=V,z=B,L=$,T=N,U=S,A=F,pe=c;return f(),d("div",I,[o(U,null,{left:u((()=>[o(l,{modelValue:m(he),"onUpdate:modelValue":a[0]||(a[0]=e=>p(he)?he.value=e:null),icon:"lucide:search",placeholder:"Filter permissions...",classes:{wrapper:"w-full sm:w-auto"}},null,8,["modelValue"])])),right:u((()=>[x("div",M,[o(i,{color:"success",class:"w-full",onClick:a[1]||(a[1]=e=>ke.value=!0),flavor:"outline"},{default:u((()=>[o(t,{name:"line-md:plus",class:"h-4 w-4"}),x("span",null,v(s.$t("Create Permission")),1)])),_:1})])])),default:u((()=>[x("div",null,[m(ge)?(f(),d("div",O,[(f(),d(g,null,h(3,(e=>o(n,{key:e,class:"flex flex-col p-5 sm:flex-row sm:items-center"},{default:u((()=>[x("div",R,[o(r,{class:"h-16 w-16 shrink-0 rounded-full"}),x("div",W,[o(r,{class:"mx-auto h-3 w-[100px] rounded-lg sm:mx-0"}),o(r,{class:"mx-auto h-3 w-[75px] rounded-lg sm:mx-0"})])]),x("div",X,[x("div",Y,[o(r,{class:"h-6 w-24 rounded-full"})]),x("div",D,[x("div",G,[o(r,{class:"h-3 w-16 rounded-lg"})]),x("div",H,[o(r,{class:"h-3 w-16 rounded-lg"})]),x("div",J,[o(r,{class:"h-3 w-16 rounded-lg"})])]),x("div",K,[o(r,{class:"h-8 w-8 shrink-0 rounded-full"}),o(r,{class:"h-8 w-8 shrink-0 rounded-full"}),o(r,{class:"hidden h-3 w-12 rounded-full sm:block"})]),x("div",Q,[o(r,{class:"mx-auto h-8 w-40 rounded-lg sm:mx-0 sm:w-20"})])])])),_:2},1024))),64))])):m(ge)||0!==m(Pe).length?(f(),d("div",ae,[o(w,{"enter-active-class":"transform-gpu","enter-from-class":"opacity-0 -translate-x-full","enter-to-class":"opacity-100 translate-x-0","leave-active-class":"absolute transform-gpu","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 -translate-x-full"},{default:u((()=>[(f(!0),d(g,null,h(m(Pe),(e=>(f(),y(n,{key:e.id,class:"flex flex-col p-5 sm:flex-row sm:items-center"},{default:u((()=>[x("div",le,[o(z,{tag:"h3",size:"sm",weight:"medium",class:"text-muted-800 dark:text-muted-100"},{default:u((()=>[k(v(e.name),1)])),_:2},1024)]),x("div",te,[x("div",ie,[x("div",re,[o(z,{tag:"h3",size:"md",weight:"semibold",class:"text-muted-800 dark:text-muted-100"},{default:u((()=>[x("span",null,v(e.rolepermission?.length??0),1)])),_:2},1024),o(L,{lead:"none",weight:"semibold",class:"text-muted-400 !text-[0.65rem] uppercase"},{default:u((()=>[x("span",null,v(s.$t("Roles")),1)])),_:1})])])])])),_:2},1024)))),128))])),_:1}),x("div",null,[m(je).length>m(we)?(f(),y(T,{key:0,"total-items":m(je).length,"item-per-page":m(we),"current-page":m(ye),shape:"full"},null,8,["total-items","item-per-page","current-page"])):j("",!0)])])):(f(),d("div",Z,[o(q,{title:m(he)&&""!==m(he)?"No matching results":"No results",subtitle:m(he)&&""!==m(he)?"Looks like we couldn't find any matching results for your search terms. Try other search terms.":"Looks like we don't have any data here yet."},{image:u((()=>[ee,se])),_:1},8,["title","subtitle"])]))])])),_:1}),o(pe,{open:m(ke),size:"sm",onClose:a[4]||(a[4]=e=>ke.value=!1)},{header:u((()=>[x("div",ne,[x("h3",de,v(s.$t("Create New Permission")),1),o(A,{onClick:a[2]||(a[2]=e=>ke.value=!1)})])])),footer:u((()=>[x("div",ce,[x("div",fe,[o(i,{onClick:a[3]||(a[3]=e=>ke.value=!1)},{default:u((()=>[k(v(s.$t("Cancel")),1)])),_:1}),o(i,{color:"primary",flavor:"solid",onClick:m(Se),disabled:m($e),loading:m($e)},{default:u((()=>[k(v(s.$t("Create")),1)])),_:1},8,["onClick","disabled","loading"])])])])),default:u((()=>[x("div",oe,[x("div",ue,[x("p",me,v(s.$t("Please provide a unique name for the new permission"))+". ",1),o(m(E),{name:"name"},{default:u((({field:e,errorMessage:s,handleChange:a,handleBlur:t})=>[o(l,{modelValue:e.value,"onUpdate:modelValue":[s=>e.value=s,a],error:s,disabled:m($e),type:"text",label:"Permission Name",placeholder:"Enter permission name",classes:{input:"h-12",wrapper:"max-w-xs"},onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})])])])),_:1},8,["open"])])}}});export{pe as default};
