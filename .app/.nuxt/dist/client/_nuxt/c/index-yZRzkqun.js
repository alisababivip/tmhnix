import{_ as e}from"./BaseInput.vue-iInHQMIA.js";import{_ as a}from"./BaseSelect.vue-p0KYznCX.js";import{a as t,z as l,r as s,c as r,E as o,ad as i,b as u,e as n,w as d,u as f,an as c,o as m,p,f as v,t as h,q as g,O as w,F as b,B as x,k as y,x as _,X as k,C as j,ag as P,ao as $}from"../e/entry-8qgg5CL-.js";import{_ as C,a as N}from"./FlexTableRow.vue-LmGXINIn.js";import{_ as E}from"./FlexTableCell.vue-Rbj2Whgl.js";import{_ as O}from"./BaseTag.vue-NMkN1Uk8.js";import{_ as D,a as I}from"./BaseDropdown.vue-wSpyT9xX.js";import{_ as B}from"./TairoFlexTable-zdoraqRc.js";import{_ as T}from"./BasePagination.vue-eKZkqxB7.js";import{_ as A}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as V}from"./useP2P-NV4dmDWU.js";import{_ as F,a as L}from"./placeholder-search-4-dark-Jht91LnM.js";import{u as R}from"./offers-pCoDOi_A.js";import"./input-id-wZ-Ta08j.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./menu-KWZreDHB.js";import"./use-text-value-9iwzs_EA.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";const G={value:10},U={value:25},q={value:50},z={value:100},M=v("img",{class:"block dark:hidden",src:F,alt:"Placeholder image"},null,-1),S=v("img",{class:"hidden dark:block",src:L,alt:"Placeholder image"},null,-1),W={key:1,class:"w-full"},X=["data-nui-tooltip"],H={class:"mt-6"},J={class:"flex w-full items-center justify-between p-4 md:p-6"},K={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},Q={class:"p-4 md:p-6"},Y={class:"mx-auto w-full text-center"},Z={class:"font-heading text-muted-800 text-lg font-medium leading-6 dark:text-white"},ee={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},ae={class:"p-4 md:p-6"},te={class:"flex gap-x-2"},le=t({__name:"index",setup(t){const F=R(),{updateP2POffer:L}=V(),le=l(),se=s(""),re=s(10),oe=r((()=>parseInt(le.query.page??"1"))),ie=r((()=>F.userOffers.filter((e=>e.currency?.includes(se.value))).map((e=>{const a=e.reviews||[],t=a.reduce(((e,a)=>e+a.rating),0),l=a.length?t/a.length:0;return{...e,avgRating:l}})))),ue=r((()=>{const e=(oe.value-1)*re.value,a=e+re.value;return ie.value.slice(e,a)}));o((async()=>{0===F.userOffers.length&&(F.loading=!0,await F.fetchUserP2POffers(),F.loading=!1)}));const{toast:ne}=i(),de=s(!1),fe=s(!1),ce=s(null);async function me(){if(ce.value){fe.value=!0;try{const e=await L(ce.value?.uuid,"PENDING"===ce.value.status?"ACTIVE":"PENDING");ne.response(e),"success"===e.status&&(await F.fetchUserP2POffers(),await F.fetchP2POffers())}catch(e){ne.danger(e)}de.value=!1,fe.value=!1,ce.value=null}}const pe=e=>{switch(e){case"PENDING":return"warning";case"ACTIVE":case"COMPLETED":return"success";case"CANCELLED":return"danger";default:return"info"}};function ve(e,a){const t=Math.floor(a);return e<=t?"full":e===t+1&&a%1>=.5?"half":"empty"}return(t,l)=>{const s=e,r=a,o=_,i=k,V=j,L=P,R=C,le=E,ne=O,he=D,ge=I,we=N,be=B,xe=T,ye=A,_e=$,ke=c;return m(),u("div",null,[n(ye,null,{left:d((()=>[n(s,{modelValue:f(se),"onUpdate:modelValue":l[0]||(l[0]=e=>p(se)?se.value=e:null),icon:"lucide:search",classes:{wrapper:"w-full sm:w-auto"},placeholder:"Filter offers..."},null,8,["modelValue"]),n(r,{modelValue:f(re),"onUpdate:modelValue":l[1]||(l[1]=e=>p(re)?re.value=e:null),label:"",classes:{wrapper:"w-full sm:w-40"}},{default:d((()=>[v("option",G,"10 "+h(t.$t("per page")),1),v("option",U,"25 "+h(t.$t("per page")),1),v("option",q,"50 "+h(t.$t("per page")),1),v("option",z,"100 "+h(t.$t("per page")),1)])),_:1},8,["modelValue"])])),right:d((()=>[n(V,{to:"/user/p2p/offers/create"},{default:d((()=>[n(i,{color:"primary",block:""},{default:d((()=>[n(o,{name:"line-md:plus",class:"h-4 w-4 mr-2"}),g(" "+h(t.$t("Create Offer")),1)])),_:1})])),_:1})])),default:d((()=>[v("div",null,[f(F).loading||0!==f(ue).length?(m(),u("div",W,[n(be,{class:"pt-5"},{default:d((()=>[(m(!0),u(b,null,x(f(ue),((e,a)=>(m(),w(we,{key:e.id,spaced:""},{start:d((()=>[n(R,{label:"Offer","hide-label":a>0,logo:`/img/crypto/${e.currency.toLowerCase()}.png`,title:`${e.currency} (${e.wallet_type} Wallet)`,subtitle:e.uuid},null,8,["hide-label","logo","title","subtitle"])])),end:d((()=>[n(le,{label:"Available","hide-label":a>0,class:"w-20 xs:w-full text-xs"},{default:d((()=>[g(h(e.amount),1)])),_:2},1032,["hide-label"]),n(le,{label:"Price","hide-label":a>0,class:"w-20 xs:w-full text-xs"},{default:d((()=>[g(h(e.price),1)])),_:2},1032,["hide-label"]),n(le,{label:"Rating","hide-label":a>0,class:"w-24 xs:w-full text-xs"},{default:d((()=>[v("span",{"data-nui-tooltip":`${e.avgRating.toFixed(1)} (${e.reviews.length} ${e.reviews.length>1?"reviews":"review"})`,class:"flex"},[(m(),u(b,null,x(5,(a=>v("span",{key:a},["full"===ve(a,e.avgRating)?(m(),w(o,{key:0,name:"uim:star",class:"w-4 h-4 text-yellow-400"})):"half"===ve(a,e.avgRating)?(m(),w(o,{key:1,name:"uim:star-half-alt",class:"w-4 h-4 text-yellow-400"})):(m(),w(o,{key:2,name:"uim:star",class:"w-4 h-4 text-gray-300"}))]))),64))],8,X)])),_:2},1032,["hide-label"]),n(le,{label:"Status","hide-label":a>0,class:"w-20 xs:w-full"},{default:d((()=>[n(ne,{color:pe(e.status),flavor:"pastel",condensed:""},{default:d((()=>[g(h(e.status),1)])),_:2},1032,["color"])])),_:2},1032,["hide-label"]),n(le,{label:"Actions","hide-label":a>0},{default:d((()=>[n(ge,{flavor:"context",label:"Dropdown",orientation:"end"},{default:d((()=>[n(he,{to:`/user/p2p/offers/${e.uuid}/reviews`,title:"Reviews"},{start:d((()=>[n(o,{name:"line-md:star-twotone",class:"h-4 w-4 mr-2"})])),_:2},1032,["to"]),n(he,{onClick:a=>{return t=e,ce.value=t,void(de.value=!0);var t},title:("PENDING"===e.status?"Activate":"Disable")+" Offer"},{start:d((()=>[n(o,{name:"mdi:eye"+("PENDING"===e.status?"":"-off"),class:"h-4 w-4 mr-2"},null,8,["name"])])),_:2},1032,["onClick","title"]),n(he,{to:`/user/p2p/offers/edit/${e.uuid}`,title:"Edit Offer"},{start:d((()=>[n(o,{name:"line-md:edit-twotone",class:"h-4 w-4 mr-2"})])),_:2},1032,["to"])])),_:2},1024)])),_:2},1032,["hide-label"])])),_:2},1024)))),128))])),_:1})])):(m(),w(L,{key:0,title:f(se)&&""!==f(se)?"No matching results":"No results",subtitle:f(se)&&""!==f(se)?"Looks like we couldn't find any matching results for your search terms. Try other search terms.":"Looks like we don't have any offers here yet."},{image:d((()=>[M,S])),_:1},8,["title","subtitle"])),v("div",H,[f(ie).length>f(re)?(m(),w(xe,{key:0,"total-items":f(ie).length,"current-page":f(oe),"item-per-page":f(re)},null,8,["total-items","current-page","item-per-page"])):y("",!0)])])])),_:1}),n(ke,{open:f(de),size:"sm",onClose:l[4]||(l[4]=()=>de.value=!1)},{header:d((()=>[v("div",J,[v("h3",K,h(t.$t("Update Offer")),1),n(_e,{onClick:l[2]||(l[2]=()=>de.value=!1)})])])),footer:d((()=>[v("div",ae,[v("div",te,[n(i,{onClick:l[3]||(l[3]=()=>de.value=!1)},{default:d((()=>[g(h(t.$t("Cancel")),1)])),_:1}),n(i,{color:"primary",flavor:"solid",onClick:me,disabled:f(fe),loading:f(fe)},{default:d((()=>[g(h(t.$t("Update")),1)])),_:1},8,["disabled","loading"])])])])),default:d((()=>[v("div",Q,[v("div",Y,[v("h3",Z,h(t.$t("Are you sure?")),1),v("p",ee,h(`Do you really want to ${"PENDING"===f(ce)?.status?"activate":"disable"} this offer?`),1)])])])),_:1},8,["open"])])}}});export{le as default};
