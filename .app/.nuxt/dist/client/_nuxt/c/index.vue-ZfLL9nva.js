import{a as e,ad as t,o as a,b as l,f as s,n as r,t as i,u,c as n,Q as o,r as c,ac as d,E as p,O as m,w as f,q as x,e as v,k as w,F as h,B as y,X as g,ag as b,_ as k,x as _,Y as C,ao as F,an as T}from"../e/entry-8qgg5CL-.js";import{_ as W}from"./BaseButtonIcon.vue-6tAU_b7C.js";import{_ as j,a as $,b as I}from"./Transactions.vue-zBG-Mjsv.js";import{_ as N}from"./BaseListbox.vue-1Dy9Ui3z.js";import{u as B}from"./wallet-n04aoRPe.js";import{u as E}from"./useWallet-8iHzU2hV.js";import{u as P}from"./fiatCurrency-EA2f5t5g.js";import{z as A,u as D,t as O,F as S}from"./vee-validate.esm-n59zZCC5.js";const M=s("div",{class:"absolute -bottom-5 -end-5 h-[120px] w-[120px] rounded-full bg-white opacity-10 dark:opacity-10"},null,-1),R=s("div",{class:"absolute -top-5 -right-5 h-[100px] w-[100px] rounded-full bg-white opacity-10 dark:opacity-10"},null,-1),V=s("div",{class:"absolute -bottom-5 left-5 h-[80px] w-[80px] rounded-full bg-white opacity-30 dark:opacity-10"},null,-1),G={class:"flex items-center justify-between"},L=e({__name:"FiatCard",props:{currency:{default:""},balance:{default:0},active:{type:Boolean}},setup(e){const n=e,{formatedPrice:o}=t();return(e,t)=>(a(),l("div",{role:"button",class:r(["w-full xs:h-[144px] ltablet:h-[130px] relative flex h-[160px] sm:w-[290px] max-w-full cursor-pointer flex-col overflow-hidden rounded-xl p-5 transition-all duration-300 lg:w-full",[n.active?"bg-primary-700":"bg-muted-200 dark:bg-muted-900"]])},[M,R,V,s("div",G,[s("div",null,[s("span",{class:r(["block font-sans text-lg font-semibold",n.active?"text-white":"text-muted-800 dark:text-muted-200"])},i(u(o)(n.balance,n.currency)),3),s("span",{class:r(["block font-sans text-sm",n.active?"text-white":"text-muted-500 dark:text-muted-400"])},i(n.currency),3)])])],2))}}),U=""+globalThis.__publicAssetsURL("img/illustrations/placeholders/people/2.svg"),z={class:"relative"},q=s("img",{src:U,alt:"placeholder-image"},null,-1),H={class:"mt-2 flex justify-center gap-2"},Q={key:1,class:"flex flex-col gap-6 md:pb-20"},X={class:"grid gap-5 grid-cols-12"},Y={class:"mb-12 flex items-center justify-between"},J={class:"flex gap-2 flex-row"},K={class:"flex flex-col gap-y-4 sm:flex-row sm:gap-x-8"},Z={class:"space-y-5"},ee={class:"slimscroll grid pr-2 grid-cols-1 w-full xs:max-h-[2840px] md:max-h-[164px] gap-4 overflow-y-auto sm:grid-cols-2"},te={class:"mt-4 flex justify-center text-center"},ae={class:"ltablet:mx-0 text-muted-400 mx-auto max-w-xs text-center font-sans text-xs lg:mx-0"},le={class:"flex w-full items-center justify-between p-4 md:p-6"},se={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},re={class:"p-4 md:p-6"},ie={class:"mx-auto w-full text-start"},ue={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},ne={class:"p-4 md:p-6"},oe={class:"flex gap-x-2"},ce=e({__name:"index",props:{flutter:{type:Boolean,default:!1}},setup(e){const r=B(),M=n((()=>r.getFiatWallets)),R=o(),V=n((()=>R.settings)),G=A.object({currency:A.string().nonempty("Currency is required")}),U=n((()=>({currency:""}))),{handleSubmit:ce,isSubmitting:de,resetForm:pe}=D({validationSchema:O(G),initialValues:U}),{createWallet:me}=E(),fe=P(),{toast:xe}=t(),ve=c(null),we=n((()=>{if(!ve.value)return 0;return ve.value.transactions.filter((e=>!("DEPOSIT"!==e.type&&"INCOMING_TRANSFER"!==e.type||"COMPLETED"!==e.status&&"PENDING"!==e.status))).reduce(((e,t)=>e+t.amount),0)})),he=n((()=>{if(!ve.value)return 0;return ve.value.transactions.filter((e=>!("WITHDRAW"!==e.type&&"OUTGOING_TRANSFER"!==e.type||"COMPLETED"!==e.status&&"PENDING"!==e.status))).reduce(((e,t)=>e+t.amount),0)})),ye=c(!1),ge=ce((async e=>{try{const t=await me(e.currency,"FIAT");xe.response(t),pe(),await r.fetchWalletsByType("FIAT"),ve.value=r.wallets[e.currency]}catch(t){xe.danger(t)}ye.value=!1})),be=d();p((async()=>{0===fe.currencies.length&&await fe.fetchCurrencies(),await r.fetchWalletsByType("FIAT"),r.getFirstFiatWallet&&(ve.value=r.getFirstFiatWallet),V.value?.fiat_wallets||be.push("/user")}));const ke=n((()=>fe.currencies.filter((e=>!0===e.status&&!M.value.find((t=>t.currency===e))))));return(t,n)=>{const o=g,c=b,d=k,p=_,B=W,E=L,P=C,A=j,D=$,O=I,R=F,G=N,U=T;return a(),l("div",null,[s("div",z,[0===u(r).getFiatWallets.length?(a(),m(c,{key:0,class:"h-[calc(100vh-8rem)]",title:"Looks like you are new!",subtitle:"Create a new wallet to get started."},{image:f((()=>[q])),default:f((()=>[s("div",H,[v(o,{color:"primary",shape:"curved",class:"h-11 w-40",onClick:n[0]||(n[0]=e=>ye.value=!0)},{default:f((()=>[x(i(t.$t("Create Wallet")),1)])),_:1})])])),_:1})):(a(),l("div",Q,[s("div",X,[v(P,{class:"overflow-hidden p-6 col-span-12 lg:col-span-8"},{default:f((()=>[s("div",Y,[v(d,{as:"h3",size:"md",weight:"semibold",lead:"tight",class:"text-muted-800 dark:text-white"},{default:f((()=>[s("span",null,i(t.$t("My Wallets")),1)])),_:1}),s("div",J,[u(V).deposit?(a(),m(o,{key:0,shape:"curved",flavor:"outline",color:"success",shadow:"hover",to:`/user/${e.flutter?"flutter/":""}wallets/fiat/deposit/${u(ve)?.uuid}`},{default:f((()=>[x(i(t.$t("Deposit")),1)])),_:1},8,["to"])):w("",!0),u(V).withdraw?(a(),m(o,{key:1,shape:"curved",flavor:"outline",color:"danger",shadow:"hover",to:`/user/${e.flutter?"flutter/":""}wallets/fiat/withdraw/${u(ve)?.uuid}`},{default:f((()=>[x(i(t.$t("Withdraw")),1)])),_:1},8,["to"])):w("",!0)])]),s("div",K,[s("div",Z,[v(B,{shape:"rounded",onClick:n[1]||(n[1]=e=>ye.value=!0),"data-nui-tooltip-position":"right","data-nui-tooltip":"Create New Wallet"},{default:f((()=>[v(p,{name:"lucide:plus",class:"h-4 w-4"})])),_:1})]),s("div",ee,[(a(!0),l(h,null,y(u(M),((e,t)=>(a(),m(E,{key:t,balance:Number(e.balance),currency:e.currency,active:u(ve)?.uuid===e.uuid,onClick:t=>ve.value=e},null,8,["balance","currency","active","onClick"])))),128))])]),s("div",te,[s("p",ae,i(t.$t("Monitor your income, withdrawals, and transactions conveniently in one place"))+". ",1)])])),_:1}),u(ve)?(a(),m(A,{class:"overflow-hidden p-6 col-span-12 lg:col-span-4",key:u(ve).uuid,balance:u(ve).balance,currency:u(ve).currency,uuid:u(ve).uuid,income:u(we),expenses:u(he),incomeText:"Income",expensesText:"Withdrawals",uuidFormated:!0,currencyFormated:!0},null,8,["balance","currency","uuid","income","expenses"])):w("",!0)]),u(ve)?(a(),m(D,{key:u(ve).uuid,incomeText:"Income",expensesText:"Withdrawals",income:u(we),expenses:u(he),wallet:u(ve),currencyFormated:!0},null,8,["income","expenses","wallet"])):w("",!0),u(ve)?(a(),m(O,{key:u(ve).uuid,wallet:u(ve),viewPath:`/user/${e.flutter?"flutter/":""}wallets/trx`},null,8,["wallet","viewPath"])):w("",!0)]))]),v(U,{open:u(ye),size:"sm",onClose:n[4]||(n[4]=e=>ye.value=!1)},{header:f((()=>[s("div",le,[s("h3",se,i(t.$t("Create New Wallet")),1),v(R,{onClick:n[2]||(n[2]=e=>ye.value=!1)})])])),footer:f((()=>[s("div",ne,[s("div",oe,[v(o,{onClick:n[3]||(n[3]=e=>ye.value=!1)},{default:f((()=>[x(i(t.$t("Cancel")),1)])),_:1}),v(o,{color:"primary",flavor:"solid",onClick:u(ge),disabled:u(de),loading:u(de)},{default:f((()=>[x(i(t.$t("Create")),1)])),_:1},8,["onClick","disabled","loading"])])])])),default:f((()=>[s("div",re,[s("div",ie,[s("p",ue,i(t.$t("Please select the currency for the new wallet"))+". ",1),v(u(S),{name:"currency"},{default:f((({field:e,errorMessage:t,handleChange:a,handleBlur:l})=>[v(G,{modelValue:e.value,"onUpdate:modelValue":[t=>e.value=t,a],error:t,disabled:u(de),items:u(ke).map((e=>e.code)),label:"Currency",placeholder:"Select currency",shape:"curved",classes:{input:"h-12",wrapper:"max-w-xs"},onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","items","onBlur"])])),_:1})])])])),_:1},8,["open"])])}}});export{ce as _};
