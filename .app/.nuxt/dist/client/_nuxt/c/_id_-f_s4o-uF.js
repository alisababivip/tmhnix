import{a as e,ad as s,c as a,r as l,aq as r,E as i,O as t,w as o,o as n,u,q as d,t as m,b as c,e as p,f as v,p as g,F as f,B as h,k as y,_ as b,s as w,x as _,X as k}from"../e/entry-8qgg5CL-.js";import{_ as j}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as x}from"./BaseTag.vue-NMkN1Uk8.js";import{_ as B}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as $}from"./useRoles-LBTtGXtV.js";import{u as C}from"./usePermissions-zbVS2zgJ.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";const S={key:1,class:"max-w-sm space-y-2"},N={class:"space-y-5"},R={class:"grid md:grid-cols-2 gap-5 items-center"},P={class:"grid gap-6"},O={class:"flex justify-between mt-5"},V={class:"flex justify-start gap-2"},q={key:0,class:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 border-t-2 pt-5 border-gray-200 dark:border-gray-700"},A=e({__name:"[id]",setup(e){const{activeRole:A,getRole:J,syncPermissions:T,selectRole:z}=$(),{getPermissions:E}=C(),{toast:F}=s(),I=a((()=>A.value)),L=l([]),U=r(),W=l([]);let X=[];i((async()=>{if(0===W.value.length&&await async function(){const e=await E();W.value=e.data.result}(),!I.value){const e=await J(Number(U.params.id));z(e.data.result)}I.value?.rolepermission&&(L.value=I.value?.rolepermission.map((e=>e.permission)),X=[...L.value])}));const D=l(((e,s)=>0===e.length?"No permissions selected":e.length>1?`${e.length} permissions selected`:String(s?e[0][s]:e[0]))),G=async()=>{if(JSON.stringify(X)!==JSON.stringify(L.value))try{const e=await T(I.value?.id,L.value);F.response(e),z(e.data.result),I.value?.rolepermission&&(L.value=I.value?.rolepermission.map((e=>e.permission)),X=[...L.value])}catch(e){F.danger(e)}else F.info("No changes detected.")},H=()=>{L.value=W.value},K=()=>{L.value=[]};return(e,s)=>{const a=b,l=w,r=_,i=k,$=j,C=x,A=B;return n(),t(A,{class:"pb-10"},{left:o((()=>[u(I)?(n(),t(a,{key:0,as:"h3",size:"2xl",weight:"bold",class:"text-muted-800 dark:text-white"},{default:o((()=>[d(m(e.$t("Role"))+": "+m(u(I).name),1)])),_:1})):(n(),c("div",S,[p(l,{class:"h-4 w-full rounded"}),p(l,{class:"h-4 w-[85%] rounded"})]))])),right:o((()=>[p(i,{color:"primary",onClick:s[0]||(s[0]=()=>e.$router.push("/admin/roles"))},{default:o((()=>[p(r,{name:"line-md:arrow-small-left",class:"w-5 h-5 mr-2"}),d(" "+m(e.$t("Back")),1)])),_:1})])),default:o((()=>[v("div",N,[v("div",R,[v("div",P,[p($,{shape:"curved",modelValue:u(L),"onUpdate:modelValue":s[1]||(s[1]=e=>g(L)?L.value=e:null),"multiple-label":u(D),label:"Permissions",items:u(W),properties:{value:"id",label:"name"},multiple:"",disabled:0===u(W)?.length,loading:!u(I)},null,8,["modelValue","multiple-label","items","disabled","loading"])]),v("div",O,[v("div",V,[p(i,{onClick:H,shape:"curved",color:"primary"},{default:o((()=>[d(m(e.$t("Select All")),1)])),_:1}),p(i,{onClick:K,shape:"curved",color:"danger"},{default:o((()=>[d(m(e.$t("Clear Selection")),1)])),_:1})]),p(i,{onClick:G,shape:"curved",color:"success"},{default:o((()=>[d(m(e.$t("Submit")),1)])),_:1})])]),u(I)&&u(I).rolepermission?(n(),c("div",q,[(n(!0),c(f,null,h(u(I).rolepermission,(e=>(n(),t(C,{key:e.permission.id,shape:"rounded",color:"default",shadow:"hover"},{default:o((()=>[d(m(e.permission.name),1)])),_:2},1024)))),128))])):y("",!0)])])),_:1})}}});export{A as default};
