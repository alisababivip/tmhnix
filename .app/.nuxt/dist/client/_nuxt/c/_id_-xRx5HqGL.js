import{a as e,z as a,r as l,ad as s,at as t,ac as n,E as i,c as o,b as r,e as u,w as m,u as d,an as c,o as p,q as f,t as v,f as h,O as g,af as b,F as _,B as y,_ as x,x as j,X as w,ag as k}from"../e/entry-8qgg5CL-.js";import{_ as B,a as C}from"./FlexTableRow.vue-LmGXINIn.js";import{_ as T}from"./FlexTableCell.vue-Rbj2Whgl.js";import{_ as V}from"./TairoButtonIcon.vue-KqKLsAHm.js";import{_ as I}from"./TairoFlexTable-zdoraqRc.js";import{_ as P}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{_ as $}from"./BaseInput.vue-iInHQMIA.js";import{_ as F}from"./BaseListbox.vue-1Dy9Ui3z.js";import{u as N}from"./useRoles-LBTtGXtV.js";import{u as E}from"./usePermissions-zbVS2zgJ.js";import{_ as M,a as S}from"./placeholder-search-4-dark-Jht91LnM.js";import{n as U}from"./navigation-j4BU5uvx.js";import{z as L,u as R,t as q,F as z}from"./vee-validate.esm-n59zZCC5.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./input-id-wZ-Ta08j.js";import"./use-text-value-9iwzs_EA.js";const A={class:"pb-10"},D=h("img",{class:"block dark:hidden",src:M,alt:"Placeholder image"},null,-1),O=h("img",{class:"hidden dark:block",src:S,alt:"Placeholder image"},null,-1),W={key:1,class:"w-full sm:pt-5"},X={class:"flex gap-2"},G={class:"flex w-full items-center justify-between p-4 md:p-6"},H={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},J={class:"p-4 md:p-6"},K={class:"mx-auto w-full text-start space-y-2"},Q={class:"p-4 md:p-6"},Y={class:"flex gap-x-2"},Z=e({__name:"[id]",setup(e){const M=a(),{id:S}=M.params,Z=l([...U]),ee=l(U[S]||{}),ae=l([...ee.value.children||[]]),le=l(!1),se=l([]),te=l([]),ne=l(!1),{toast:ie}=s(),{getRoles:oe}=N(),{getPermissions:re}=E(),{updateNavigation:ue}=t();const me=n();i((async()=>{ee.value||(ie.dangerText("Invalid menu ID"),me.push("/admin/menu")),ne.value=!0,await async function(){const e=await oe();se.value=e.data.result}(),await async function(){const e=await re();te.value=[{name:"None"},...e.data.result]}(),ne.value=!1}));const de=L.object({name:L.string().nonempty("Name is required"),permission:L.string().nullable().optional()}),ce=o((()=>({name:"",permission:""}))),{handleSubmit:pe,isSubmitting:fe,values:ve,setFieldValue:he}=R({validationSchema:q(de),initialValues:ce}),ge=l(null),be=pe((async e=>{if(null===ge.value)return ie.dangerText("Please select a menu item"),void(le.value=!1);ae.value[ge.value].name=e.name,ae.value[ge.value].permission="None"===e.permission?null:e.permission,U[S].children=ae.value;try{const e=await ue(U);ie.response(e),le.value=!1}catch(a){ie.danger(a)}}));return(e,a)=>{const l=x,s=j,t=w,n=k,i=B,o=T,N=V,E=C,M=I,S=P,U=$,L=F,R=c;return p(),r("div",A,[u(S,null,{left:m((()=>[u(l,null,{default:m((()=>[f(v(e.$t("Editing"))+" "+v(d(ee)?.name)+" "+v(e.$t("Menu")),1)])),_:1})])),right:m((()=>[u(t,{color:"muted",to:"/admin/menu"},{default:m((()=>[u(s,{name:"line-md:arrow-small-left",class:"w-5 h-5 mr-2"}),f(" "+v(e.$t("Back")),1)])),_:1})])),default:m((()=>[h("div",null,[d(ne)||0!==d(Z)?.length?(p(),r("div",W,[u(M,null,{default:m((()=>[u(b,{"enter-active-class":"transform-gpu","enter-from-class":"opacity-0 translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transform-gpu","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-2"},{default:m((()=>[(p(!0),r(_,null,y(d(ae),((e,a)=>(p(),g(E,{key:a,spaced:""},{start:m((()=>[u(i,{label:"Language","hide-label":a>0,title:e.name??"---------------",subtitle:e.to},null,8,["hide-label","title","subtitle"])])),end:m((()=>[u(o,{label:"Permission","hide-label":a>0,class:"w-64 xs:w-full"},{default:m((()=>[f(v(e.permission),1)])),_:2},1032,["hide-label"]),u(o,{label:"Actions","hide-label":a>0,class:"w-64 xs:justify-end xs:w-full"},{default:m((()=>[h("div",X,[u(N,{onClick:l=>((e,a)=>{ge.value=a,he("name",e.name),he("permission",e.permission),le.value=!0})(e,a),color:"warning","data-nui-tooltip":"Edit"},{default:m((()=>[u(s,{name:"line-md:edit",class:"h-4 w-4"})])),_:2},1032,["onClick"])])])),_:2},1032,["hide-label"])])),_:2},1024)))),128))])),_:1})])),_:1})])):(p(),g(n,{key:0,title:"No matching results",subtitle:"Looks like we couldn't find any matching results for your search terms. Try other search terms."},{image:m((()=>[D,O])),_:1}))])])),_:1}),u(R,{open:d(le),size:"sm",onClose:a[1]||(a[1]=e=>le.value=!1)},{header:m((()=>[h("div",G,[h("h3",H,v(e.$t("Edit Menu Item")),1)])])),footer:m((()=>[h("div",Q,[h("div",Y,[u(t,{onClick:a[0]||(a[0]=e=>le.value=!1)},{default:m((()=>[f(v(e.$t("Cancel")),1)])),_:1}),u(t,{color:"primary",flavor:"solid",onClick:d(be),disabled:d(fe),loading:d(fe)},{default:m((()=>[f(v(e.$t("Save")),1)])),_:1},8,["onClick","disabled","loading"])])])])),default:m((()=>[h("div",J,[h("div",K,[u(d(z),{name:"name"},{default:m((({field:e,errorMessage:a,handleChange:l,handleBlur:s})=>[u(U,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:d(fe),type:"text",label:"Menu Item Name",placeholder:"Enter menu item name",onBlur:s},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),u(d(z),{name:"permission"},{default:m((({field:e,errorMessage:a,handleChange:l,handleBlur:s})=>[u(L,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:d(fe),label:"Permission",items:d(te).map((e=>e.name)),onBlur:s},null,8,["modelValue","onUpdate:modelValue","error","disabled","items","onBlur"])])),_:1})])])])),_:1},8,["open"])])}}});export{Z as default};
