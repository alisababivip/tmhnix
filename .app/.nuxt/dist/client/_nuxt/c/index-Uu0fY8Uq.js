import{_ as e}from"./BaseInput.vue-iInHQMIA.js";import{d as t,a,z as l,ad as s,c as o,r as u,ac as r,E as i,b as n,e as d,w as c,u as m,an as p,o as h,f as v,p as f,O as g,q as w,t as x,af as y,k as b,n as _,F as k,B as A,x as $,X as j,Y as C,ag as E,ao as D}from"../e/entry-8qgg5CL-.js";import{_ as P}from"./BaseSelect.vue-p0KYznCX.js";import{_ as T}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as V,a as B}from"./FlexTableRow.vue-LmGXINIn.js";import{_ as S}from"./FlexTableCell.vue-Rbj2Whgl.js";import{_ as N}from"./BaseTag.vue-NMkN1Uk8.js";import{_ as I,a as R}from"./BaseDropdown.vue-wSpyT9xX.js";import{_ as F}from"./TairoFlexTable-zdoraqRc.js";import{_ as q}from"./BasePagination.vue-eKZkqxB7.js";import{_ as L}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as U}from"./useBlog-0Y19BpbN.js";import{_ as O,a as z}from"./placeholder-search-4-dark-Jht91LnM.js";import"./input-id-wZ-Ta08j.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";import"./menu-KWZreDHB.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";const G=t({id:"author",state:()=>({authors:[],selectedAuthor:null,isLoading:!1}),getters:{getSelectedAuthor:e=>e.selectedAuthor,getAuthors:e=>e.authors},actions:{async fetchAuthors(e=!0,t){const{getAuthors:a}=U();try{const l=await a(e,t);return this.authors=l.data.result,l}catch(l){return l}},async fetchAuthorById(e,t=!0){const{getAuthor:a}=U();try{const l=await a(e,t);return this.selectedAuthor=l.data.result,l}catch(l){return l}}}}),J={class:"w-full flex gap-2 xs:flex-col sm:flex-row"},W={value:10},X={value:25},Y={value:50},H={value:100},K=v("img",{class:"block dark:hidden",src:O,alt:"Placeholder image"},null,-1),M=v("img",{class:"hidden dark:block",src:z,alt:"Placeholder image"},null,-1),Q={key:1,class:"w-full sm:pt-5"},Z={class:"mt-6"},ee={class:"flex w-full items-center justify-between p-4 md:p-6"},te={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},ae={class:"p-4 md:p-6"},le={class:"mx-auto w-full text-start"},se={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},oe={class:"space-y-2"},ue={class:"p-4 md:p-6"},re={class:"flex gap-x-2"},ie={class:"flex w-full items-center justify-between p-4 md:p-6"},ne={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},de={class:"p-4 md:p-6"},ce={class:"mx-auto w-full text-center"},me={class:"font-heading text-muted-800 text-lg font-medium leading-6 dark:text-white"},pe={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},he={class:"p-4 md:p-6"},ve={class:"flex gap-x-2"},fe=a({__name:"index",setup(t){const a=G(),O=l(),{toast:z}=s(),{updateAuthor:fe,deleteAuthor:ge}=U(),we=o((()=>O.query.status)),xe=u(!1),ye=u(""),be=u(10),_e=o((()=>parseInt(O.query.page??"1"))),ke=r(),Ae=u(""),$e=o((()=>a.authors));i((async()=>{xe.value=!0,0===a.authors.length&&await a.fetchAuthors(!0,we.value),xe.value=!1}));const je=o((()=>$e.value.filter((e=>(!Pe.value||"All"===Pe.value||e.status===Pe.value)&&(ye.value&&""!==ye.value&&void 0!==ye.value&&ye.value!==Ae.value&&(ke.push({query:{...O.query,page:"1",filter:ye.value}}),Ae.value=ye.value),!ye.value||e.user.uuid?.includes(ye.value)))).sort(((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime())))),Ce=o((()=>{const e=(_e.value-1)*be.value,t=e+be.value;return je.value.slice(e,t)})),Ee=e=>{switch(e){case"APPROVED":return"success";case"PENDING":return"warning";case"REJECTED":return"danger";default:return"info"}},De=u(!1),Pe=u(""),Te=["All","APPROVED","PENDING","REJECTED"],Ve=["APPROVED","PENDING","REJECTED"],Be=u(!1),Se=u(""),Ne=o((()=>{let e=1;return we.value&&e--,e})),Ie=u(!1),Re=u(!1);const Fe=u(!1);const qe=async()=>{Be.value=!0;try{const e=await fe(a.selectedAuthor?.id,Se.value);z.response(e),"success"===e.status&&await a.fetchAuthors(!0)}catch(e){z.danger(e)}Fe.value=!1,Be.value=!1,a.selectedAuthor=null};return(t,l)=>{const s=e,o=$,u=j,r=P,i=T,U=C,O=E,G=V,fe=S,ke=N,Ae=I,$e=R,Le=B,Ue=F,Oe=q,ze=L,Ge=D,Je=p;return h(),n("div",null,[d(ze,null,{left:c((()=>[v("div",J,[d(s,{modelValue:m(ye),"onUpdate:modelValue":l[0]||(l[0]=e=>f(ye)?ye.value=e:null),icon:"lucide:search",classes:{wrapper:"w-full sm:w-auto"},placeholder:"Search Post Title..."},null,8,["modelValue"]),d(u,{onClick:l[1]||(l[1]=e=>De.value=!m(De)),color:"muted",block:""},{default:c((()=>[m(De)?(h(),g(o,{key:0,name:"line-md:arrow-up",class:"h-4 w-4 mr-2"})):(h(),g(o,{key:1,name:"line-md:arrow-down",class:"h-4 w-4 mr-2"})),w(" "+x(t.$t("Filters")),1)])),_:1})])])),right:c((()=>[d(r,{modelValue:m(be),"onUpdate:modelValue":l[2]||(l[2]=e=>f(be)?be.value=e:null),label:"",classes:{wrapper:"w-full sm:w-40"}},{default:c((()=>[v("option",W,"10 "+x(t.$t("per page")),1),v("option",X,"25 "+x(t.$t("per page")),1),v("option",Y,"50 "+x(t.$t("per page")),1),v("option",H,"100 "+x(t.$t("per page")),1)])),_:1},8,["modelValue"])])),default:c((()=>[v("div",null,[d(y,{"enter-active-class":"transform-gpu","enter-from-class":"opacity-0 -translate-y-4","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"absolute transform-gpu","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 -translate-y-4"},{default:c((()=>[m(De)?(h(),g(U,{key:0,class:_(`grid gap-4 xs:grid-cols-1 sm:grid-cols-2 md:grid-cols-${m(Ne)} lg:grid-cols-${m(Ne)+2} mb-6 p-5`)},{default:c((()=>[m(we)?b("",!0):(h(),g(i,{key:0,modelValue:m(Pe),"onUpdate:modelValue":l[3]||(l[3]=e=>f(Pe)?Pe.value=e:null),label:"Status",items:Te,placeholder:"Select a Status"},null,8,["modelValue"]))])),_:1},8,["class"])):b("",!0)])),_:1}),m(xe)||0!==m(Ce)?.length?(h(),n("div",Q,[d(Ue,null,{default:c((()=>[d(y,{"enter-active-class":"transform-gpu","enter-from-class":"opacity-0 -translate-x-full","enter-to-class":"opacity-100 translate-x-0","leave-active-class":"absolute transform-gpu","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 -translate-x-full"},{default:c((()=>[(h(!0),n(k,null,A(m(Ce),((e,t)=>(h(),g(Le,{key:e.id,spaced:""},{start:c((()=>[d(G,{label:"Author","hide-label":t>0,logo:e.user?.avatar,title:`${e.user?.first_name} ${e.user?.last_name}`,subtitle:e.user?.uuid},null,8,["hide-label","logo","title","subtitle"])])),end:c((()=>[d(fe,{label:"Posts","hide-label":t>0,class:"w-20 xs:w-full"},{default:c((()=>[w(x(e.posts?.length||0),1)])),_:2},1032,["hide-label"]),d(fe,{label:"Status","hide-label":t>0,class:"w-20 xs:w-full"},{default:c((()=>[d(ke,{color:Ee(e.status),flavor:"pastel",condensed:""},{default:c((()=>[w(x(e.status),1)])),_:2},1032,["color"])])),_:2},1032,["hide-label"]),d(fe,{label:"Actions","hide-label":t>0,class:"w-20 xs:justify-end xs:w-full"},{default:c((()=>[d($e,{flavor:"context",label:"Dropdown",orientation:"end"},{default:c((()=>[d(Ae,{onClick:t=>{return l=e,a.selectedAuthor=l,Se.value=l.status,void(Fe.value=!0);var l},title:"Edit Author Status"},{start:c((()=>[d(o,{name:"line-md:edit-twotone",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"]),d(Ae,{onClick:t=>function(e){a.selectedAuthor=e,Ie.value=!0}(e),title:"Delete Author"},{start:c((()=>[d(o,{name:"line-md:close",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["hide-label"])])),_:2},1024)))),128))])),_:1})])),_:1})])):(h(),g(O,{key:0,title:m(ye)&&""!==m(ye)?"No matching results":"No results",subtitle:m(ye)&&""!==m(ye)?"Looks like we couldn't find any matching results for your search terms. Try other search terms.":"Looks like we don't have any data here yet."},{image:c((()=>[K,M])),_:1},8,["title","subtitle"])),v("div",Z,[m(je).length>m(be)?(h(),g(Oe,{key:0,"total-items":m(je).length,"current-page":m(_e),"item-per-page":m(be)},null,8,["total-items","current-page","item-per-page"])):b("",!0)])])])),_:1}),d(Je,{open:m(Fe),size:"sm",onClose:l[7]||(l[7]=e=>Fe.value=!1)},{header:c((()=>[v("div",ee,[v("h3",te,x(t.$t("Edit"))+" "+x(t.$t("Author")),1),d(Ge,{onClick:l[4]||(l[4]=e=>Fe.value=!1)})])])),footer:c((()=>[v("div",ue,[v("div",re,[d(u,{onClick:l[6]||(l[6]=e=>Fe.value=!1)},{default:c((()=>[w(x(t.$t("Cancel")),1)])),_:1}),d(u,{color:"primary",flavor:"solid",onClick:qe,disabled:m(Be),loading:m(Be)},{default:c((()=>[w(x(t.$t("Update")),1)])),_:1},8,["disabled","loading"])])])])),default:c((()=>[v("div",ae,[v("div",le,[v("p",se,x(t.$t("Please update the"))+" "+x(t.$t("author"))+" "+x(t.$t("status"))+". ",1),v("div",oe,[d(i,{modelValue:m(Se),"onUpdate:modelValue":l[5]||(l[5]=e=>f(Se)?Se.value=e:null),disabled:m(Be),items:Ve,placeholder:"Please select an option",label:"Status",shape:"rounded"},null,8,["modelValue","disabled"])])])])])),_:1},8,["open"]),d(Je,{open:m(Ie),size:"sm",onClose:l[11]||(l[11]=e=>Ie.value=!1)},{header:c((()=>[v("div",ie,[v("h3",ne,x(t.$t("Delete"))+" "+x(t.$t("Author")),1),d(Ge,{onClick:l[8]||(l[8]=e=>Ie.value=!1)})])])),footer:c((()=>[v("div",he,[v("div",ve,[d(u,{onClick:l[9]||(l[9]=e=>Ie.value=!1)},{default:c((()=>[w(x(t.$t("Cancel")),1)])),_:1}),d(u,{color:"danger",flavor:"solid",onClick:l[10]||(l[10]=e=>async function(){Re.value=!0;try{const e=await ge(a.selectedAuthor?.id);z.response(e),"success"===e.status&&await a.fetchAuthors(!0)}catch(e){z.danger(e)}Ie.value=!1,Re.value=!1,a.selectedAuthor=null}()),disabled:m(Re),loading:m(Re)},{default:c((()=>[w(x(t.$t("Delete")),1)])),_:1},8,["disabled","loading"])])])])),default:c((()=>[v("div",de,[v("div",ce,[v("h3",me,x(t.$t("Are you sure?")),1),v("p",pe,x(t.$t("Do you really want to delete this"))+" "+x(t.$t("author"))+" "+x(t.$t("This process cannot be undone"))+". "+x(t.$t("This will also delete all the posts associated with this author"))+". ",1)])])])),_:1},8,["open"])])}}});export{fe as default};
