import{a as e,ad as t,r,c as a,z as s,ac as o,J as l,E as n,b as i,e as d,w as u,o as c,q as m,t as p,u as b,f,O as v,k as g,F as h,B as y,p as x,W as k,A as w,n as j,_ as $,x as _,X as C}from"../e/entry-8qgg5CL-.js";import{_ as B}from"./BaseMessage.vue-Kpn2u5Rn.js";import{_ as U}from"./BaseInput.vue-iInHQMIA.js";import{_ as F}from"./BaseProgress.vue-xH0Mhn3Z.js";import{_ as V}from"./BaseInputFileHeadless.vue-LOgyN9kF.js";import{_ as S}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as z,a as I}from"./frontend-NMoMa4Uu.js";import{u as D}from"./fetch-i3Y1jjTS.js";import{b as M}from"./strings-rQgUKePI.js";import{_ as P}from"./placeholder-file-IxKzOaSl.js";import{z as A,u as E,F as O,t as R}from"./vee-validate.esm-n59zZCC5.js";import"./input-id-wZ-Ta08j.js";const T={class:"flex flex-col sm:flex-row gap-2 w-full"},K={class:"mb-4"},W={class:"flex flex-col w-full gap-5"},q={key:0,class:"text-warning-500"},H=f("a",{class:"text-blue-400 underline",href:"https://icon-sets.iconify.design/"},"https://icon-sets.iconify.design/",-1),J={key:1,class:"text-warning-500"},L=f("span",{class:"text-warning-400 mx-1"},"text-(color name in small letters)-(density)",-1),Q=f("a",{class:"text-blue-400 underline",href:"https://tailwindcss.com/docs/customizing-colors"},"https://tailwindcss.com/docs/customizing-colors",-1),X={key:1,class:"max-w-sm"},Y={key:0,class:"mb-4"},G=["src"],N=["onDrop"],Z=["onClick","onKeydown"],ee={class:"p-5 text-center"},te={class:"text-muted-400 font-sans text-sm"},re={class:"text-muted-400 font-sans text-[0.7rem] font-semibold uppercase"},ae={for:"file",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 cursor-pointer font-sans text-sm underline underline-offset-4 transition-colors duration-300"},se={key:1,class:"mt-6 space-y-2"},oe={class:"border-muted-200 dark:border-muted-700 dark:bg-muted-800 relative flex items-center justify-end gap-2 rounded-xl border bg-white p-3"},le={class:"flex items-center gap-2"},ne={class:"shrink-0"},ie=["src"],de={key:1,class:"h-14 w-14 rounded-xl object-cover object-center",src:P,alt:"Image preview"},ue={class:"font-sans"},ce={class:"text-muted-800 dark:text-muted-100 line-clamp-1 block text-sm"},me={class:"text-muted-400 block text-xs"},pe={class:"flex gap-2"},be={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300 disabled:cursor-not-allowed disabled:opacity-60",disabled:"",type:"button",tooltip:"Cancel"},fe=f("span",{class:"sr-only"},"Cancel",-1),ve={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Upload"},ge=f("span",{class:"sr-only"},"Upload",-1),he=["onClick"],ye=f("span",{class:"sr-only"},"Remove",-1),xe=e({__name:"[id]",setup(e){z();const{toast:P}=t(),xe=r(!1),ke=a((()=>Object.keys(Oe.value).length)),we=s(),{updateFrontendSection:je,getFrontendSection:$e}=I(),_e=o(),Ce=we.params.id,Be=r(null),Ue=A.object({heading:A.string(),subtext:A.string()}),Fe=A.object({title:A.string(),description:A.string()}),Ve=A.object({step:A.string(),title:A.string(),description:A.string(),icon:A.string(),iconColor:A.string()}),Se=r({content:null}),ze=r(null),Ie=r(null),De=r(A.object({})),Me=r(!1),{handleSubmit:Pe,isSubmitting:Ae,meta:Ee,errors:Oe,values:Re,setErrors:Te,setFieldValue:Ke}=E({validationSchema:a((()=>Me.value&&De.value?R(De.value):null)),initialValues:Se});l(ze,(e=>{const t=e?.item(0)||null;if(ze.value){const e=new FileReader;e.onload=e=>{Ie.value=e.target?.result},e.readAsDataURL(t)}})),n((async()=>{try{const e=await $e(Ce);if("success"!==e.status)return void _e.replace("/admin/settings/frontend");Be.value=e.data.result,De.value=await(e=>{switch(e){case"banner":return A.object({heading:A.string(),subtext:A.object({part1:A.string(),part2:A.string()}),button:A.string(),image:A.string()});case"features":return A.object({heading:A.string(),subtext:A.object({part1:A.string(),part2:A.string()}),features:A.array(Fe),image:A.string()});case"markets":return Ue;case"steps":return A.object({heading:A.string(),steps:A.array(Ve)});default:throw new Error(`Unsupported section: ${e}`)}})(e.data.result.section),Me.value=!0,Se.value={content:Be.value?.content},Ie.value=Be.value?.content?.image||null}catch(e){console.error("Failed to fetch data: ",e)}}));const We=Pe((async e=>{try{if(xe.value=!1,e={...e.content,image:Ie.value||null},ze.value){const t=new FormData;t.append("files",ze.value[0]),t.append("type","frontend");const r=await D("/api/upload",{method:"POST",body:t},"$QUFPKd88Mo");r&&""!==r.data.value&&(e.image=r.data.value[0])}const t=await je(Ce,e);P.response(t)}catch(t){P.danger(t)}}));return(e,t)=>{const r=$,a=_,s=C,o=B,l=U,n=F,z=V,I=S;return c(),i("div",null,[d(I,null,{left:u((()=>[d(r,{as:"h3",size:"xl",weight:"semibold",class:"text-muted-800 dark:text-white"},{default:u((()=>[m(p(`Editing ${b(Be)?.title} page`),1)])),_:1})])),right:u((()=>[f("div",T,[d(s,{color:"muted",class:"flex items-center gap-2",onClick:t[0]||(t[0]=t=>e.$router.back())},{default:u((()=>[d(a,{name:"mdi-light:arrow-left",class:"h-5 w-5"}),f("span",null,p(e.$t("Back")),1)])),_:1}),d(s,{color:"success",class:"flex items-center gap-2",onClick:b(We)},{default:u((()=>[d(a,{name:"mdi-light:content-save",class:"h-5 w-5"}),f("span",null,p(e.$t("Update")),1)])),_:1},8,["onClick"])])])),default:u((()=>[f("div",K,[b(xe)?(c(),v(o,{key:0,onClose:t[1]||(t[1]=e=>xe.value=!1)},{default:u((()=>[m(p(e.$t("Your section has been updated"))+"! ",1)])),_:1})):g("",!0),b(ke)>1?(c(),v(o,{key:1,type:"danger",onClose:t[2]||(t[2]=()=>b(Te)({}))},{default:u((()=>[m(p(e.$t("This form has"))+" "+p(b(ke))+" "+p(e.$t("errors, please check them before submitting")),1)])),_:1})):g("",!0)]),f("div",W,[(c(!0),i(h,null,y(b(Be)?.content,((r,s)=>(c(),i(h,{key:s},["object"==typeof r?(c(),i(h,{key:0},[Array.isArray(r)?(c(!0),i(h,{key:0},y(r,((t,r)=>(c(),i("div",{key:r},[(c(!0),i(h,null,y(t,((t,a)=>(c(),i(h,{key:a},[d(b(O),{name:`content.${s}[${r}].${a}`},{default:u((({field:e,errorMessage:t,handleChange:o,handleBlur:n})=>[d(l,{"model-value":e.value,error:t,disabled:b(Ae),label:`${s} ${r+1} ${a}`,"onUpdate:modelValue":o,onBlur:n,"color-focus":"",class:"w-full"},null,8,["model-value","error","disabled","label","onUpdate:modelValue","onBlur"])])),_:2},1032,["name"]),"icon"===a?(c(),i("small",q,[m(p(e.$t("Icon name from "))+" ",1),H])):g("",!0),"iconColor"===a?(c(),i("small",J,[m(p(e.$t("Icon colors as "))+" ",1),L,m(" "+p(e.$t("from"))+" ",1),Q])):g("",!0)],64)))),128))])))),128)):(c(!0),i(h,{key:1},y(r,((e,t)=>(c(),v(b(O),{key:t,name:`content.${s}.${t}`},{default:u((({field:e,errorMessage:r,handleChange:a,handleBlur:s})=>[d(l,{"model-value":e.value,error:r,disabled:b(Ae),label:t,"onUpdate:modelValue":a,onBlur:s,"color-focus":"",class:"w-full"},null,8,["model-value","error","disabled","label","onUpdate:modelValue","onBlur"])])),_:2},1032,["name"])))),128))],64)):(c(),i(h,{key:1},["image"!==s?(c(),v(b(O),{key:0,name:`content.${s}`},{default:u((({field:e,errorMessage:t,handleChange:r,handleBlur:a})=>[d(l,{"model-value":e.value,error:t,disabled:b(Ae),label:s,"onUpdate:modelValue":r,onBlur:a,"color-focus":"",class:"w-full"},null,8,["model-value","error","disabled","label","onUpdate:modelValue","onBlur"])])),_:2},1032,["name"])):(c(),i("div",X,[b(Ie)?(c(),i("div",Y,[f("img",{src:b(Ie),alt:"Image Preview",class:"rounded-xl object-cover object-center"},null,8,G)])):g("",!0),d(z,{modelValue:b(ze),"onUpdate:modelValue":t[5]||(t[5]=e=>x(ze)?ze.value=e:null)},{default:u((({open:r,remove:s,preview:o,drop:l,files:u})=>[f("div",{class:"",onDragenter:t[3]||(t[3]=k((()=>{}),["stop","prevent"])),onDragover:t[4]||(t[4]=k((()=>{}),["stop","prevent"])),onDrop:l},[u?.length?(c(),i("ul",se,[(c(!0),i(h,null,y(u,(t=>(c(),i("li",{key:t.name},[f("div",oe,[f("div",le,[f("div",ne,[t.type.startsWith("image")?(c(),i("img",{key:0,class:"h-14 w-14 rounded-xl object-cover object-center",src:o(t).value,alt:"Image preview"},null,8,ie)):(c(),i("img",de))]),f("div",ue,[f("span",ce,p(t.name),1),f("span",me,p(("formatFileSize"in e?e.formatFileSize:b(M))(t.size)),1)])]),f("div",{class:j(["ms-auto w-32 px-4 transition-opacity duration-300","opacity-100"])},[d(n,{value:0,size:"xs",color:"success"})]),f("div",pe,[f("button",be,[d(a,{name:"lucide:slash",class:"h-4 w-4"}),fe]),f("button",ve,[d(a,{name:"lucide:arrow-up",class:"h-4 w-4"}),ge]),f("button",{class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Remove",onClick:k((e=>s(t)),["prevent"])},[d(a,{name:"lucide:x",class:"h-4 w-4"}),ye],8,he)])])])))),128))])):(c(),i("div",{key:0,class:"nui-focus border-muted-300 dark:border-muted-700 hover:border-muted-400 focus:border-muted-400 dark:hover:border-muted-600 dark:focus:border-muted-700 group cursor-pointer rounded-lg border-[3px] border-dashed transition-colors duration-300",tabindex:"0",role:"button",onClick:r,onKeydown:w(k(r,["prevent"]),["enter"])},[f("div",ee,[d(a,{name:"mdi-light:cloud-upload",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 mb-2 h-10 w-10 transition-colors duration-300"}),f("h4",te,p(e.$t("Drop file to upload")),1),f("div",null,[f("span",re,p(e.$t("Or")),1)]),f("label",ae,p(e.$t("Select Image")),1)])],40,Z))],40,N)])),_:2},1032,["modelValue"])]))],64))],64)))),128))])])),_:1})])}}});export{xe as default};
