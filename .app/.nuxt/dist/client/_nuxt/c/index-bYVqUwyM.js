import{_ as e}from"./BaseInput.vue-iInHQMIA.js";import{d as l,a,ad as t,z as o,r as s,c as d,E as r,b as n,e as u,w as c,u as i,an as m,o as p,f,p as h,t as v,F as g,B as b,O as x,q as w,k as y,x as _,X as B,s as V,Y as k,ag as C,ao as U}from"../e/entry-8qgg5CL-.js";import{_ as A,a as j}from"./FlexTableRow.vue-LmGXINIn.js";import{_ as $}from"./FlexTableCell.vue-Rbj2Whgl.js";import{_ as M}from"./BaseTag.vue-NMkN1Uk8.js";import{_ as E,a as F}from"./BaseDropdown.vue-wSpyT9xX.js";import{_ as D}from"./BasePagination.vue-eKZkqxB7.js";import{_ as I}from"./TairoFlexTable-zdoraqRc.js";import{_ as T}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{_ as L}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as P}from"./BaseSwitchThin.vue-BxMY_B8T.js";import{u as S}from"./useForex-v_V55_1y.js";import{_ as N,a as q}from"./placeholder-search-1-dark-6GG3FkNl.js";import{z,u as O,t as X,F as R}from"./vee-validate.esm-n59zZCC5.js";import"./input-id-wZ-Ta08j.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./menu-KWZreDHB.js";import"./use-text-value-9iwzs_EA.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";const W=l({id:"adminForexAccount",state:()=>({accounts:[],loading:!1,selectedAccount:null}),getters:{getAccountById:e=>l=>e.accounts.find((e=>e.id===l))},actions:{async fetchForexAccounts(){this.loading=!0;try{const{getAdminForexAccounts:e}=S(),l=await e();this.accounts=l.data.result}catch(e){console.error("Error fetching accounts:",e)}this.loading=!1},async removeAccount(e){const l=this.accounts.findIndex((l=>l.id===e));this.accounts.splice(l,1)},async selectAccount(e){this.selectedAccount=e},async selectAccountById(e){this.selectedAccount=this.accounts.find((l=>l.id===e))||null}}}),Y={class:"pb-10"},G={"data-nui-tooltip":"Account ID, User UUID, User Name"},H={class:"w-full"},J={key:0,class:"space-y-4"},K={class:"flex flex-col items-center justify-center gap-3 text-center sm:flex-row sm:justify-start sm:text-left"},Q={class:"space-y-2"},Z={class:"flex flex-col gap-4 pt-4 sm:ms-auto sm:flex-row sm:items-center sm:justify-end sm:pt-0"},ee={class:"flex w-full items-center justify-center sm:w-[160px] sm:justify-end"},le={class:"ptablet:hidden divide-muted-200 dark:divide-muted-700 flex items-center justify-center divide-x"},ae={class:"flex flex-col gap-1 px-4 text-center"},te={class:"flex flex-col gap-1 px-4 text-center"},oe={class:"flex flex-col gap-1 px-4 text-center"},se={class:"ptablet:hidden flex w-full items-center justify-center gap-1 py-3 sm:w-[160px] sm:justify-end sm:py-0"},de={class:"sm:ms-6"},re={key:1},ne=f("img",{class:"block dark:hidden",src:N,alt:"Placeholder image"},null,-1),ue=f("img",{class:"hidden dark:block",src:q,alt:"Placeholder image"},null,-1),ce={class:"flex w-full items-center justify-between p-4 md:p-6"},ie={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},me={class:"p-4 md:p-6"},pe={class:"mx-auto w-full text-start"},fe={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},he={class:"grid gap-5 grid-cols-1 sm:grid-cols-2"},ve={class:"p-4 md:p-6"},ge={class:"flex gap-x-2"},be={class:"flex w-full items-center justify-between p-4 md:p-6"},xe={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},we={class:"p-4 md:p-6"},ye={class:"mx-auto w-full text-start"},_e={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},Be={class:"grid gap-5 grid-cols-1 sm:grid-cols-2 mb-5"},Ve={class:"p-4 md:p-6"},ke={class:"flex gap-x-2"},Ce={class:"flex w-full items-center justify-between p-4 md:p-6"},Ue={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},Ae={class:"p-4 md:p-6"},je={class:"mx-auto w-full text-center"},$e={class:"font-heading text-muted-800 text-lg font-medium leading-6 dark:text-white"},Me={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},Ee={class:"p-4 md:p-6"},Fe={class:"flex gap-x-2"},De=a({__name:"index",setup(l){const{toast:a}=t(),N=o(),q=s(!0),{createAdminForexAccount:De,updateAdminForexAccount:Ie}=S(),Te=W(),Le=d((()=>Te.accounts));r((async()=>{q.value=!0,0===Te.accounts.length&&await Te.fetchForexAccounts(),q.value=!1}));const Pe=s(""),Se=s(10),Ne=d((()=>parseInt(N.query.page??"1"))),qe=s(!1),ze=s(!1),Oe=d((()=>{if(Le.value&&Array.isArray(Le.value)){if(!Pe.value)return Le.value;const e=Pe.value.toLowerCase();return Le.value.filter((l=>{const a=l.user?`${l.user.first_name} ${l.user.last_name}`.toLowerCase():"";return l.user&&(a.includes(e)||l.user?.uuid.includes(e)||l.account_id&&l.account_id.toString().includes(Pe.value))}))}return[]})),Xe=d((()=>{const e=(Ne.value-1)*Se.value,l=e+Se.value;return Oe.value.slice(e,l)})),Re=z.object({account_id:z.string().nonempty(),broker:z.string().nonempty(),password:z.string().nonempty(),mt:z.enum(["4","5"]),type:z.enum(["DEMO","LIVE"]),status:z.boolean().optional(),balance:z.number().optional(),leverage:z.number().optional()}),We=d((()=>({account_id:"",broker:"",password:"",mt:"4",type:"DEMO",status:!0,balance:0,leverage:1}))),Ye=d((()=>["4","5"])),Ge=d((()=>["DEMO","LIVE"])),{handleSubmit:He,isSubmitting:Je,resetForm:Ke,setFieldValue:Qe}=O({validationSchema:X(Re),initialValues:We}),Ze=He((async e=>{if(Le.value&&Le.value.length>0&&Le.value.some((l=>l.account_id===e.account_id&&l.mt===e.mt)))return a.warning("Account already exists"),void(qe.value=!1);try{const l=await De(e.account_id,e.broker,e.password,Number(e.mt),e.type,e.status??!0,e.balance??0,e.leverage??1);a.response(l),"success"===l.status&&(await Te.fetchForexAccounts(),Ke())}catch(l){a.danger(l)}qe.value=!1})),el=He((async e=>{try{const l=await Ie(tl.value?.id,e.account_id,e.broker,e.password,Number(e.mt),e.type,e.status??!0,e.balance??0,e.leverage??1);a.response(l),"success"===l.status&&(await Te.fetchForexAccounts(),Ke())}catch(l){a.danger(l)}tl.value=null,ze.value=!1})),ll=s(!1),al=s(!1),tl=s(null);return(l,a)=>{const t=e,o=_,s=B,d=V,r=k,S=C,N=A,z=$,O=M,X=E,W=F,De=j,Ie=D,Te=I,Oe=T,Re=U,We=L,He=P,Ke=m;return p(),n("div",Y,[u(Oe,null,{left:c((()=>[f("span",G,[u(t,{modelValue:i(Pe),"onUpdate:modelValue":a[0]||(a[0]=e=>h(Pe)?Pe.value=e:null),icon:"lucide:search",placeholder:"Filter accounts...",classes:{wrapper:"w-full sm:w-auto"}},null,8,["modelValue"])])])),right:c((()=>[f("div",H,[u(s,{color:"success",class:"w-full",onClick:a[1]||(a[1]=e=>qe.value=!0),flavor:"outline"},{default:c((()=>[u(o,{name:"line-md:plus",class:"h-4 w-4"}),f("span",null,v(l.$t("Create Account")),1)])),_:1})])])),default:c((()=>[f("div",null,[i(q)?(p(),n("div",J,[(p(),n(g,null,b(3,(e=>u(r,{key:e,class:"flex flex-col p-5 sm:flex-row sm:items-center"},{default:c((()=>[f("div",K,[u(d,{class:"h-16 w-16 shrink-0 rounded-full"}),f("div",Q,[u(d,{class:"mx-auto h-3 w-[100px] rounded-lg sm:mx-0"}),u(d,{class:"mx-auto h-3 w-[75px] rounded-lg sm:mx-0"})])]),f("div",Z,[f("div",ee,[u(d,{class:"h-6 w-24 rounded-full"})]),f("div",le,[f("div",ae,[u(d,{class:"h-3 w-16 rounded-lg"})]),f("div",te,[u(d,{class:"h-3 w-16 rounded-lg"})]),f("div",oe,[u(d,{class:"h-3 w-16 rounded-lg"})])]),f("div",se,[u(d,{class:"h-8 w-8 shrink-0 rounded-full"}),u(d,{class:"h-8 w-8 shrink-0 rounded-full"}),u(d,{class:"hidden h-3 w-12 rounded-full sm:block"})]),f("div",de,[u(d,{class:"mx-auto h-8 w-40 rounded-lg sm:mx-0 sm:w-20"})])])])),_:2},1024))),64))])):i(q)||0!==i(Xe).length?(p(),x(Te,{key:2,class:"pt-5"},{default:c((()=>[(p(!0),n(g,null,b(i(Xe),((e,l)=>(p(),x(De,{key:e.id,spaced:""},{start:c((()=>[u(N,{label:"User","hide-label":l>0,logo:e.user?.avatar??"/img/placeholder.png",title:e.user?`${e.user?.first_name} ${e.user?.last_name}`:"Not Assigned",subtitle:e.account_id??"No account ID"},null,8,["hide-label","logo","title","subtitle"])])),end:c((()=>[u(z,{label:"Type","hide-label":l>0,class:"w-20 xs:w-full text-sm"},{default:c((()=>[w(v(e.type),1)])),_:2},1032,["hide-label"]),u(z,{label:"Leverage","hide-label":l>0,class:"w-20 xs:w-full text-sm"},{default:c((()=>[w("x"+v(e.leverage),1)])),_:2},1032,["hide-label"]),u(z,{label:"Balance","hide-label":l>0,class:"w-20 xs:w-full text-sm"},{default:c((()=>[w(v(e.balance),1)])),_:2},1032,["hide-label"]),u(z,{label:"Status","hide-label":l>0,class:"w-20 xs:w-full"},{default:c((()=>[u(O,{color:e.status?"success":"danger",flavor:"pastel",condensed:""},{default:c((()=>[w(v(e.status?"Active":"Disabled"),1)])),_:2},1032,["color"])])),_:2},1032,["hide-label"]),u(z,{label:"Actions","hide-label":l>0},{default:c((()=>[u(W,{flavor:"context",label:"Dropdown",orientation:"end"},{default:c((()=>[u(X,{onClick:l=>(e=>{tl.value=e,Qe("account_id",e.account_id),Qe("broker",e.broker),Qe("password",e.password),Qe("mt",`${e.mt}`),Qe("type",e.type),Qe("status",e.status),Qe("balance",e.balance),Qe("leverage",e.leverage),ze.value=!0})(e),title:"Edit Account"},{start:c((()=>[u(o,{name:"line-md:edit-twotone",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"]),u(X,{onClick:l=>function(e){tl.value=e,ll.value=!0}(e),title:"Delete Account"},{start:c((()=>[u(o,{name:"line-md:close",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["hide-label"])])),_:2},1024)))),128)),f("div",null,[i(Le).length>i(Se)?(p(),x(Ie,{key:0,"total-items":i(Le).length,"item-per-page":i(Se),"current-page":i(Ne),shape:"full"},null,8,["total-items","item-per-page","current-page"])):y("",!0)])])),_:1})):(p(),n("div",re,[u(S,{title:i(Pe)&&""!==i(Pe)?"No matching results":"No results",subtitle:i(Pe)&&""!==i(Pe)?"Looks like we couldn't find any matching results for your search terms. Try other search terms.":"Looks like we don't have any data here yet."},{image:c((()=>[ne,ue])),_:1},8,["title","subtitle"])]))])])),_:1}),u(Ke,{open:i(qe),size:"lg",onClose:a[4]||(a[4]=e=>qe.value=!1)},{header:c((()=>[f("div",ce,[f("h3",ie,v(l.$t("Create New Account")),1),u(Re,{onClick:a[2]||(a[2]=e=>qe.value=!1)})])])),footer:c((()=>[f("div",ve,[f("div",ge,[u(s,{onClick:a[3]||(a[3]=e=>qe.value=!1)},{default:c((()=>[w(v(l.$t("Cancel")),1)])),_:1}),u(s,{color:"primary",flavor:"solid",onClick:i(Ze),disabled:i(Je),loading:i(Je)},{default:c((()=>[w(v(l.$t("Create")),1)])),_:1},8,["onClick","disabled","loading"])])])])),default:c((()=>[f("div",me,[f("div",pe,[f("p",fe,v(l.$t("Please provide a unique account and timeframe for the new account"))+". ",1),f("div",he,[u(i(R),{name:"account_id"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:o})=>[u(t,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:i(Je),type:"text",label:"Account ID",placeholder:"Enter account ID",onBlur:o,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),u(i(R),{name:"password"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:o})=>[u(t,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:i(Je),type:"password",label:"Password",placeholder:"Enter password",onBlur:o,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),u(i(R),{name:"broker"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:o})=>[u(t,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:i(Je),type:"text",label:"Broker",placeholder:"Enter broker",onBlur:o,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),u(i(R),{name:"balance"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:o})=>[u(t,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:i(Je),type:"number",label:"Balance",placeholder:"Enter balance",onBlur:o,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),u(i(R),{name:"leverage"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:o})=>[u(t,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:i(Je),type:"number",label:"Leverage",placeholder:"Enter leverage",onBlur:o,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),u(i(R),{name:"mt"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:t})=>[u(We,{"model-value":e.value,error:l,disabled:i(Je),items:i(Ye),placeholder:"Please select an option",label:"MetaTrader Version",shape:"rounded","onUpdate:modelValue":a,onBlur:t},null,8,["model-value","error","disabled","items","onUpdate:modelValue","onBlur"])])),_:1}),u(i(R),{name:"type"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:t})=>[u(We,{"model-value":e.value,error:l,disabled:i(Je),items:i(Ge),placeholder:"Please select an option",label:"Account Type",shape:"rounded","onUpdate:modelValue":a,onBlur:t},null,8,["model-value","error","disabled","items","onUpdate:modelValue","onBlur"])])),_:1}),u(i(R),{name:"status"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:t})=>[u(He,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:i(Je),label:"Status",color:"success",onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})])])])])),_:1},8,["open"]),u(Ke,{open:i(ze),size:"lg",onClose:a[7]||(a[7]=e=>ze.value=!1)},{header:c((()=>[f("div",be,[f("h3",xe,v(l.$t("Edit Account")),1),u(Re,{onClick:a[5]||(a[5]=e=>ze.value=!1)})])])),footer:c((()=>[f("div",Ve,[f("div",ke,[u(s,{onClick:a[6]||(a[6]=e=>ze.value=!1)},{default:c((()=>[w(v(l.$t("Cancel")),1)])),_:1}),u(s,{color:"primary",flavor:"solid",onClick:i(el),disabled:i(Je),loading:i(Je)},{default:c((()=>[w(v(l.$t("Update")),1)])),_:1},8,["onClick","disabled","loading"])])])])),default:c((()=>[f("div",we,[f("div",ye,[f("p",_e,v(l.$t("Please provide a unique account and timeframe for the new account"))+". ",1),f("div",Be,[u(i(R),{name:"account_id"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:o})=>[u(t,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:i(Je),type:"text",label:"Account ID",placeholder:"Enter account ID",onBlur:o,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),u(i(R),{name:"password"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:o})=>[u(t,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:i(Je),type:"password",label:"Password",placeholder:"Enter password",onBlur:o,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),u(i(R),{name:"broker"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:o})=>[u(t,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:i(Je),type:"text",label:"Broker",placeholder:"Enter broker",onBlur:o,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),u(i(R),{name:"balance"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:o})=>[u(t,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:i(Je),type:"number",label:"Balance",placeholder:"Enter balance",onBlur:o,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),u(i(R),{name:"leverage"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:o})=>[u(t,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:i(Je),type:"number",label:"Leverage",placeholder:"Enter leverage",onBlur:o,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),u(i(R),{name:"mt"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:t})=>[u(We,{"model-value":e.value,error:l,disabled:i(Je),items:i(Ye),placeholder:"Please select an option",label:"MetaTrader Version",shape:"rounded","onUpdate:modelValue":a,onBlur:t},null,8,["model-value","error","disabled","items","onUpdate:modelValue","onBlur"])])),_:1}),u(i(R),{name:"type"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:t})=>[u(We,{"model-value":e.value,error:l,disabled:i(Je),items:i(Ge),placeholder:"Please select an option",label:"Account Type",shape:"rounded","onUpdate:modelValue":a,onBlur:t},null,8,["model-value","error","disabled","items","onUpdate:modelValue","onBlur"])])),_:1})]),u(i(R),{name:"status"},{default:c((({field:e,errorMessage:l,handleChange:a,handleBlur:t})=>[u(He,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:i(Je),label:"Status",color:"success",onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})])])])),_:1},8,["open"]),u(Ke,{open:i(ll),size:"sm",onClose:a[11]||(a[11]=e=>ll.value=!1)},{header:c((()=>[f("div",Ce,[f("h3",Ue,v(l.$t("Delete"))+" "+v(l.$t("Forex Account")),1),u(Re,{onClick:a[8]||(a[8]=e=>ll.value=!1)})])])),footer:c((()=>[f("div",Ee,[f("div",Fe,[u(s,{onClick:a[9]||(a[9]=e=>ll.value=!1)},{default:c((()=>[w(v(l.$t("Cancel")),1)])),_:1}),u(s,{color:"danger",flavor:"solid",onClick:a[10]||(a[10]=e=>l.deleteAccount()),disabled:i(al),loading:i(al)},{default:c((()=>[w(v(l.$t("Delete")),1)])),_:1},8,["disabled","loading"])])])])),default:c((()=>[f("div",Ae,[f("div",je,[f("h3",$e,v(l.$t("Are you sure?")),1),f("p",Me,v(l.$t("Do you really want to delete this"))+" "+v(l.$t("account"))+" "+v(l.$t("This process cannot be undone"))+". ",1)])])])),_:1},8,["open"])])}}});export{De as default};
