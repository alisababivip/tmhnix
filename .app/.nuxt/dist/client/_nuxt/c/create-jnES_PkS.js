import{a as e,ad as a,ac as l,ap as r,c as s,Q as t,E as n,J as o,O as u,w as d,o as i,e as m,q as c,t as p,u as h,f,_ as g,x as y,X as v,Y as b}from"../e/entry-8qgg5CL-.js";import{_ as V}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as B}from"./BaseInput.vue-iInHQMIA.js";import{_}from"./BaseTextarea.vue-8st5U0qk.js";import{_ as C}from"./TairoFormSave.vue-aLVbwikq.js";import{_ as k}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as x}from"./useStaking-1DgbeL2_.js";import{u as E}from"./currency-9FjTf2Bf.js";import{z as S,u as j,t as w,F as T}from"./vee-validate.esm-n59zZCC5.js";import{u as U}from"./admin-Nwh6nXjV.js";import{u as M}from"./pools-MsQdbYRA.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";import"./input-id-wZ-Ta08j.js";import"./useExchange-VMAYQu3P.js";import"./useEcosystem-9eBUNbsT.js";const P={class:"grid gap-5 grid-cols-1 sm:grid-cols-2"},I=f("small",null,[f("span",{class:"text-warning-500 text-xs"},"Capital letters only, e.g. BSC, ETH, etc. ")],-1),A=e({__name:"create",setup(e){const{toast:A}=a(),O=l(),q=M(),{createAdminStakingPool:F}=x(),N=r(),$=s((()=>N.extensions)),D=s((()=>$.value?.find((e=>"ecosystem"===e.name)))),L=t(),W=s((()=>L.settings)),J=E(),Q=s((()=>J.currencies)),z=U(),H=s((()=>z.tokens)),X=[];n((async()=>{0===N.extensions.length&&await N.fetchExtensions(),W.value?.spot_exchange&&(X.push("SPOT"),0===J.currencies.length&&await J.fetchCurrencies()),D.value?.status&&(X.push("ECO"),0===z.tokens.length&&await z.fetchTokensAll()),ee()}));const Y=s((()=>{let e=[];"SPOT"===ae.type?e=Q.value.map((e=>e.currency)):"ECO"===ae.type&&(e=H.value.map((e=>e.currency)));return[...new Set(e)]})),G=S.object({name:S.string().nonempty("Name is required"),description:S.string().nullable(),currency:S.string().nonempty("Currency is required"),chain:S.string().nonempty("Chain is required"),type:S.enum(X),min_stake:S.number().min(0,"Min stake must be greater than 0"),max_stake:S.number().min(0,"Max stake must be greater than 0"),status:S.enum(["ACTIVE","INACTIVE","COMPLETED"])}),K=s((()=>({name:"",description:"",currency:"",chain:"",type:"",min_stake:0,max_stake:0,status:"ACTIVE"}))),{handleSubmit:R,isSubmitting:Z,resetForm:ee,values:ae,setFieldValue:le}=j({validationSchema:w(G),initialValues:K});o((()=>ae.type),(e=>{e&&le("currency","")}));const re=R((async e=>{try{const a=await F(e.name,e.description,e.currency,e.chain,e.type,e.min_stake,e.max_stake,e.status);A.response(a),"success"===a.status&&(await q.fetchStakingPools(),O.push("/admin/extensions/staking/pools"))}catch(a){A.danger(a)}}));return(e,a)=>{const l=g,r=y,s=v,t=V,n=B,o=_,x=b,E=C,S=k;return i(),u(S,null,{left:d((()=>[m(l,{size:"lg"},{default:d((()=>[c(p(e.$t("Create Staking Pool")),1)])),_:1})])),right:d((()=>[m(s,{type:"button",color:"muted",class:"hover:bg-gray-300 dark:hover:bg-gray-800",to:"/admin/extensions/staking/pools"},{default:d((()=>[m(r,{name:"line-md:chevron-left",class:"h-4 w-4 mr-2"}),c(" "+p(e.$t("Back")),1)])),_:1}),m(s,{type:"submit",color:"primary",disabled:h(Z),class:"w-full",onClick:h(re)},{default:d((()=>[c(p(e.$t("Create Pool")),1)])),_:1},8,["disabled","onClick"])])),default:d((()=>[f("form",{onSubmit:a[0]||(a[0]=(...e)=>h(re)&&h(re)(...e)),class:"space-y-8"},[m(x,{class:"p-5 space-y-5"},{default:d((()=>[f("div",P,[m(h(T),{name:"type"},{default:d((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[m(t,{"model-value":e.value,error:a,items:X,label:"Purchase Wallet Type",placeholder:"Select wallet type",shape:"rounded","onUpdate:modelValue":l,onBlur:r},null,8,["model-value","error","onUpdate:modelValue","onBlur"])])),_:1}),m(h(T),{name:"currency"},{default:d((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[m(t,{"model-value":e.value,error:a,items:h(Y),label:"Purchase Currency",placeholder:"Select purchase currency",disabled:!h(ae)?.type||""===h(ae)?.type,"onUpdate:modelValue":l,onBlur:r},null,8,["model-value","error","items","disabled","onUpdate:modelValue","onBlur"])])),_:1}),m(h(T),{name:"name"},{default:d((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[m(n,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:h(Z),type:"text",label:"Name",placeholder:"Enter name",shape:"rounded",class:"w-full",onBlur:r},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),f("div",null,[m(h(T),{name:"chain"},{default:d((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[m(n,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:h(Z),type:"text",label:"Pool Chain",placeholder:"Enter chain",shape:"rounded",class:"w-full",onBlur:r},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"]),I])),_:1})]),m(h(T),{name:"status"},{default:d((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[m(t,{"model-value":e.value,error:a,items:["ACTIVE","INACTIVE","COMPLETED"],placeholder:"Select a status",label:"Status",shape:"rounded","onUpdate:modelValue":l,onBlur:r},null,8,["model-value","error","onUpdate:modelValue","onBlur"])])),_:1}),m(h(T),{name:"min_stake"},{default:d((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[m(n,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:h(Z),type:"number",label:"Min Stake",placeholder:"Enter min stake",shape:"rounded",class:"w-full",onBlur:r},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),m(h(T),{name:"max_stake"},{default:d((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[m(n,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:h(Z),type:"number",label:"Max Stake",placeholder:"Enter max stake",shape:"rounded",class:"w-full",onBlur:r},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})]),m(h(T),{name:"description"},{default:d((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[m(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,label:"Description",shape:"rounded",placeholder:"Write a description",class:"w-full",onBlur:r},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1})])),_:1}),m(E,null,{default:d((()=>[m(s,{type:"submit",color:"primary",disabled:h(Z),class:"w-full"},{default:d((()=>[c(p(e.$t("Create Pool")),1)])),_:1},8,["disabled"])])),_:1})],32)])),_:1})}}});export{A as default};
