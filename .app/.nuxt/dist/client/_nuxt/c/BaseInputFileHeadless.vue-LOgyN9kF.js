import{au as e,c as a,r as t,a as s,i,a2 as l,a4 as r,o as n,b as o,j as u,u as f,f as d,m as p}from"../e/entry-8qgg5CL-.js";import{u as v}from"./input-id-wZ-Ta08j.js";const c=new WeakMap;function m(s){const i=e(s);return a((()=>{const e=i.value;if(!e)return"";if(c.has(e))return c.get(e)?.value;const a=new FileReader,s=t(""),l=()=>{s.value=a.result?.toString()??"",a.removeEventListener("load",l)};return a.addEventListener("load",l),a.readAsDataURL(e),c.set(e,s),c.get(e)?.value}))}const g={class:"group/nui-file-headless relative"},w=["id"],h=s({inheritAttrs:!1,__name:"BaseInputFileHeadless",props:{modelValue:{default:void 0},id:{default:void 0},filterFileDropped:{type:Function,default:()=>!0}},emits:["update:modelValue"],setup(e,{expose:a,emit:s}){const c=e,h=s,D=t(),F=i(c,"modelValue",h,{passive:!0}),k=v((()=>c.id)),y=new WeakMap;function _(){D.value?.click()}function j(e){e.stopPropagation(),e.preventDefault();const a=e.dataTransfer,t=new DataTransfer;if(D.value&&a){for(const e of a.files)c.filterFileDropped(e)&&t.items.add(e);D.value.files=t.files,F.value=D.value.files}}function x(e){if(!e)return;if(!F.value)return;if(!D.value)return;const a=new DataTransfer;y.has(e)&&y.delete(e);for(const t of F.value)t!==e&&a.items.add(t);D.value.files=a.files,F.value=D.value.files}return l("BaseInputFileHeadlessContext",r({el:D,id:k,files:F,open:_,remove:x,preview:m,drop:j})),a({el:D,id:k,files:F,open:_,remove:x,preview:m,drop:j}),(e,a)=>(n(),o("div",g,[u(e.$slots,"default",{id:f(k),el:f(D),files:f(F),open:_,remove:x,preview:f(m),drop:j}),d("input",p({id:f(k),ref_key:"inputRef",ref:D,type:"file"},e.$attrs,{class:"hidden",onChange:a[0]||(a[0]=e=>F.value=e.target.files)}),null,16,w)]))}});export{h as _};
