import{_ as e}from"./BaseInput.vue-iInHQMIA.js";import{a,S as l,c as t,z as s,ad as o,ac as u,r,E as i,b as n,e as c,w as d,u as m,an as p,o as v,f,p as g,O as h,q as k,t as w,af as y,k as b,n as _,F as x,B as j,x as T,X as D,Y as $,ag as V,ao as C}from"../e/entry-8qgg5CL-.js";import{_ as I}from"./BaseSelect.vue-p0KYznCX.js";import{_ as B}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as E,a as S}from"./FlexTableRow.vue-LmGXINIn.js";import{_ as L}from"./BaseTag.vue-NMkN1Uk8.js";import{_ as P}from"./FlexTableCell.vue-Rbj2Whgl.js";import{_ as U,a as N}from"./BaseDropdown.vue-wSpyT9xX.js";import{_ as A}from"./TairoFlexTable-zdoraqRc.js";import{_ as F}from"./BasePagination.vue-eKZkqxB7.js";import{_ as O}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as q}from"./useSupport-ffNMpQhG.js";import{_ as G,a as H}from"./placeholder-search-4-dark-Jht91LnM.js";import{u as M}from"./admin-rBAA3x0i.js";import"./input-id-wZ-Ta08j.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";import"./menu-KWZreDHB.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";const W={class:"w-full flex gap-2 xs:flex-col sm:flex-row"},z={value:10},R={value:25},X={value:50},Y={value:100},J=f("img",{class:"block dark:hidden",src:G,alt:"Placeholder image"},null,-1),K=f("img",{class:"hidden dark:block",src:H,alt:"Placeholder image"},null,-1),Q={key:1,class:"w-full sm:pt-5"},Z={class:"mt-6"},ee={class:"flex w-full items-center justify-between p-4 md:p-6"},ae={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},le={class:"p-4 md:p-6"},te={class:"mx-auto w-full text-center"},se={class:"font-heading text-muted-800 text-lg font-medium leading-6 dark:text-white"},oe={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},ue={class:"p-4 md:p-6"},re={class:"flex gap-x-2"},ie=a({__name:"index",setup(a){const G=M(),H=l(),ie=t((()=>H.getProfile)),ne=s(),{toast:ce}=o(),{deleteTicket:de}=q(),me=u(),pe=r(""),ve=t((()=>ne.query.status)),fe=t((()=>ne.query.importance)),ge=r(!1),he=r(""),ke=r(10),we=t((()=>parseInt(ne.query.page??"1"))),ye=t((()=>G.tickets.filter((e=>e.user_id!==ie.value?.id))));i((async()=>{ge.value=!0,0===G.tickets.length&&await G.fetchTickets(),ge.value=!1}));const be=t((()=>ye.value.filter((e=>(!De.value||"All"===De.value||e.status===De.value)&&((!$e.value||"All"===$e.value||e.importance===$e.value)&&(!(Ve.value&&new Date(e.created_at)<new Date(Ve.value))&&(!(Ce.value&&new Date(e.created_at)>new Date(Ce.value))&&(he.value&&""!==he.value&&void 0!==he.value&&he.value!==pe.value&&(me.push({query:{...ne.query,page:"1",filter:he.value}}),pe.value=he.value),!he.value||e.user.uuid?.includes(he.value))))))).sort(((e,a)=>new Date(a.created_at).getTime()-new Date(e.created_at).getTime())))),_e=t((()=>{const e=(we.value-1)*ke.value,a=e+ke.value;return be.value.slice(e,a)})),xe=e=>{switch(e){case"PENDING":return"warning";case"OPEN":return"success";case"CLOSED":return"danger";default:return"info"}},je=e=>{switch(e){case"LOW":default:return"info";case"MEDIUM":return"warning";case"HIGH":return"danger"}},Te=r(!1),De=r(""),$e=r(""),Ve=r(""),Ce=r(""),Ie=["All","PENDING","OPEN","REPLIED","CLOSED"],Be=["All","LOW","MEDIUM","HIGH"],Ee=t((()=>{let e=2;return ve.value&&e--,fe.value&&e--,e})),Se=r(!1),Le=r(!1);return(a,l)=>{const t=e,s=T,o=D,u=I,r=B,i=$,q=V,H=E,M=L,ie=P,ne=U,me=N,pe=S,ye=A,Pe=F,Ue=O,Ne=C,Ae=p;return v(),n("div",null,[c(Ue,null,{left:d((()=>[f("div",W,[c(t,{modelValue:m(he),"onUpdate:modelValue":l[0]||(l[0]=e=>g(he)?he.value=e:null),icon:"lucide:search",classes:{wrapper:"w-full sm:w-auto"},placeholder:"Search Ticket ID..."},null,8,["modelValue"]),c(o,{onClick:l[1]||(l[1]=e=>Te.value=!m(Te)),color:"muted",block:""},{default:d((()=>[m(Te)?(v(),h(s,{key:0,name:"line-md:arrow-up",class:"h-4 w-4 mr-2"})):(v(),h(s,{key:1,name:"line-md:arrow-down",class:"h-4 w-4 mr-2"})),k(" "+w(a.$t("Filters")),1)])),_:1})])])),right:d((()=>[c(u,{modelValue:m(ke),"onUpdate:modelValue":l[2]||(l[2]=e=>g(ke)?ke.value=e:null),label:"",classes:{wrapper:"w-full sm:w-40"}},{default:d((()=>[f("option",z,"10 "+w(a.$t("per page")),1),f("option",R,"25 "+w(a.$t("per page")),1),f("option",X,"50 "+w(a.$t("per page")),1),f("option",Y,"100 "+w(a.$t("per page")),1)])),_:1},8,["modelValue"])])),default:d((()=>[f("div",null,[c(y,{"enter-active-class":"transform-gpu","enter-from-class":"opacity-0 -translate-y-4","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"absolute transform-gpu","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 -translate-y-4"},{default:d((()=>[m(Te)?(v(),h(i,{key:0,class:_(`grid gap-4 xs:grid-cols-1 sm:grid-cols-2 md:grid-cols-${m(Ee)} lg:grid-cols-${m(Ee)+2} mb-6 p-5`)},{default:d((()=>[m(ve)?b("",!0):(v(),h(r,{key:0,modelValue:m(De),"onUpdate:modelValue":l[3]||(l[3]=e=>g(De)?De.value=e:null),label:"Status",items:Ie,placeholder:"Select status"},null,8,["modelValue"])),m(fe)?b("",!0):(v(),h(r,{key:1,modelValue:m($e),"onUpdate:modelValue":l[4]||(l[4]=e=>g($e)?$e.value=e:null),label:"Importance",items:Be,placeholder:"Select ticket importance"},null,8,["modelValue"])),c(t,{modelValue:m(Ve),"onUpdate:modelValue":l[5]||(l[5]=e=>g(Ve)?Ve.value=e:null),type:"date",label:"From"},null,8,["modelValue"]),c(t,{modelValue:m(Ce),"onUpdate:modelValue":l[6]||(l[6]=e=>g(Ce)?Ce.value=e:null),type:"date",label:"To"},null,8,["modelValue"])])),_:1},8,["class"])):b("",!0)])),_:1}),m(ge)||0!==m(_e)?.length?(v(),n("div",Q,[c(ye,null,{default:d((()=>[c(y,{"enter-active-class":"transform-gpu","enter-from-class":"opacity-0 -translate-x-full","enter-to-class":"opacity-100 translate-x-0","leave-active-class":"absolute transform-gpu","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 -translate-x-full"},{default:d((()=>[(v(!0),n(x,null,j(m(_e),((e,a)=>(v(),h(pe,{key:e.id,spaced:""},{start:d((()=>[c(H,{label:"User","hide-label":a>0,logo:e.user?.avatar,title:e.subject,subtitle:`${e.user?.first_name} ${e.user?.last_name}`},null,8,["hide-label","logo","title","subtitle"])])),end:d((()=>[c(ie,{label:"Importance","hide-label":a>0,class:"w-20 xs:w-full"},{default:d((()=>[c(M,{color:je(e.importance),flavor:"pastel",condensed:""},{default:d((()=>[k(w(e.importance),1)])),_:2},1032,["color"])])),_:2},1032,["hide-label"]),c(ie,{label:"Status","hide-label":a>0,class:"w-20 xs:w-full"},{default:d((()=>[c(M,{color:xe(e.status),flavor:"pastel",condensed:""},{default:d((()=>[k(w(e.status),1)])),_:2},1032,["color"])])),_:2},1032,["hide-label"]),c(ie,{label:"Actions","hide-label":a>0,class:"w-20 xs:justify-end xs:w-full"},{default:d((()=>[c(me,{flavor:"context",label:"Dropdown",orientation:"end"},{default:d((()=>[c(ne,{to:`/admin/support/tickets/${e.uuid}`,title:"View Ticket"},{start:d((()=>[c(s,{name:"ph:eye-duotone",class:"me-2 block h-5 w-5"})])),_:2},1032,["to"]),c(ne,{onClick:a=>function(e){G.currentTicket=e,Se.value=!0}(e),title:"Delete Ticket"},{start:d((()=>[c(s,{name:"line-md:close",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["hide-label"])])),_:2},1024)))),128))])),_:1})])),_:1})])):(v(),h(q,{key:0,title:m(he)&&""!==m(he)?"No matching results":"No results",subtitle:m(he)&&""!==m(he)?"Looks like we couldn't find any matching results for your search terms. Try other search terms.":"Looks like we don't have any data here yet."},{image:d((()=>[J,K])),_:1},8,["title","subtitle"])),f("div",Z,[m(be).length>m(ke)?(v(),h(Pe,{key:0,"total-items":m(be).length,"current-page":m(we),"item-per-page":m(ke)},null,8,["total-items","current-page","item-per-page"])):b("",!0)])])])),_:1}),c(Ae,{open:m(Se),size:"sm",onClose:l[10]||(l[10]=e=>Se.value=!1)},{header:d((()=>[f("div",ee,[f("h3",ae,w(a.$t("Delete"))+" "+w(a.$t("Ticket")),1),c(Ne,{onClick:l[7]||(l[7]=e=>Se.value=!1)})])])),footer:d((()=>[f("div",ue,[f("div",re,[c(o,{onClick:l[8]||(l[8]=e=>Se.value=!1)},{default:d((()=>[k(w(a.$t("Cancel")),1)])),_:1}),c(o,{color:"danger",flavor:"solid",onClick:l[9]||(l[9]=e=>async function(){Le.value=!0;try{const e=await de(G.currentTicket?.uuid);G.tickets=G.tickets.filter((e=>e.uuid!==G.currentTicket?.uuid)),ce.response(e)}catch(e){ce.danger(e)}Se.value=!1,Le.value=!1,G.currentTicket=null}()),disabled:m(Le),loading:m(Le)},{default:d((()=>[k(w(a.$t("Delete")),1)])),_:1},8,["disabled","loading"])])])])),default:d((()=>[f("div",le,[f("div",te,[f("h3",se,w(a.$t("Are you sure?")),1),f("p",oe,w(a.$t("Do you really want to delete this"))+" "+w(a.$t("ticket"))+" "+w(a.$t("This process cannot be undone"))+". "+w(a.$t("This will also delete all the posts associated with this ticket"))+". ",1)])])])),_:1},8,["open"])])}}});export{ie as default};
