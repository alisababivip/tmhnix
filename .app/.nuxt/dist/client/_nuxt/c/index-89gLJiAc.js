import{_ as e}from"./BaseInput.vue-iInHQMIA.js";import{d as t,a,z as l,r as s,c as o,ac as n,E as i,ad as u,b as r,e as d,w as c,u as m,an as p,o as v,p as f,O as b,q as h,t as g,f as y,af as w,n as C,k as x,F as _,B as k,x as $,X as j,Y as D,ag as I,ao as E}from"../e/entry-8qgg5CL-.js";import{_ as T}from"./BaseSelect.vue-p0KYznCX.js";import{_ as V}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as B,a as A}from"./FlexTableRow.vue-LmGXINIn.js";import{_ as P}from"./FlexTableCell.vue-Rbj2Whgl.js";import{_ as F}from"./BaseTag.vue-NMkN1Uk8.js";import{_ as L,a as N}from"./BaseDropdown.vue-wSpyT9xX.js";import{_ as U}from"./TairoFlexTable-zdoraqRc.js";import{_ as O}from"./BasePagination.vue-eKZkqxB7.js";import{_ as S}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as q}from"./useIco-3A31FykS.js";import{_ as R,a as z}from"./placeholder-search-4-dark-Jht91LnM.js";import"./input-id-wZ-Ta08j.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";import"./menu-KWZreDHB.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";const G=t({id:"icoAdminContribution",state:()=>({contributions:[],loading:!1,selectedContribution:null}),getters:{getContributionById:e=>t=>e.contributions.find((e=>e.id===t))},actions:{async fetchIcoContributions(){this.loading=!0;try{const{getAdminIcoContributions:e}=q(),t=await e();this.contributions=t.data.result}catch(e){console.error("Error fetching deposit contributions:",e)}this.loading=!1},async removeContribution(e){const t=this.contributions.findIndex((t=>t.id===e));this.contributions.splice(t,1)},async selectContribution(e){this.selectedContribution=e},async selectContributionById(e){this.selectedContribution=this.contributions.find((t=>t.id===e))||null}}}),J={value:10},M={value:25},W={value:50},X={value:100},Y=y("img",{class:"block dark:hidden",src:R,alt:"Placeholder image"},null,-1),H=y("img",{class:"hidden dark:block",src:z,alt:"Placeholder image"},null,-1),K={key:1,class:"w-full"},Q={class:"mt-6"},Z={class:"flex w-full items-center justify-between p-4 md:p-6"},ee={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},te={class:"p-4 md:p-6"},ae={class:"mx-auto w-full text-center"},le={class:"font-heading text-muted-800 text-lg font-medium leading-6 dark:text-white"},se={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},oe={class:"p-4 md:p-6"},ne={class:"flex gap-x-2"},ie={class:"flex w-full items-center justify-between p-4 md:p-6"},ue={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},re={class:"p-4 md:p-6"},de={class:"mx-auto w-full text-center"},ce={class:"font-heading text-muted-800 text-lg font-medium leading-6 dark:text-white"},me={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},pe={class:"p-4 md:p-6"},ve={class:"flex gap-x-2"},fe=a({__name:"index",setup(t){const a=G(),{deleteIcoContribution:R,payIcoContribution:z}=q(),fe=l(),be=s(""),he=s(10),ge=o((()=>parseInt(fe.query.page??"1"))),ye=n(),we=s(""),Ce=o((()=>a.contributions.filter((e=>!(De.value&&""!==De.value&&!e.user?.uuid?.includes(De.value))&&((!je.value||"All"===je.value||e.status===je.value)&&(!(ke.value&&new Date(e.created_at)<new Date(ke.value))&&(!($e.value&&new Date(e.created_at)>new Date($e.value))&&(be.value&&""!==be.value&&void 0!==be.value&&be.value!==we.value&&(ye.push({query:{...fe.query,page:"1",filter:be.value}}),we.value=be.value),!be.value||e.uuid?.includes(be.value))))))).sort(((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime())))),xe=o((()=>{const e=(ge.value-1)*he.value,t=e+he.value;return Ce.value.slice(e,t)}));i((async()=>{0===a.contributions.length&&(a.loading=!0,await a.fetchIcoContributions(),a.loading=!1)}));const _e=s(!1),ke=s(""),$e=s(""),je=s(""),De=s(""),Ie=["All","PENDING","ACTIVE","COMPLETED","CANCELLED","REJECTED"],{toast:Ee}=u(),Te=s(!1),Ve=s(!1),Be=s(null);const Ae=e=>{switch(e){case"PENDING":return"warning";case"ACTIVE":return"success";case"COMPLETED":return"info";case"CANCELLED":case"REJECTED":return"danger"}},Pe=s(!1),Fe=s(!1),Le=s(null);return(t,l)=>{const s=e,o=$,n=j,i=T,u=V,q=D,G=I,fe=B,ye=P,we=F,Ne=L,Ue=N,Oe=A,Se=U,qe=O,Re=S,ze=E,Ge=p;return v(),r("div",null,[d(Re,null,{left:c((()=>[d(s,{modelValue:m(be),"onUpdate:modelValue":l[0]||(l[0]=e=>f(be)?be.value=e:null),icon:"lucide:search",classes:{wrapper:"w-full sm:w-auto"},placeholder:"Filter contributions..."},null,8,["modelValue"]),d(n,{onClick:l[1]||(l[1]=e=>_e.value=!m(_e)),color:"muted",block:""},{default:c((()=>[m(_e)?(v(),b(o,{key:0,name:"line-md:arrow-up",class:"h-4 w-4 mr-2"})):(v(),b(o,{key:1,name:"line-md:arrow-down",class:"h-4 w-4 mr-2"})),h(" "+g(t.$t("Filters")),1)])),_:1})])),right:c((()=>[d(i,{modelValue:m(he),"onUpdate:modelValue":l[2]||(l[2]=e=>f(he)?he.value=e:null),label:"",classes:{wrapper:"w-full sm:w-40"}},{default:c((()=>[y("option",J,"10 "+g(t.$t("per page")),1),y("option",M,"25 "+g(t.$t("per page")),1),y("option",W,"50 "+g(t.$t("per page")),1),y("option",X,"100 "+g(t.$t("per page")),1)])),_:1},8,["modelValue"])])),default:c((()=>[y("div",null,[d(w,{"enter-active-class":"transform-gpu","enter-from-class":"opacity-0 -translate-y-4","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"absolute transform-gpu","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 -translate-y-4"},{default:c((()=>[m(_e)?(v(),b(q,{key:0,class:C(`grid gap-4 xs:grid-cols-1 sm:grid-cols-2 md:grid-cols-${t.numberOfFiltersToShow} lg:grid-cols-${t.numberOfFiltersToShow+2} mb-6 p-5`)},{default:c((()=>[d(s,{modelValue:m(De),"onUpdate:modelValue":l[3]||(l[3]=e=>f(De)?De.value=e:null),label:"User UUID",placeholder:"Write the user uuid"},null,8,["modelValue"]),d(u,{modelValue:m(je),"onUpdate:modelValue":l[4]||(l[4]=e=>f(je)?je.value=e:null),label:"Status",items:Ie,placeholder:"Select a Status"},null,8,["modelValue"]),d(s,{modelValue:m(ke),"onUpdate:modelValue":l[5]||(l[5]=e=>f(ke)?ke.value=e:null),type:"date",label:"From"},null,8,["modelValue"]),d(s,{modelValue:m($e),"onUpdate:modelValue":l[6]||(l[6]=e=>f($e)?$e.value=e:null),type:"date",label:"To"},null,8,["modelValue"])])),_:1},8,["class"])):x("",!0)])),_:1}),m(a).loading||0!==m(xe)?.length?(v(),r("div",K,[d(Se,{class:"pt-5"},{default:c((()=>[(v(!0),r(_,null,k(m(xe),((e,t)=>(v(),b(Oe,{key:e.id,spaced:""},{start:c((()=>[d(fe,{label:"Item","hide-label":t>0,picture:e.user?.avatar,title:`${e.user?.first_name} ${e.user?.last_name}`,subtitle:e.user?.uuid},null,8,["hide-label","picture","title","subtitle"])])),end:c((()=>[d(ye,{label:"Tokens","hide-label":t>0,class:"w-20 xs:w-full"},{default:c((()=>[h(g(e.amount),1)])),_:2},1032,["hide-label"]),d(ye,{label:"Status","hide-label":t>0,class:"w-20 xs:w-full"},{default:c((()=>[d(we,{color:Ae(e.status),flavor:"pastel",condensed:""},{default:c((()=>[h(g(e.status),1)])),_:2},1032,["color"])])),_:2},1032,["hide-label"]),d(ye,{label:"Actions","hide-label":t>0},{default:c((()=>[d(Ue,{flavor:"context",label:"Dropdown",orientation:"end"},{default:c((()=>[d(Ne,{onClick:t=>function(e){Le.value=e,Pe.value=!0}(e),title:"Pay Contribution"},{start:c((()=>[d(o,{name:"mingcute:card-pay-line",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"]),"PENDING"===e.status?(v(),b(Ne,{key:0,onClick:t=>function(e){Be.value=e,Te.value=!0}(e),title:"Refund Contribution"},{start:c((()=>[d(o,{name:"line-md:close",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"])):x("",!0)])),_:2},1024)])),_:2},1032,["hide-label"])])),_:2},1024)))),128))])),_:1})])):(v(),b(G,{key:0,title:m(be)&&""!==m(be)?"No matching results":"No results",subtitle:m(be)&&""!==m(be)?"Looks like we couldn't find any matching results for your search terms. Try other search terms.":"Looks like we don't have any data here yet."},{image:c((()=>[Y,H])),_:1},8,["title","subtitle"])),y("div",Q,[m(Ce).length>m(he)?(v(),b(qe,{key:0,"total-items":m(Ce).length,"current-page":m(ge),"item-per-page":m(he)},null,8,["total-items","current-page","item-per-page"])):x("",!0)])])])),_:1}),d(Ge,{open:m(Pe),size:"sm",onClose:l[10]||(l[10]=e=>Pe.value=!1)},{header:c((()=>[y("div",Z,[y("h3",ee,g(t.$t("Pay"))+" "+g(t.$t("ICO Contribution")),1),d(ze,{onClick:l[7]||(l[7]=e=>Pe.value=!1)})])])),footer:c((()=>[y("div",oe,[y("div",ne,[d(n,{onClick:l[8]||(l[8]=e=>Pe.value=!1)},{default:c((()=>[h(g(t.$t("Cancel")),1)])),_:1}),d(n,{color:"success",flavor:"solid",onClick:l[9]||(l[9]=e=>async function(){Fe.value=!0;try{const e=await z(Le.value?.id);Ee.response(e),"success"===e.status&&await a.fetchIcoContributions()}catch(e){Ee.danger(e)}Pe.value=!1,Fe.value=!1,Le.value=null}()),disabled:m(Fe),loading:m(Fe)},{default:c((()=>[h(g(t.$t("Pay")),1)])),_:1},8,["disabled","loading"])])])])),default:c((()=>[y("div",te,[y("div",ae,[y("h3",le,g(t.$t("Are you sure?")),1),y("p",se,g(t.$t("Do you really want to pay this"))+" "+g(t.$t("contribution"))+" "+g(t.$t("This process cannot be undone.")),1)])])])),_:1},8,["open"]),d(Ge,{open:m(Te),size:"sm",onClose:l[14]||(l[14]=e=>Te.value=!1)},{header:c((()=>[y("div",ie,[y("h3",ue,g(t.$t("Delete"))+" "+g(t.$t("ICO Contribution")),1),d(ze,{onClick:l[11]||(l[11]=e=>Te.value=!1)})])])),footer:c((()=>[y("div",pe,[y("div",ve,[d(n,{onClick:l[12]||(l[12]=e=>Te.value=!1)},{default:c((()=>[h(g(t.$t("Cancel")),1)])),_:1}),d(n,{color:"danger",flavor:"solid",onClick:l[13]||(l[13]=e=>async function(){Ve.value=!0;try{const e=await R(Be.value?.id);Ee.response(e),"success"===e.status&&a.removeContribution(Be.value?.id)}catch(e){Ee.danger(e)}Te.value=!1,Ve.value=!1,Be.value=null}()),disabled:m(Ve),loading:m(Ve)},{default:c((()=>[h(g(t.$t("Delete")),1)])),_:1},8,["disabled","loading"])])])])),default:c((()=>[y("div",re,[y("div",de,[y("h3",ce,g(t.$t("Are you sure?")),1),y("p",me,g(t.$t("Do you really want to refund this"))+" "+g(t.$t("contribution"))+" "+g(t.$t("This process cannot be undone, it will permanently delete the"))+" "+g(t.$t("contribution"))+" "+g(t.$t("and all related data and refund the balance to wallet")),1)])])])),_:1},8,["open"])])}}});export{fe as default};
