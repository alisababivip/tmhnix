import{a as e,a_ as a,a$ as l,b0 as t,b1 as s,z as o,r as i,c as n,E as r,ad as d,J as u,b as c,f as m,t as p,u as h,F as v,O as f,w,e as b,k as g,Z as k,X as y,an as _,o as x,q as j,p as C,af as T,B as V,b2 as B,x as $,ag as U,ao as M}from"../e/entry-8qgg5CL-.js";import{_ as A}from"./BaseInput.vue-iInHQMIA.js";import{_ as E}from"./BaseSelect.vue-p0KYznCX.js";import{_ as F}from"./TairoButtonIcon.vue-KqKLsAHm.js";import{_ as I}from"./BaseCheckbox.vue-cNhyVlDH.js";import{_ as S}from"./FlexTableCell.vue-Rbj2Whgl.js";import{_ as D,a as P}from"./FlexTableRow.vue-LmGXINIn.js";import{_ as z}from"./BaseTag.vue-NMkN1Uk8.js";import{_ as W,a as L}from"./BaseDropdown.vue-wSpyT9xX.js";import{_ as q}from"./TairoFlexTable-zdoraqRc.js";import{_ as N}from"./BasePagination.vue-eKZkqxB7.js";import{_ as O}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{_ as R}from"./BaseButtonIcon.vue-6tAU_b7C.js";import{_ as H}from"./BaseInputFileHeadless.vue-LOgyN9kF.js";import{u as Q}from"./useEcosystem-9eBUNbsT.js";import{u as G}from"./fetch-i3Y1jjTS.js";import{_ as J,a as X}from"./placeholder-search-4-dark-Jht91LnM.js";import{u as Y}from"./admin-Nwh6nXjV.js";import{z as Z,u as K,t as ee,F as ae}from"./vee-validate.esm-n59zZCC5.js";import"./input-id-wZ-Ta08j.js";import"./IconCheck-JvP9GQU1.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./menu-KWZreDHB.js";import"./use-text-value-9iwzs_EA.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";const le={class:"justify-between flex gap-3 pb-3 items-center"},te={class:"text-lg font-semibold"},se={class:"justify-between flex gap-3"},oe={value:10},ie={value:25},ne={value:50},re={value:100},de=m("img",{class:"block dark:hidden",src:J,alt:"Placeholder image"},null,-1),ue=m("img",{class:"hidden dark:block",src:X,alt:"Placeholder image"},null,-1),ce={key:1,class:"w-full"},me={key:0,class:"bg-info-100 text-info-700 dark:bg-info-700 dark:text-info-100 rounded-lg p-4 flex justify-between items-center w-full mb-5"},pe={class:"text-sm"},he={class:"flex gap-2"},ve={class:"relative"},fe={class:"pl-4"},we={class:"mt-6"},be={class:"flex w-full items-center justify-between p-4 md:p-6"},ge={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},ke={class:"p-4 md:p-6"},ye={class:"mx-auto w-full text-start"},_e={class:"grid gap-5 grid-cols-1 sm:grid-cols-2"},xe={class:"col-span-2 flex justify-center pb-3"},je={class:"relative h-20 w-20"},Ce=["src"],Te=["src"],Ve={key:2,class:"absolute bottom-0 end-0 z-20"},Be={key:3,class:"absolute bottom-0 end-0 z-20"},$e={class:"relative","data-nui-tooltip":"Upload image"},Ue={class:"p-4 md:p-6"},Me={class:"flex gap-x-2"},Ae=e({__name:"index",setup(e){const J=k().public.siteUrl,X=`https://metamask.app.link/dapp/${J.replace(/^https?:\/\//,"")}`,{isConnected:Ae}=a(),{connect:Ee}=l({connector:new t}),{disconnect:Fe}=s(),Ie=o(),{chain:Se}=Ie.params,De=Y(),{updateAdminTokenIcon:Pe,updateTokenStatusBulk:ze,updateAdminToken:We}=Q(),Le=i(""),qe=i(10),Ne=n((()=>parseInt(Ie.query.page??"1"))),Oe=i(!1),Re=i(!1),He=n((()=>De.tokens.filter((e=>e.chain===Se)))),Qe=n((()=>He.value?.filter((e=>e.currency.includes(Le.value))).sort(((e,a)=>e.status===a.status?e.currency.localeCompare(a.currency):e.status?-1:1)))),Ge=n((()=>{const e=(Ne.value-1)*qe.value,a=e+qe.value;return Qe.value.slice(e,a)}));r((async()=>{0===De.tokens.length&&await De.fetchTokensAll()}));const{toast:Je}=d(),Xe=i(void 0),Ye=n((()=>Xe.value?.icon??"/img/crypto/eth.png")),Ze=i(Xe.value?.icon||null);u(Ze,(e=>{Ze.value&&Ke()}));const Ke=async()=>{const e=new FormData;e.append("files",Ze.value[0]),e.append("oldImagePath",Xe.value?.icon),e.append("type","crypto");const a=await G("/api/upload",{method:"POST",body:e},"$olLTtBSQvI");if(a&&""!==a.data.value){const e=a.data.value[0],l=await Pe(Xe.value?.id,e);Je.response(l),"success"===l.status&&await De.fetchTokensAll(),Re.value=!1,Oe.value=!1}Re.value=!1,Oe.value=!1},ea=Z.object({precision:Z.number().int().positive("Precision must be a positive number").max(8),limits:Z.object({withdrawal:Z.object({min:Z.number().positive("Minimum withdrawal must be positive"),max:Z.number().positive("Maximum withdrawal must be positive")})}),fees:Z.object({withdrawal:Z.number().positive("Withdrawal fee must be positive"),min_withdrawal:Z.number().positive("Minimum withdrawal fee must be positive")})}),aa=n((()=>({precision:8,limits:{withdrawal:{min:1,max:1e3}},fees:{withdrawal:.01,min_withdrawal:.001}}))),{handleSubmit:la,isSubmitting:ta,resetForm:sa,setFieldValue:oa}=K({validationSchema:ee(ea),initialValues:aa}),ia=la((async e=>{ta.value=!0;const{precision:a,limits:l,fees:t}=e,s=await We(Xe.value?.id,a,l,t);Je.response(s),"success"===s.status&&(await De.fetchTokensAll(),Oe.value=!1,sa()),ta.value=!1})),na=i([]),ra=n((()=>na.value.length===Qe.value.length));function da(){ra.value?na.value=[]:na.value=Qe.value.map((e=>e.id))??[]}async function ua(e){const a=await ze(na.value,e);Je.response(a),"success"===a.status&&await De.fetchTokensAll(),na.value=[]}const ca=e=>e instanceof File||e instanceof Blob,ma=["BTC","LTC","DOGE","DASH"];return(e,a)=>{const l=$,t=y,s=A,o=E,i=U,n=F,r=I,d=S,u=D,k=z,Q=W,G=L,Y=P,Z=q,K=N,ee=O,Ie=M,Pe=R,ze=H,We=_;return x(),c("div",null,[m("div",le,[m("div",te,p(h(Se))+" Tokens",1),m("div",se,[ma.includes(h(Se))?g("",!0):(x(),c(v,{key:0},[h(Ae)?(x(),f(t,{key:0,onClick:h(Fe),color:"danger",flavor:"pastel"},{default:w((()=>[b(l,{name:"logos:metamask-icon",class:"me-2 h-5 w-5"}),j(" Disconnect ")])),_:1},8,["onClick"])):(x(),f(t,{key:1,onClick:h(Ee),color:"info",flavor:"pastel"},{default:w((()=>[b(l,{name:"logos:metamask-icon",class:"me-2 h-5 w-5"}),j(" Connect Wallet ")])),_:1},8,["onClick"])),b(t,{color:"primary",to:`/admin/extensions/ecosystem/tokens/${h(Se)}/create`},{default:w((()=>[b(l,{name:"lucide:plus",size:"16",class:"mr-2"}),j(" "+p(e.$t("Create Token")),1)])),_:1},8,["to"]),b(t,{color:"warning",to:`/admin/extensions/ecosystem/tokens/${h(Se)}/import`},{default:w((()=>[b(l,{name:"lucide:plus",size:"16",class:"mr-2"}),j(" "+p(e.$t("Import")),1)])),_:1},8,["to"])],64)),b(t,{to:"/admin/extensions/ecosystem/blockchains/wallets",color:"muted",flavor:"pastel"},{default:w((()=>[b(l,{name:"line-md:chevron-left",class:"me-2 h-4 w-4"}),j(" Back ")])),_:1})])]),b(ee,null,{left:w((()=>[b(s,{modelValue:h(Le),"onUpdate:modelValue":a[0]||(a[0]=e=>C(Le)?Le.value=e:null),icon:"lucide:search",classes:{wrapper:"w-full sm:w-auto"},placeholder:"Filter tokens..."},null,8,["modelValue"])])),right:w((()=>[b(o,{modelValue:h(qe),"onUpdate:modelValue":a[1]||(a[1]=e=>C(qe)?qe.value=e:null),label:"",classes:{wrapper:"w-full sm:w-40"}},{default:w((()=>[m("option",oe,"10 "+p(e.$t("per page")),1),m("option",ie,"25 "+p(e.$t("per page")),1),m("option",ne,"50 "+p(e.$t("per page")),1),m("option",re,"100 "+p(e.$t("per page")),1)])),_:1},8,["modelValue"])])),default:w((()=>[m("div",null,[h(De).loading||0!==h(Ge)?.length?(x(),c("div",ce,[!h(De).loading&&h(na).length>0?(x(),c("div",me,[m("span",pe,p(e.$t("You have selected"))+" "+p(h(na).length)+" "+p(e.$t("items of the total"))+" "+p(h(Qe).length)+" "+p(e.$t("items"))+". ",1),m("div",he,[b(n,{color:"danger",size:"xs","data-nui-tooltip":"Disable currencies",onClick:a[2]||(a[2]=()=>ua(!1))},{default:w((()=>[b(l,{name:"line-md:close-small",class:"h-5 w-5"})])),_:1}),b(n,{color:"success",size:"xs","data-nui-tooltip":"Enable currencies",onClick:a[3]||(a[3]=()=>ua(!0))},{default:w((()=>[b(l,{name:"line-md:confirm",class:"h-5 w-5"})])),_:1})])])):g("",!0),b(Z,{class:"md:pt-0 sm:pt-5 md:mt-0 sm:mt-5"},{header:w((()=>[m("div",ve,[m("span",fe,[b(r,{"model-value":h(ra),indeterminate:h(na).length>0&&!h(ra),name:"table-1-main",shape:"rounded",class:"text-primary-500",onClick:da},null,8,["model-value","indeterminate"])])])])),default:w((()=>[b(T,{"enter-active-class":"transform-gpu","enter-from-class":"opacity-0 translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transform-gpu","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-2"},{default:w((()=>[(x(!0),c(v,null,V(h(Ge),((e,t)=>(x(),f(Y,{key:e.id,spaced:""},{start:w((()=>[b(d,{"data-content":"Selection",class:"xs:absolute right-2 ml-2"},{default:w((()=>[b(r,{modelValue:h(na),"onUpdate:modelValue":a[4]||(a[4]=e=>C(na)?na.value=e:null),value:e.id,name:`item-checkbox-${e.id}`,shape:"rounded",class:"text-primary-500"},null,8,["modelValue","value","name"])])),_:2},1024),b(u,{label:"Chain","hide-label":t>0,title:`${e.name} (${e.currency})`,subtitle:e.contract,avatar:`${e.icon??`/img/crypto/${e.currency.toLowerCase()}.png`}`},null,8,["hide-label","title","subtitle","avatar"])])),end:w((()=>[b(u,{label:"Chain","hide-label":t>0,title:e.chain,subtitle:e.network},null,8,["hide-label","title","subtitle"]),b(d,{label:"Decimals","hide-label":t>0,class:"w-20 xs:w-full"},{default:w((()=>[j(p(e.decimals),1)])),_:2},1032,["hide-label"]),b(d,{label:"Status","hide-label":t>0,class:"w-20 xs:w-full"},{default:w((()=>[b(k,{color:e.status?"success":"danger",flavor:"pastel",condensed:""},{default:w((()=>[j(p(e.status?"Active":"Disabled"),1)])),_:2},1032,["color"])])),_:2},1032,["hide-label"]),b(d,{label:"Actions","hide-label":t>0},{default:w((()=>[b(G,{flavor:"context",label:"Dropdown",orientation:"end"},{default:w((()=>["NATIVE"!==e.contractType?(x(),f(Q,{key:0,to:`/admin/extensions/ecosystem/tokens/${e.chain}/${e.currency}/holders`,title:"View Token Holders"},{start:w((()=>[b(l,{name:"mdi:eye",class:"me-2 block h-5 w-5"})])),_:2},1032,["to"])):g("",!0),b(Q,{onClick:a=>(e=>{Xe.value=e,e&&(oa("fees.withdrawal",e.fees?.withdrawal),oa("fees.min_withdrawal",e.fees?.min_withdrawal),oa("limits.withdrawal.min",e.limits?.withdrawal?.min),oa("limits.withdrawal.max",e.limits?.withdrawal?.max),oa("precision",e.precision),Oe.value=!0)})(e),title:"Edit Token"},{start:w((()=>[b(l,{name:"line-md:pencil",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"]),"NATIVE"!==e.contractType?(x(),f(Q,{key:1,onClick:a=>(async e=>{if(void 0===window.ethereum)return Je.dangerText("Ethereum support is not found, please install MetaMask"),void setTimeout((()=>{window.open(X,"_blank")}),1e3);if(!window.ethereum.isMetaMask)return Je.dangerText("MetaMask is not available, please install it"),void setTimeout((()=>{window.open(X,"_blank")}),1e3);if(!Ae)return Je.dangerText("Please connect your wallet first"),void Ee();let a;try{a=await B()}catch(t){Je.danger(t)}if(!a)return void Je.dangerText("Wallet client is not available");const l={address:e.contract,symbol:e.currency,decimals:e.decimals};e.icon&&(l.image=`${J}${e.icon}`);try{await a.request({method:"wallet_watchAsset",params:{type:"ERC20",options:l}}),Je.successText("Token added to Metamask successfully")}catch(t){Je.dangerText(t.message.includes("User rejected the request")?"User rejected the request":t.message)}})(e),title:"Add to Metamask"},{start:w((()=>[b(l,{name:"logos:metamask-icon",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"])):g("",!0)])),_:2},1024)])),_:2},1032,["hide-label"])])),_:2},1024)))),128))])),_:1})])),_:1})])):(x(),f(i,{key:0,title:h(Le)&&""!==h(Le)?"No matching results":"No results",subtitle:h(Le)&&""!==h(Le)?"Looks like we couldn't find any matching results for your search terms. Try other search terms.":"Looks like we don't have any data here yet."},{image:w((()=>[de,ue])),_:1},8,["title","subtitle"])),m("div",we,[h(Qe).length>h(qe)?(x(),f(K,{key:0,"total-items":h(Qe).length,"current-page":h(Ne),"item-per-page":h(qe)},null,8,["total-items","current-page","item-per-page"])):g("",!0)])])])),_:1}),b(We,{open:h(Oe),size:"xl",onClose:a[9]||(a[9]=e=>Oe.value=!1)},{header:w((()=>[m("div",be,[m("h3",ge,p(e.$t("Editing"))+" "+p(h(Xe)?.currency)+" "+p(e.$t("Token")),1),b(Ie,{onClick:a[5]||(a[5]=e=>Oe.value=!1)})])])),footer:w((()=>[m("div",Ue,[m("div",Me,[b(t,{onClick:a[7]||(a[7]=e=>Oe.value=!1)},{default:w((()=>[j(p(e.$t("Cancel")),1)])),_:1}),b(t,{color:"primary",flavor:"solid",onClick:a[8]||(a[8]=e=>h(ia)()),disabled:h(ta),loading:h(ta)},{default:w((()=>[j(p(e.$t("Edit Token")),1)])),_:1},8,["disabled","loading"])])])])),default:w((()=>[m("div",ke,[m("div",ye,[m("div",_e,[m("div",xe,[b(ze,{accept:"image/*",type:"file",modelValue:h(Ze),"onUpdate:modelValue":a[6]||(a[6]=e=>C(Ze)?Ze.value=e:null),name:"image"},{default:w((({open:e,remove:a,preview:t,files:s})=>[m("div",je,[s?.length&&ca(s[0])?(x(),c("img",{key:0,src:t(s.item(0)).value,alt:"Upload preview",class:"bg-muted-200 dark:bg-muted-700/60 h-20 w-20 rounded-full object-cover object-center"},null,8,Ce)):(x(),c("img",{key:1,src:h(Ye),alt:"Upload preview",class:"bg-muted-200 dark:bg-muted-700/60 h-20 w-20 rounded-full object-cover object-center dark:invert"},null,8,Te)),s?.length&&ca(s[0])?(x(),c("div",Ve,[b(Pe,{condensed:"",shape:"full",onClick:e=>a(s.item(0)),"data-nui-tooltip":"Remove image",class:"scale-90"},{default:w((()=>[b(l,{name:"lucide:x",class:"h-4 w-4"})])),_:2},1032,["onClick"])])):(x(),c("div",Be,[m("div",$e,[b(Pe,{condensed:"",shape:"full",onClick:e},{default:w((()=>[b(l,{name:"lucide:plus",class:"h-4 w-4"})])),_:2},1032,["onClick"])])]))])])),_:1},8,["modelValue"])]),b(h(ae),{name:"limits.withdrawal.min"},{default:w((({field:e,errorMessage:a,handleChange:l,handleBlur:t})=>[b(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:h(ta),type:"number",label:"Minimum Withdrawal Amount",placeholder:"Enter minimum withdrawal amount",onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),b(h(ae),{name:"limits.withdrawal.max"},{default:w((({field:e,errorMessage:a,handleChange:l,handleBlur:t})=>[b(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:h(ta),type:"number",label:"Maximum Withdrawal Amount",placeholder:"Optional maximum withdrawal amount",onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),b(h(ae),{name:"fees.withdrawal"},{default:w((({field:e,errorMessage:a,handleChange:l,handleBlur:t})=>[b(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:h(ta),type:"number",label:"Withdrawal Fee",placeholder:"Enter withdrawal fee",icon:"iconoir:percentage",onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),b(h(ae),{name:"fees.min_withdrawal"},{default:w((({field:e,errorMessage:a,handleChange:l,handleBlur:t})=>[b(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:h(ta),type:"number",label:"Minimum Withdrawal Fee (Fixed)",placeholder:"Enter minimum withdrawal fee if amount is too low",onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),b(h(ae),{name:"precision"},{default:w((({field:e,errorMessage:a,handleChange:l,handleBlur:t})=>[b(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:h(ta),type:"number",label:"Precision",placeholder:"Enter decimal precision",onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})])])])])),_:1},8,["open"])])}}});export{Ae as default};
