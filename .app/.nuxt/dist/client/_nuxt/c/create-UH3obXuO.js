import{a as e,ad as r,ac as t,c as a,r as o,J as s,O as l,w as d,o as n,e as i,q as u,t as m,u as c,f as p,p as f,W as v,b,A as g,F as h,B as y,n as x,k,_ as w,x as j,X as _,Y as C}from"../e/entry-8qgg5CL-.js";import{_ as V}from"./BaseInput.vue-iInHQMIA.js";import{_ as B}from"./BaseProgress.vue-xH0Mhn3Z.js";import{_ as S}from"./BaseInputFileHeadless.vue-LOgyN9kF.js";import{_ as $}from"./TairoFormSave.vue-aLVbwikq.js";import{_ as D}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as F}from"./useEcommerce-2nLxpPKu.js";import{u as U}from"./fetch-i3Y1jjTS.js";import{b as z}from"./strings-rQgUKePI.js";import{_ as I}from"./placeholder-file-IxKzOaSl.js";import{z as P,u as R,t as T,F as W}from"./vee-validate.esm-n59zZCC5.js";import{u as q}from"./categories-M541zqEW.js";import"./input-id-wZ-Ta08j.js";const A={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},E={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},K=["onDrop"],N=["onClick","onKeydown"],O={class:"p-5 text-center"},J={class:"text-muted-400 font-sans text-sm"},L={class:"text-muted-400 font-sans text-[0.7rem] font-semibold uppercase"},M={for:"file",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 cursor-pointer font-sans text-sm underline underline-offset-4 transition-colors duration-300"},H={key:1,class:"mt-6 space-y-2"},Q={class:"border-muted-200 dark:border-muted-700 dark:bg-muted-800 relative flex items-center justify-end gap-2 rounded-xl border bg-white p-3"},X={class:"flex items-center gap-2"},Y={class:"shrink-0"},G=["src"],Z={key:1,class:"h-14 w-14 rounded-xl object-cover object-center",src:I,alt:"Image preview"},ee={class:"font-sans"},re={class:"text-muted-800 dark:text-muted-100 line-clamp-1 block text-sm"},te={class:"text-muted-400 block text-xs"},ae={class:"flex gap-2"},oe={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300 disabled:cursor-not-allowed disabled:opacity-60",disabled:"",type:"button",tooltip:"Cancel"},se=p("span",{class:"sr-only"},"Cancel",-1),le={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Upload"},de=p("span",{class:"sr-only"},"Upload",-1),ne=["onClick"],ie=p("span",{class:"sr-only"},"Remove",-1),ue={key:0,class:"mb-4 h-36 w-full flex items-center justify-center overflow-hidden rounded-xl"},me=["src"],ce={class:"text-warning-400 dark:text-warning-600 font-sans text-[0.7rem] font-semibold"},pe=e({__name:"create",setup(e){const{toast:I}=r(),pe=t(),fe=q(),{createAdminCategory:ve}=F(),be=P.object({name:P.string().nonempty("Name is required"),description:P.string().optional()}),ge=a((()=>({name:"",description:""}))),{handleSubmit:he,isSubmitting:ye,values:xe}=R({validationSchema:T(be),initialValues:ge}),ke=o(null),we=o(null);s(ke,(e=>{const r=e?.item(0)||null;if(ke.value){const e=new FileReader;e.onload=e=>{we.value=e.target?.result},e.readAsDataURL(r)}}));const je=he((async e=>{try{let r=null;if(ke.value){const e=new FormData;e.append("files",ke.value[0]),e.append("type","ecommerceProducts");const t=await U("/api/upload",{method:"POST",body:e},"$4koWBQo1Vw");t&&""!==t.data.value&&(r=t.data.value[0])}const t=await ve(e.name,e.description,r);I.response(t),"success"===t.status&&(await fe.fetchCategories(),pe.push("/admin/extensions/ecommerce/categories"))}catch(r){I.danger(r)}}));return(e,r)=>{const t=w,a=j,o=_,s=V,F=C,U=B,I=S,P=$,R=D;return n(),l(R,null,{left:d((()=>[i(t,{size:"lg"},{default:d((()=>[u(m(e.$t("Create Category")),1)])),_:1})])),right:d((()=>[i(o,{type:"button",color:"muted",class:"hover:bg-gray-300 dark:hover:bg-gray-800",to:"/admin/extensions/ecommerce/categories"},{default:d((()=>[i(a,{name:"line-md:chevron-left",class:"h-4 w-4 mr-2"}),u(" "+m(e.$t("Back")),1)])),_:1}),i(o,{type:"submit",color:"primary",disabled:c(ye),class:"w-full",onClick:c(je)},{default:d((()=>[u(m(e.$t("Create Category")),1)])),_:1},8,["disabled","onClick"])])),default:d((()=>[p("form",{onSubmit:r[3]||(r[3]=v(((...e)=>c(je)&&c(je)(...e)),["prevent"])),class:"space-y-8"},[i(F,{class:"p-5 space-y-5"},{default:d((()=>[p("div",A,[i(c(W),{name:"name"},{default:d((({field:e,errorMessage:r,handleChange:t,handleBlur:a})=>[i(s,{modelValue:e.value,"onUpdate:modelValue":[r=>e.value=r,t],error:r,label:"Name",placeholder:"Enter category name",shape:"rounded",class:"w-full",onBlur:a},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1}),i(c(W),{name:"description"},{default:d((({field:e,errorMessage:r,handleChange:t,handleBlur:a})=>[i(s,{modelValue:e.value,"onUpdate:modelValue":[r=>e.value=r,t],error:r,label:"Description",placeholder:"Enter category description",shape:"rounded",class:"w-full",onBlur:a},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1})])])),_:1}),i(F,{class:"p-5"},{default:d((()=>[p("div",E,[i(I,{modelValue:c(ke),"onUpdate:modelValue":r[2]||(r[2]=e=>f(ke)?ke.value=e:null)},{default:d((({open:t,remove:o,preview:s,drop:l,files:d})=>[p("div",{class:"",onDragenter:r[0]||(r[0]=v((()=>{}),["stop","prevent"])),onDragover:r[1]||(r[1]=v((()=>{}),["stop","prevent"])),onDrop:l},[d?.length?(n(),b("ul",H,[(n(!0),b(h,null,y(d,(r=>(n(),b("li",{key:r.name},[p("div",Q,[p("div",X,[p("div",Y,[r.type.startsWith("image")?(n(),b("img",{key:0,class:"h-14 w-14 rounded-xl object-cover object-center",src:s(r).value,alt:"Image preview"},null,8,G)):(n(),b("img",Z))]),p("div",ee,[p("span",re,m(r.name),1),p("span",te,m(("formatFileSize"in e?e.formatFileSize:c(z))(r.size)),1)])]),p("div",{class:x(["ms-auto w-32 px-4 transition-opacity duration-300","opacity-100"])},[i(U,{value:0,size:"xs",color:"success"})]),p("div",ae,[p("button",oe,[i(a,{name:"lucide:slash",class:"h-4 w-4"}),se]),p("button",le,[i(a,{name:"lucide:arrow-up",class:"h-4 w-4"}),de]),p("button",{class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Remove",onClick:v((e=>o(r)),["prevent"])},[i(a,{name:"lucide:x",class:"h-4 w-4"}),ie],8,ne)])])])))),128))])):(n(),b("div",{key:0,class:"nui-focus border-muted-300 dark:border-muted-700 hover:border-muted-400 focus:border-muted-400 dark:hover:border-muted-600 dark:focus:border-muted-700 group cursor-pointer rounded-lg border-[3px] border-dashed transition-colors duration-300",tabindex:"0",role:"button",onClick:t,onKeydown:g(v(t,["prevent"]),["enter"])},[p("div",O,[i(a,{name:"mdi-light:cloud-upload",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 mb-2 h-10 w-10 transition-colors duration-300"}),p("h4",J,m(e.$t("Drop file to upload")),1),p("div",null,[p("span",L,m(e.$t("Or")),1)]),p("label",M,m(e.$t("Select Image")),1)])],40,N))],40,K)])),_:1},8,["modelValue"]),c(we)?(n(),b("div",ue,[p("img",{src:c(we),alt:"Image Preview",class:"max-h-full max-w-full object-cover object-center"},null,8,me)])):k("",!0)]),p("div",null,[p("span",ce,m(e.$t("Note"))+": Preferred image size is 600x400px ",1)])])),_:1}),i(P,null,{default:d((()=>[i(o,{type:"submit",color:"primary",disabled:c(ye),class:"w-full"},{default:d((()=>[u(m(e.$t("Create Category")),1)])),_:1},8,["disabled"])])),_:1})],32)])),_:1})}}});export{pe as default};
