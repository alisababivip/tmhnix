import{a as e,ad as a,R as l,c as s,z as t,r as i,E as n,J as o,ac as d,b as r,e as u,w as m,u as p,an as c,o as v,q as f,t as g,f as h,_ as b,x as y,X as _,ao as x}from"../e/entry-8qgg5CL-.js";import{_ as k}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{_ as w}from"./BaseInput.vue-iInHQMIA.js";import{u as j}from"./useMailwizard-mGGEZWYz.js";import{v as C}from"./vue-email-editor.common-wo_sH4QP.js";import{z as E,u as T,t as z,F as N}from"./vee-validate.esm-n59zZCC5.js";import"./input-id-wZ-Ta08j.js";import"./vue.runtime.esm-bundler-o14tx7LQ.js";const S={class:"flex w-full items-center justify-between p-4 md:p-6"},B={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},V={class:"px-4 md:px-6"},J={class:"p-4 md:p-6"},O={class:"flex gap-x-2"},U=e({__name:"[id]",setup(e){const{toast:U}=a(),D=l(),M=s((()=>D.isDarkMode)),{updateTemplate:$,getTemplate:q}=j(),F=t(),H=i(null),I=i(!1),L=i(null),P=()=>{I.value=!0},R=E.object({name:E.string().nonempty("Name is required")}),{handleSubmit:W,isSubmitting:X,resetForm:A}=T({validationSchema:z(R),initialValues:{name:""}});n((async()=>{const e=await q(F.params.id);if("success"===e.status&&(H.value=e.data.result,A({values:{name:H.value?.name??""}}),H.value?.design&&L.value?.editor)){const e=JSON.parse(H.value.design);L.value?.editor.loadDesign(e)}})),o([I,H],(()=>{if(I.value&&H.value?.design){const e=JSON.parse(H.value.design);L.value?.editor.loadDesign(e)}}),{immediate:!0});const G=i(!1),K=i(!1),Q=d(),Y=W((async e=>{L.value?.editor.exportHtml((async a=>{try{const l=await $(H.value?.id,e.name,a.html,JSON.stringify(a.design));U.response(l),"success"===l.status&&Q.push("/admin/extensions/mailwizard/templates")}catch(l){U.danger(l)}}))}));return(e,a)=>{const l=b,s=y,t=_,i=k,n=x,o=w,d=c;return v(),r("div",null,[u(i,null,{left:m((()=>[u(l,{size:"lg"},{default:m((()=>[f("Editing Template: "+g(p(H)?.name),1)])),_:1})])),right:m((()=>[u(t,{type:"button",color:"muted",class:"hover:bg-gray-300 dark:hover:bg-gray-800",to:"/admin/extensions/mailwizard/templates"},{default:m((()=>[u(s,{name:"line-md:chevron-left",class:"h-4 w-4 mr-2"}),f(" Back ")])),_:1}),u(t,{type:"submit",color:"primary",disabled:p(X)||!p(I)||!p(L),loading:p(X)||!p(I)||!p(L),class:"w-full",onClick:a[0]||(a[0]=()=>K.value=!0)},{default:m((()=>[f(" Update ")])),_:1},8,["disabled","loading"])])),default:m((()=>[u(p(C.EmailEditor),{onLoad:P,ref_key:"emailEditor",ref:L,style:{height:"calc(80vh)"},appearance:{theme:p(M)?"dark":"light",panels:{tools:{dock:"left"}}}},null,8,["appearance"])])),_:1}),u(d,{open:p(K),size:"sm",onClose:a[3]||(a[3]=()=>K.value=!1)},{header:m((()=>[h("div",S,[h("h3",B,g(e.$t("Edit Template")),1),u(n,{onClick:a[1]||(a[1]=()=>K.value=!1)})])])),footer:m((()=>[h("div",J,[h("div",O,[u(t,{onClick:a[2]||(a[2]=()=>K.value=!1)},{default:m((()=>[f(g(e.$t("Cancel")),1)])),_:1}),u(t,{color:"success",flavor:"solid",onClick:p(Y),disabled:p(G),loading:p(G)},{default:m((()=>[f(g(e.$t("Update")),1)])),_:1},8,["onClick","disabled","loading"])])])])),default:m((()=>[h("div",V,[u(p(N),{name:"name"},{default:m((({field:e,errorMessage:a,handleChange:l,handleBlur:s})=>[u(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,label:"Name",placeholder:"Enter Template Name",shape:"rounded",class:"w-full",onBlur:s},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1})])])),_:1},8,["open"])])}}});export{U as default};
