import{a as e,ad as a,ac as r,c as l,ap as t,Q as s,E as o,J as d,r as n,O as u,w as i,o as c,e as p,q as m,t as h,u as v,f,p as b,W as y,b as g,A as x,F as _,B as w,n as k,k as j,_ as B,x as C,X as V,Y as E}from"../e/entry-8qgg5CL-.js";import{_ as T}from"./BaseInput.vue-iInHQMIA.js";import{_ as U}from"./BaseProgress.vue-xH0Mhn3Z.js";import{_ as S}from"./BaseInputFileHeadless.vue-LOgyN9kF.js";import{_ as P}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as I}from"./BaseTextarea.vue-8st5U0qk.js";import{_ as D}from"./TairoFormSave.vue-aLVbwikq.js";import{_ as M}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as O}from"./useIco-3A31FykS.js";import{u as A}from"./currency-9FjTf2Bf.js";import{u as F}from"./fetch-i3Y1jjTS.js";import{b as L}from"./strings-rQgUKePI.js";import{_ as N}from"./placeholder-file-IxKzOaSl.js";import{z as $,u as q,t as z,F as W}from"./vee-validate.esm-n59zZCC5.js";import{u as R}from"./admin-Nwh6nXjV.js";import{u as G}from"./tokens-3I890zGb.js";import{u as K}from"./projects-GkXQIzMj.js";import"./input-id-wZ-Ta08j.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";import"./useExchange-VMAYQu3P.js";import"./useEcosystem-9eBUNbsT.js";const H={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},J={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},Q=["onDrop"],Y=["onClick","onKeydown"],X={class:"p-5 text-center"},Z={class:"text-muted-400 font-sans text-sm"},ee={class:"text-muted-400 font-sans text-[0.7rem] font-semibold uppercase"},ae={for:"file",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 cursor-pointer font-sans text-sm underline underline-offset-4 transition-colors duration-300"},re={key:1,class:"mt-6 space-y-2"},le={class:"border-muted-200 dark:border-muted-700 dark:bg-muted-800 relative flex items-center justify-end gap-2 rounded-xl border bg-white p-3"},te={class:"flex items-center gap-2"},se={class:"shrink-0"},oe=["src"],de={key:1,class:"h-14 w-14 rounded-xl object-cover object-center",src:N,alt:"Image preview"},ne={class:"font-sans"},ue={class:"text-muted-800 dark:text-muted-100 line-clamp-1 block text-sm"},ie={class:"text-muted-400 block text-xs"},ce={class:"flex gap-2"},pe={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300 disabled:cursor-not-allowed disabled:opacity-60",disabled:"",type:"button",tooltip:"Cancel"},me=f("span",{class:"sr-only"},"Cancel",-1),he={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Upload"},ve=f("span",{class:"sr-only"},"Upload",-1),fe=["onClick"],be=f("span",{class:"sr-only"},"Remove",-1),ye={key:0,class:"mb-4 h-36 w-full flex items-center justify-center overflow-hidden rounded-xl"},ge=["src"],xe={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},_e=e({__name:"create",setup(e){const{toast:N}=a(),_e=r(),we=G(),{createIcoToken:ke}=O(),je=K(),Be=l((()=>je.projects)),Ce=t(),Ve=l((()=>Ce.extensions)),Ee=l((()=>Ve.value?.find((e=>"ecosystem"===e.name)))),Te=s(),Ue=l((()=>Te.settings)),Se=A(),Pe=l((()=>Se.currencies)),Ie=R(),De=l((()=>Ie.tokens)),Me=[];o((async()=>{0===je.projects.length&&await je.fetchIcoProjects(),0===je.projects.length&&(_e.push("/admin/extensions/ico/projects/create"),N.dangerText("You need to create a project first")),0===Ce.extensions.length&&await Ce.fetchExtensions(),Ue.value?.spot_exchange&&(Me.push("SPOT"),0===Se.currencies.length&&await Se.fetchCurrencies()),Ee.value?.status&&(Me.push("ECO"),0===Ie.tokens.length&&await Ie.fetchTokensAll()),$e()}));const Oe=l((()=>{let e=[];"SPOT"===qe.purchase_wallet_type?e=Pe.value.map((e=>e.currency)):"ECO"===qe.purchase_wallet_type&&(e=De.value.map((e=>e.currency)));return[...new Set(e)]})),Ae=$.object({name:$.string().nonempty("Name is required"),chain:$.string().nonempty("Chain is required"),currency:$.string().nonempty("Currency is required"),purchase_currency:$.string().nonempty("Purchase currency is required"),address:$.string().nonempty("Address is required"),total_supply:$.number().min(0,"Total supply must be greater than 0"),description:$.string().nonempty("Description is required"),status:$.enum(["PENDING","ACTIVE","COMPLETED","CANCELLED"]),project_id:$.object({label:$.string(),value:$.number()}),purchase_wallet_type:$.enum(Me)}),Fe=l((()=>({name:"",chain:"",currency:"",purchase_currency:"Please select a wallet type first",address:"",total_supply:0,description:"",status:"PENDING",project_id:{label:"Select a project",value:0},purchase_wallet_type:""}))),{handleSubmit:Le,isSubmitting:Ne,resetForm:$e,values:qe,setFieldValue:ze}=q({validationSchema:z(Ae),initialValues:Fe});d((()=>qe.purchase_wallet_type),(e=>{e&&ze("purchase_currency","")}));const We=n(null),Re=n(null);d(We,(e=>{const a=e?.item(0)||null;if(We.value){const e=new FileReader;e.onload=e=>{Re.value=e.target?.result},e.readAsDataURL(a)}}));const Ge=Le((async e=>{try{let a={...e,image:""};if(We.value){const e=new FormData;e.append("files",We.value[0]),e.append("type","icoToken");const r=await F("/api/upload",{method:"POST",body:e},"$LMHOvLnCuK");r&&""!==r.data.value&&(a.image=r.data.value[0])}const r=await ke(a.project_id.value,a.name,a.chain,a.currency,a.purchase_currency,a.purchase_wallet_type,a.address,a.total_supply,a.description,a.image,a.status);N.response(r),"success"===r.status&&(await we.fetchIcoTokens(),_e.push("/admin/extensions/ico/tokens"))}catch(a){N.danger(a)}}));return(e,a)=>{const r=B,l=C,t=V,s=T,o=E,d=U,n=S,O=P,A=I,F=D,N=M;return c(),u(N,null,{left:i((()=>[p(r,{size:"lg"},{default:i((()=>[m(h(e.$t("Create ICO Token")),1)])),_:1})])),right:i((()=>[p(t,{type:"button",color:"muted",class:"hover:bg-gray-300 dark:hover:bg-gray-800",to:"/admin/extensions/ico/tokens"},{default:i((()=>[p(l,{name:"line-md:chevron-left",class:"h-4 w-4 mr-2"}),m(" "+h(e.$t("Back")),1)])),_:1}),p(t,{type:"submit",color:"primary",disabled:v(Ne),class:"w-full",onClick:v(Ge)},{default:i((()=>[m(h(e.$t("Create Token")),1)])),_:1},8,["disabled","onClick"])])),default:i((()=>[f("form",{onSubmit:a[3]||(a[3]=(...e)=>v(Ge)&&v(Ge)(...e)),class:"space-y-8"},[f("div",H,[p(o,{class:"p-5 space-y-5"},{default:i((()=>[p(v(W),{name:"name"},{default:i((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[p(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,r],error:a,disabled:v(Ne),type:"text",label:"Name",placeholder:"Enter name",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),p(v(W),{name:"currency"},{default:i((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[p(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,r],error:a,disabled:v(Ne),type:"text",label:"Currency",placeholder:"Enter currency",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})])),_:1}),p(o,{class:"p-5"},{default:i((()=>[f("div",J,[p(n,{modelValue:v(We),"onUpdate:modelValue":a[2]||(a[2]=e=>b(We)?We.value=e:null)},{default:i((({open:r,remove:t,preview:s,drop:o,files:n})=>[f("div",{class:"",onDragenter:a[0]||(a[0]=y((()=>{}),["stop","prevent"])),onDragover:a[1]||(a[1]=y((()=>{}),["stop","prevent"])),onDrop:o},[n?.length?(c(),g("ul",re,[(c(!0),g(_,null,w(n,(a=>(c(),g("li",{key:a.name},[f("div",le,[f("div",te,[f("div",se,[a.type.startsWith("image")?(c(),g("img",{key:0,class:"h-14 w-14 rounded-xl object-cover object-center",src:s(a).value,alt:"Image preview"},null,8,oe)):(c(),g("img",de))]),f("div",ne,[f("span",ue,h(a.name),1),f("span",ie,h(("formatFileSize"in e?e.formatFileSize:v(L))(a.size)),1)])]),f("div",{class:k(["ms-auto w-32 px-4 transition-opacity duration-300","opacity-100"])},[p(d,{value:0,size:"xs",color:"success"})]),f("div",ce,[f("button",pe,[p(l,{name:"lucide:slash",class:"h-4 w-4"}),me]),f("button",he,[p(l,{name:"lucide:arrow-up",class:"h-4 w-4"}),ve]),f("button",{class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Remove",onClick:y((e=>t(a)),["prevent"])},[p(l,{name:"lucide:x",class:"h-4 w-4"}),be],8,fe)])])])))),128))])):(c(),g("div",{key:0,class:"nui-focus border-muted-300 dark:border-muted-700 hover:border-muted-400 focus:border-muted-400 dark:hover:border-muted-600 dark:focus:border-muted-700 group cursor-pointer rounded-lg border-[3px] border-dashed transition-colors duration-300",tabindex:"0",role:"button",onClick:r,onKeydown:x(y(r,["prevent"]),["enter"])},[f("div",X,[p(l,{name:"mdi-light:cloud-upload",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 mb-2 h-10 w-10 transition-colors duration-300"}),f("h4",Z,h(e.$t("Drop file to upload")),1),f("div",null,[f("span",ee,h(e.$t("Or")),1)]),f("label",ae,h(e.$t("Select Image")),1)])],40,Y))],40,Q)])),_:1},8,["modelValue"]),v(Re)?(c(),g("div",ye,[f("img",{src:v(Re),alt:"Image Preview",class:"max-h-full max-w-full object-cover object-center"},null,8,ge)])):j("",!0)])])),_:1})]),p(o,{class:"p-5"},{default:i((()=>[f("div",xe,[p(v(W),{name:"project_id"},{default:i((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[p(O,{"model-value":e.value,error:a,items:v(Be)?.map((e=>({label:e.name,value:e.id}))),properties:{label:"label",value:"value"},placeholder:"Select a project",label:"Project",shape:"rounded","onUpdate:modelValue":r,onBlur:l},null,8,["model-value","error","items","onUpdate:modelValue","onBlur"])])),_:1}),p(v(W),{name:"chain"},{default:i((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[p(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,r],error:a,disabled:v(Ne),type:"text",label:"Token Chain",placeholder:"Enter chain",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),p(v(W),{name:"address"},{default:i((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[p(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,r],error:a,disabled:v(Ne),type:"text",label:"Token Address",placeholder:"Enter address",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),p(v(W),{name:"total_supply"},{default:i((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[p(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,r],error:a,disabled:v(Ne),type:"number",label:"Total Supply",placeholder:"Enter total supply",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),p(v(W),{name:"purchase_wallet_type"},{default:i((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[p(O,{"model-value":e.value,error:a,items:Me,label:"Purchase Wallet Type",placeholder:"Select wallet type",shape:"rounded","onUpdate:modelValue":r,onBlur:l},null,8,["model-value","error","onUpdate:modelValue","onBlur"])])),_:1}),p(v(W),{name:"purchase_currency"},{default:i((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[p(O,{"model-value":e.value,error:a,items:v(Oe),label:"Purchase Currency",placeholder:"Select purchase currency",disabled:!v(qe)?.purchase_wallet_type||""===v(qe)?.purchase_wallet_type,"onUpdate:modelValue":r,onBlur:l},null,8,["model-value","error","items","disabled","onUpdate:modelValue","onBlur"])])),_:1}),p(v(W),{name:"status"},{default:i((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[p(O,{"model-value":e.value,error:a,items:["PENDING","ACTIVE","COMPLETED","CANCELLED"],placeholder:"Select a status",label:"Status",shape:"rounded","onUpdate:modelValue":r,onBlur:l},null,8,["model-value","error","onUpdate:modelValue","onBlur"])])),_:1})])])),_:1}),p(o,{class:"p-5"},{default:i((()=>[p(v(W),{name:"description"},{default:i((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[p(A,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,r],error:a,label:"Description",shape:"rounded",placeholder:"Write a description",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1})])),_:1}),p(F,null,{default:i((()=>[p(t,{type:"submit",color:"primary",disabled:v(Ne),class:"w-full"},{default:i((()=>[m(h(e.$t("Create Token")),1)])),_:1},8,["disabled"])])),_:1})],32)])),_:1})}}});export{_e as default};
