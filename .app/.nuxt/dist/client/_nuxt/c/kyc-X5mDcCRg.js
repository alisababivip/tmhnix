import{a as e,U as a,Q as t,c as s,r as l,as as o,b as r,f as i,e as n,w as c,u as d,W as u,Y as m,o as p,q as b,t as v,O as h,k as g,F as f,B as _,_ as y,a0 as S,X as j}from"../e/entry-8qgg5CL-.js";import{_ as k}from"./BaseMessage.vue-Kpn2u5Rn.js";import{_ as x}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as B}from"./TairoFormGroup.vue--3qC-osX.js";import{_ as R}from"./TairoFormSave.vue-aLVbwikq.js";import{z as w,u as C,t as E,F as Y}from"./vee-validate.esm-n59zZCC5.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";const O={class:"flex items-center justify-between p-4"},T={class:"flex items-center gap-2"},F={class:"px-8"},K={class:"mx-auto space-y-12 py-8"},$={class:"text-gray-700 dark:text-gray-300"},M={class:"grid grid-cols-12 gap-4 pt-2"},U={class:"col-span-12 sm:col-span-6"},V={class:"grid grid-cols-12 gap-4 pt-2"},D=e({__name:"kyc",setup(e){const{updateSettings:D}=a(),W=t(),z=s((()=>W.settings)),A=[{name:"trade_restrictions",label:"Trade Restrictions",placeholder:"Select an option"},{name:"binary_restrictions",label:"Binary Restrictions",placeholder:"Select an option"},{name:"forex_restrictions",label:"Forex Restrictions",placeholder:"Select an option"},{name:"bot_restrictions",label:"Bot Restrictions",placeholder:"Select an option"},{name:"ico_restrictions",label:"ICO Restrictions",placeholder:"Select an option"},{name:"mlm_restrictions",label:"MLM Restrictions",placeholder:"Select an option"},{name:"wallet_restrictions",label:"Wallet Restrictions",placeholder:"Select an option"},{name:"deposit_restrictions",label:"Deposit Restrictions",placeholder:"Select an option"},{name:"withdrawal_restrictions",label:"Withdrawal Restrictions",placeholder:"Select an option"},{name:"ecommerce_restrictions",label:"Ecommerce Restrictions",placeholder:"Select an option"},{name:"staking_restrictions",label:"Staking Restrictions",placeholder:"Select an option"}],I=w.object({label:w.string(),value:w.boolean()}),L=w.object({kyc_status:I}),q=w.object(A.reduce(((e,a)=>(e[a.name]=I,e)),{})),G=w.object({...L.shape,...q.shape}),J=E(G),P=e=>({label:e?"Enabled":"Disabled",value:e}),Q=s((()=>{const e={};return e.kyc_status=P(z.value.kyc_status||!1),A.forEach((a=>{e[a.name]=P(z.value[a.name]||!1)})),e})),{handleSubmit:X,isSubmitting:H,setFieldError:N,meta:Z,errors:ee,resetForm:ae,setErrors:te}=C({validationSchema:J,initialValues:Q}),se=l(!1),le=s((()=>Object.keys(ee.value).length));o((()=>{if(Z.value.dirty)return confirm("You have unsaved changes. Are you sure you want to leave?")}));const oe=X((async e=>{se.value=!1;try{const a=Object.fromEntries(Object.entries(e).map((([e,a])=>[e,a.value]))),t=await D(a);"success"===t.status&&(await D(a),document.documentElement.scrollTo({top:0,behavior:"smooth"}),se.value=!0,W.setSettings(Object.values(t.data.result)),setTimeout((()=>{se.value=!1}),3e3))}catch(a){for(const[e,t]of Object.entries(a.data.errors))N(e,t[0])}})),re=[{label:"Enabled",value:!0},{label:"Disabled",value:!1}];return(e,a)=>{const t=y,s=S,l=j,o=k,w=x,C=B,E=m,D=R;return p(),r("div",null,[i("form",{method:"POST",action:"",class:"w-full pb-16",onSubmit:a[2]||(a[2]=u(((...e)=>d(oe)&&d(oe)(...e)),["prevent"]))},[n(E,null,{default:c((()=>[i("div",O,[i("div",null,[n(t,{tag:"h2",size:"sm",weight:"medium",lead:"normal",class:"uppercase tracking-wider"},{default:c((()=>[b(v(e.$t("KYC Settings")),1)])),_:1}),n(s,{size:"xs",class:"text-muted-400"},{default:c((()=>[b(v(e.$t("Edit your site KYC settings")),1)])),_:1})]),i("div",T,[n(l,{type:"submit",color:"primary",class:"w-24",disabled:d(H)||!d(Z).dirty,loading:d(H)},{default:c((()=>[b(v(e.$t("Save")),1)])),_:1},8,["disabled","loading"])])]),i("div",F,[i("div",K,[d(se)?(p(),h(o,{key:0,onClose:a[0]||(a[0]=e=>se.value=!1)},{default:c((()=>[i("span",$,v(e.$t("Your settings have been saved"))+"!",1)])),_:1})):g("",!0),d(le)?(p(),h(o,{key:1,type:"danger",onClose:a[1]||(a[1]=()=>d(te)({}))},{default:c((()=>[b(v(e.$t("This form has"))+" "+v(d(le))+" "+v(e.$t("errors, please check them before submitting")),1)])),_:1})):g("",!0),n(C,{label:"KYC Status",sublabel:"control your KYC status in the system"},{default:c((()=>[i("div",M,[i("div",U,[n(d(Y),{name:"kyc_status"},{default:c((({field:e,errorMessage:a,handleChange:t,handleBlur:s})=>[n(w,{"model-value":e.value,error:a,disabled:d(H),items:re,properties:{label:"label",value:"value"},placeholder:"Select an option",label:"KYC Status",shape:"rounded","onUpdate:modelValue":t,onBlur:s},null,8,["model-value","error","disabled","onUpdate:modelValue","onBlur"])])),_:1})])])])),_:1}),n(C,{label:"Restrictions",sublabel:"control client restrictions in the system depending on their KYC status"},{default:c((()=>[i("div",V,[(p(),r(f,null,_(A,(e=>i("div",{key:e.name,class:"col-span-12 sm:col-span-6"},[n(d(Y),{name:e.name},{default:c((({field:a,errorMessage:t,handleChange:s,handleBlur:l})=>[n(w,{"model-value":a.value,error:t,disabled:d(H),items:re,properties:{label:"label",value:"value"},placeholder:e.placeholder,label:e.label,shape:"rounded","onUpdate:modelValue":s,onBlur:l},null,8,["model-value","error","disabled","placeholder","label","onUpdate:modelValue","onBlur"])])),_:2},1032,["name"])]))),64))])])),_:1})])])])),_:1}),n(D,{disabled:d(H),loading:d(H),onReset:d(ae)},null,8,["disabled","loading","onReset"])],32)])}}});export{D as default};
