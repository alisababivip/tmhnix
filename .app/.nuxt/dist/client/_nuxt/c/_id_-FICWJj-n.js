import{a as e,z as a,c as t,r as l,E as r,ad as o,ac as s,J as d,O as n,w as u,o as i,e as m,q as c,t as p,f,u as h,p as v,W as b,b as g,A as y,F as x,B as w,n as _,k as V,_ as k,x as j,X as B,Y as U}from"../e/entry-8qgg5CL-.js";import{_ as M}from"./BaseInput.vue-iInHQMIA.js";import{_ as C}from"./BaseProgress.vue-xH0Mhn3Z.js";import{_ as F}from"./BaseInputFileHeadless.vue-LOgyN9kF.js";import{_ as q}from"./BaseTextarea.vue-8st5U0qk.js";import{_ as I}from"./BaseButtonIcon.vue-6tAU_b7C.js";import{_ as E}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as P}from"./BaseCheckbox.vue-cNhyVlDH.js";import{_ as S}from"./TairoButtonIcon.vue-KqKLsAHm.js";import{_ as T}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as W}from"./useWallet-8iHzU2hV.js";import{u as D}from"./fetch-i3Y1jjTS.js";import{b as $}from"./strings-rQgUKePI.js";import{_ as z}from"./placeholder-file-IxKzOaSl.js";import{z as A,u as R,t as L,F as O}from"./vee-validate.esm-n59zZCC5.js";import{u as H}from"./methods-1ZR1EQN-.js";import"./input-id-wZ-Ta08j.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";import"./IconCheck-JvP9GQU1.js";const K={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},J={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},N=["onDrop"],X=["onClick","onKeydown"],Y={class:"p-5 text-center"},G={class:"text-muted-400 font-sans text-sm"},Q={class:"text-muted-400 font-sans text-[0.7rem] font-semibold uppercase"},Z={for:"file",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 cursor-pointer font-sans text-sm underline underline-offset-4 transition-colors duration-300"},ee={key:1,class:"mt-6 space-y-2"},ae={class:"border-muted-200 dark:border-muted-700 dark:bg-muted-800 relative flex items-center justify-end gap-2 rounded-xl border bg-white p-3"},te={class:"flex items-center gap-2"},le={class:"shrink-0"},re=["src"],oe={key:1,class:"h-14 w-14 rounded-xl object-cover object-center",src:z,alt:"Image preview"},se={class:"font-sans"},de={class:"text-muted-800 dark:text-muted-100 line-clamp-1 block text-sm"},ne={class:"text-muted-400 block text-xs"},ue={class:"flex gap-2"},ie={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300 disabled:cursor-not-allowed disabled:opacity-60",disabled:"",type:"button",tooltip:"Cancel"},me=f("span",{class:"sr-only"},"Cancel",-1),ce={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Upload"},pe=f("span",{class:"sr-only"},"Upload",-1),fe=["onClick"],he=f("span",{class:"sr-only"},"Remove",-1),ve={key:0,class:"mb-4 h-36 w-full flex items-center justify-center overflow-hidden rounded-xl"},be=["src"],ge={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},ye={class:"flex justify-between items-center"},xe={class:"text-xl font-semibold mb-4"},we={class:"grid grid-cols-1 sm:grid-cols-12 gap-6"},_e={class:"col-span-1 sm:col-span-6"},Ve={class:"col-span-1 sm:col-span-4"},ke={class:"col-span-1 sm:col-span-2"},je={class:"flex justify-end items-center gap-2 pt-6"},Be=e({__name:"[id]",setup(e){const z=a().params.id,Be=H(),{updateWithdrawMethod:Ue}=W(),Me=t((()=>Be.selectedMethod||Be.getMethodById(z))),Ce=l(null),Fe=l(Me.value?.image||null);r((async()=>{const e=Number(z);0===Be.methods.length&&await Be.fetchWithdrawMethods(),Be.selectMethodById(e),Fe.value=Me.value?.image||null,Be.selectedMethod||Ie.push("/admin/finance/withdraw/methods")}));const{toast:qe}=o(),Ie=s(),Ee=A.object({title:A.string().nonempty("Title is required"),instructions:A.string().nonempty("Instructions are required"),image:A.union([A.string(),A.null()]).optional(),fixed_fee:A.number().min(0,"Fixed fee must be greater or equal to 0"),percentage_fee:A.number().min(0,"Percentage fee must be greater or equal to 0").max(100,"Percentage fee must be less than or equal to 100"),processing_time:A.string().nonempty("Processing time is required"),min_amount:A.number().min(0,"Minimum amount must be greater or equal to 0"),max_amount:A.number().min(0,"Maximum amount must be greater or equal to 0"),custom_fields:A.array(A.object({title:A.string(),required:A.boolean(),type:A.enum(["input","textarea","file upload"])}))}),Pe=t((()=>({...Me.value,custom_fields:Me.value?.custom_fields||[]}))),{handleSubmit:Se,isSubmitting:Te,setFieldError:We,meta:De,values:$e,errors:ze,resetForm:Ae,setFieldValue:Re,setErrors:Le}=R({validationSchema:L(Ee),initialValues:Pe});d(Ce,(e=>{const a=e?.item(0)||null;if(Ce.value){const e=new FileReader;e.onload=e=>{Fe.value=e.target?.result},e.readAsDataURL(a)}}));const Oe=t((()=>Me.value?.custom_fields||[])),He=()=>{const e=[...Oe.value,{title:"",required:!1,type:"input"}];Re("custom_fields",e)},Ke=Se((async e=>{try{let a={...e,custom_fields:Oe.value};if(Ce.value){const e=new FormData;e.append("files",Ce.value[0]),e.append("type","withdrawMethods");const t=await D("/api/upload",{method:"POST",body:e},"$HFjLmq69Ad");t&&""!==t.data.value&&(a.image=t.data.value[0])}const t=await Ue(z,a);qe.response(t),"success"===t.status&&(await Be.fetchWithdrawMethods(),Ie.push("/admin/finance/withdraw/methods"),Ae())}catch(a){qe.danger(a)}}));return(e,a)=>{const t=k,l=j,r=B,o=M,s=U,d=C,W=F,D=q,z=I,A=E,R=P,L=S,H=T;return i(),n(H,null,{left:u((()=>[m(t,{size:"lg"},{default:u((()=>[c(p(e.$t("Edit Withdraw Method")),1)])),_:1})])),right:u((()=>[m(r,{type:"button",color:"muted",to:"/admin/finance/withdraw/methods"},{default:u((()=>[m(l,{name:"line-md:chevron-left",class:"h-4 w-4 mr-2"}),c(" "+p(e.$t("Back")),1)])),_:1})])),default:u((()=>[f("form",{onSubmit:a[3]||(a[3]=(...e)=>h(Ke)&&h(Ke)(...e)),class:"space-y-8"},[f("div",K,[m(s,{class:"p-5 space-y-5"},{default:u((()=>[m(h(O),{name:"title"},{default:u((({field:e,errorMessage:a,handleChange:t,handleBlur:l})=>[m(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],error:a,disabled:h(Te),type:"text",label:"Title",placeholder:"Enter title",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),m(h(O),{name:"processing_time"},{default:u((({field:e,errorMessage:a,handleChange:t,handleBlur:l})=>[m(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],error:a,type:"text",label:"Processing Time",placeholder:"Ex: 3 Days",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1})])),_:1}),m(s,{class:"p-5"},{default:u((()=>[f("div",J,[m(W,{modelValue:h(Ce),"onUpdate:modelValue":a[2]||(a[2]=e=>v(Ce)?Ce.value=e:null)},{default:u((({open:t,remove:r,preview:o,drop:s,files:n})=>[f("div",{class:"",onDragenter:a[0]||(a[0]=b((()=>{}),["stop","prevent"])),onDragover:a[1]||(a[1]=b((()=>{}),["stop","prevent"])),onDrop:s},[n?.length?(i(),g("ul",ee,[(i(!0),g(x,null,w(n,(a=>(i(),g("li",{key:a.name},[f("div",ae,[f("div",te,[f("div",le,[a.type.startsWith("image")?(i(),g("img",{key:0,class:"h-14 w-14 rounded-xl object-cover object-center",src:o(a).value,alt:"Image preview"},null,8,re)):(i(),g("img",oe))]),f("div",se,[f("span",de,p(a.name),1),f("span",ne,p(("formatFileSize"in e?e.formatFileSize:h($))(a.size)),1)])]),f("div",{class:_(["ms-auto w-32 px-4 transition-opacity duration-300","opacity-100"])},[m(d,{value:0,size:"xs",color:"success"})]),f("div",ue,[f("button",ie,[m(l,{name:"lucide:slash",class:"h-4 w-4"}),me]),f("button",ce,[m(l,{name:"lucide:arrow-up",class:"h-4 w-4"}),pe]),f("button",{class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Remove",onClick:b((e=>r(a)),["prevent"])},[m(l,{name:"lucide:x",class:"h-4 w-4"}),he],8,fe)])])])))),128))])):(i(),g("div",{key:0,class:"nui-focus border-muted-300 dark:border-muted-700 hover:border-muted-400 focus:border-muted-400 dark:hover:border-muted-600 dark:focus:border-muted-700 group cursor-pointer rounded-lg border-[3px] border-dashed transition-colors duration-300",tabindex:"0",role:"button",onClick:t,onKeydown:y(b(t,["prevent"]),["enter"])},[f("div",Y,[m(l,{name:"mdi-light:cloud-upload",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 mb-2 h-10 w-10 transition-colors duration-300"}),f("h4",G,p(e.$t("Drop file to upload")),1),f("div",null,[f("span",Q,p(e.$t("Or")),1)]),f("label",Z,p(e.$t("Select Image")),1)])],40,X))],40,N)])),_:1},8,["modelValue"]),h(Fe)?(i(),g("div",ve,[f("img",{src:h(Fe),alt:"Image Preview",class:"max-h-full max-w-full object-cover object-center"},null,8,be)])):V("",!0)])])),_:1})]),m(s,{class:"p-5"},{default:u((()=>[m(h(O),{name:"instructions"},{default:u((({field:e,errorMessage:a,handleChange:t,handleBlur:l})=>[m(D,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],error:a,label:"Withdraw Instruction",shape:"rounded",placeholder:"Write withdrawal instructions...",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1})])),_:1}),f("div",ge,[m(s,{class:"p-5 space-y-5"},{default:u((()=>[m(h(O),{name:"fixed_fee"},{default:u((({field:e,errorMessage:a,handleChange:t,handleBlur:l})=>[m(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],error:a,type:"number",label:"Fixed Fee",placeholder:"Enter fixed fee",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1}),m(h(O),{name:"percentage_fee"},{default:u((({field:e,errorMessage:a,handleChange:t,handleBlur:l})=>[m(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],error:a,type:"number",label:"Percentage fee",placeholder:"Enter Percentage fee",shape:"rounded",min:"0",max:"100",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1})])),_:1}),m(s,{class:"p-5 space-y-5"},{default:u((()=>[m(h(O),{name:"min_amount"},{default:u((({field:e,errorMessage:a,handleChange:t,handleBlur:l})=>[m(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],error:a,type:"number",label:"Minimum Amount",placeholder:"Enter minimum amount",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1}),m(h(O),{name:"max_amount"},{default:u((({field:e,errorMessage:a,handleChange:t,handleBlur:l})=>[m(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],error:a,type:"number",label:"Maximum Amount",placeholder:"Enter maximum amount",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1})])),_:1})]),m(s,{class:"p-5 space-y-5"},{default:u((()=>[f("div",ye,[f("h3",xe,p(e.$t("Custom Fields")),1),m(z,{type:"button",color:"primary",onClick:He,condensed:""},{default:u((()=>[m(l,{name:"line-md:plus",class:"h-5 w-5"})])),_:1})]),(i(!0),g(x,null,w(h(Oe),((e,a)=>(i(),g("div",{key:a,class:"space-y-4"},[f("div",we,[f("div",_e,[m(o,{modelValue:e.title,"onUpdate:modelValue":a=>e.title=a,shape:"rounded",label:"Field Title",placeholder:"Ex: username"},null,8,["modelValue","onUpdate:modelValue"])]),f("div",Ve,[m(A,{modelValue:e.type,"onUpdate:modelValue":a=>e.type=a,label:"Field Type",items:["input","textarea","file upload"],placeholder:"Select a type",shape:"rounded"},null,8,["modelValue","onUpdate:modelValue"])]),f("div",ke,[f("div",je,[m(R,{modelValue:e.required,"onUpdate:modelValue":a=>e.required=a,label:"Required"},null,8,["modelValue","onUpdate:modelValue"]),m(L,{type:"button",color:"danger",onClick:e=>(e=>{const a=Oe.value.slice();a.splice(e,1),Re("custom_fields",a)})(a)},{default:u((()=>[m(l,{name:"line-md:close",class:"h-4 w-4"})])),_:2},1032,["onClick"])])])])])))),128))])),_:1}),m(r,{type:"submit",color:"primary",disabled:h(Te),class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"},{default:u((()=>[c(p(e.$t("Update Method")),1)])),_:1},8,["disabled"])],32)])),_:1})}}});export{Be as default};
