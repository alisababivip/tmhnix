import{a as e,ad as a,ac as r,z as l,c as t,ap as o,Q as s,E as d,J as n,r as u,O as i,w as c,o as m,u as p,q as h,t as v,e as f,f as b,p as y,W as g,b as x,A as _,F as k,B as w,n as j,k as B,_ as V,x as C,X as T,Y as U}from"../e/entry-8qgg5CL-.js";import{_ as E}from"./BaseInput.vue-iInHQMIA.js";import{_ as I}from"./BaseProgress.vue-xH0Mhn3Z.js";import{_ as S}from"./BaseInputFileHeadless.vue-LOgyN9kF.js";import{_ as D}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as P}from"./BaseTextarea.vue-8st5U0qk.js";import{_ as A}from"./TairoFormSave.vue-aLVbwikq.js";import{_ as M}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as F}from"./useIco-3A31FykS.js";import{u as N}from"./currency-9FjTf2Bf.js";import{u as O}from"./fetch-i3Y1jjTS.js";import{b as $}from"./strings-rQgUKePI.js";import{_ as q}from"./placeholder-file-IxKzOaSl.js";import{z as L,u as z,t as W,F as R}from"./vee-validate.esm-n59zZCC5.js";import{u as K}from"./admin-Nwh6nXjV.js";import{u as G}from"./tokens-3I890zGb.js";import"./input-id-wZ-Ta08j.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";import"./useExchange-VMAYQu3P.js";import"./useEcosystem-9eBUNbsT.js";const J={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},Q={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},H=["onDrop"],X=["onClick","onKeydown"],Y={class:"p-5 text-center"},Z={class:"text-muted-400 font-sans text-sm"},ee={class:"text-muted-400 font-sans text-[0.7rem] font-semibold uppercase"},ae={for:"file",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 cursor-pointer font-sans text-sm underline underline-offset-4 transition-colors duration-300"},re={key:1,class:"mt-6 space-y-2"},le={class:"border-muted-200 dark:border-muted-700 dark:bg-muted-800 relative flex items-center justify-end gap-2 rounded-xl border bg-white p-3"},te={class:"flex items-center gap-2"},oe={class:"shrink-0"},se=["src"],de={key:1,class:"h-14 w-14 rounded-xl object-cover object-center",src:q,alt:"Image preview"},ne={class:"font-sans"},ue={class:"text-muted-800 dark:text-muted-100 line-clamp-1 block text-sm"},ie={class:"text-muted-400 block text-xs"},ce={class:"flex gap-2"},me={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300 disabled:cursor-not-allowed disabled:opacity-60",disabled:"",type:"button",tooltip:"Cancel"},pe=b("span",{class:"sr-only"},"Cancel",-1),he={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Upload"},ve=b("span",{class:"sr-only"},"Upload",-1),fe=["onClick"],be=b("span",{class:"sr-only"},"Remove",-1),ye={key:0,class:"mb-4 h-36 w-full flex items-center justify-center overflow-hidden rounded-xl"},ge=["src"],xe={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},_e=e({__name:"[id]",setup(e){const{toast:q}=a(),_e=r(),{id:ke}=l().params,we=G(),{updateIcoToken:je}=F(),Be=t((()=>we.selectedToken||we.getTokenById(ke))),Ve=o(),Ce=t((()=>Ve.extensions)),Te=t((()=>Ce.value?.find((e=>"ecosystem"===e.name)))),Ue=s(),Ee=t((()=>Ue.settings)),Ie=N(),Se=t((()=>Ie.currencies)),De=K(),Pe=t((()=>De.tokens)),Ae=[];d((async()=>{const e=Number(ke);0===we.tokens.length&&await we.fetchIcoTokens(),await we.selectTokenById(e),Re.value=Be.value?.image||null,0===Ve.extensions.length&&await Ve.fetchExtensions(),Ee.value?.spot_exchange&&(Ae.push("SPOT"),0===Ie.currencies.length&&await Ie.fetchCurrencies()),Te.value?.status&&(Ae.push("ECO"),0===De.tokens.length&&await De.fetchTokensAll()),qe()}));const Me=t((()=>{let e=[];"SPOT"===ze.purchase_wallet_type?e=Se.value.map((e=>e.currency)):"ECO"===ze.purchase_wallet_type&&(e=Pe.value.map((e=>e.currency)));return[...new Set(e)]})),Fe=L.object({name:L.string().nonempty("Name is required"),chain:L.string().nonempty("Chain is required"),currency:L.string().nonempty("Currency is required"),purchase_currency:L.string().nonempty("Purchase currency is required"),address:L.string().nonempty("Address is required"),total_supply:L.number().min(0,"Total supply must be greater than 0"),description:L.string().nonempty("Description is required"),status:L.enum(["PENDING","ACTIVE","COMPLETED","CANCELLED"]),project_id:L.object({label:L.string(),value:L.number()}),purchase_wallet_type:L.enum(Ae)}),Ne=t((()=>({...Be.value,project_id:{label:Be.value?.project.name,value:Be.value?.project.id}}))),{handleSubmit:Oe,isSubmitting:$e,resetForm:qe,setFieldValue:Le,values:ze}=z({validationSchema:W(Fe),initialValues:Ne});n((()=>ze.purchase_wallet_type),(e=>{e&&Le("purchase_currency","")}));const We=u(null),Re=u(Be.value?.image||null);n(We,(e=>{const a=e?.item(0)||null;if(We.value){const e=new FileReader;e.onload=e=>{Re.value=e.target?.result},e.readAsDataURL(a)}}));const Ke=Oe((async e=>{try{let a={...e,image:Re.value??""};if(We.value){const e=new FormData;e.append("files",We.value[0]),e.append("type","icoToken");const r=await O("/api/upload",{method:"POST",body:e},"$w2KIAqF7Ai");r&&""!==r.data.value&&(a.image=r.data.value[0])}const r=await je(Number(ke),Number(a.project_id.value),a.name,a.chain,a.currency,a.purchase_currency,a.purchase_wallet_type,a.address,a.total_supply,a.description,a.image,a.status);q.response(r),"success"===r.status&&(await we.fetchIcoTokens(),_e.push("/admin/extensions/ico/tokens"))}catch(a){q.danger(a)}}));return(e,a)=>{const r=V,l=C,t=T,o=E,s=U,d=I,n=S,u=D,F=P,N=A,O=M;return m(),i(O,null,{left:c((()=>[(m(),i(r,{size:"lg",key:p(Be)?.name},{default:c((()=>[h(v(e.$t(`\n        Editing ${p(Be)?.name??"ICO Token"} Token\n      `)),1)])),_:1}))])),right:c((()=>[f(t,{type:"button",color:"muted",class:"hover:bg-gray-300 dark:hover:bg-gray-800",to:"/admin/extensions/ico/tokens"},{default:c((()=>[f(l,{name:"line-md:chevron-left",class:"h-4 w-4 mr-2"}),h(" "+v(e.$t("Back")),1)])),_:1}),f(t,{type:"submit",color:"primary",disabled:p($e),class:"w-full",onClick:p(Ke)},{default:c((()=>[h(v(e.$t("Update Token")),1)])),_:1},8,["disabled","onClick"])])),default:c((()=>[b("form",{onSubmit:a[3]||(a[3]=(...e)=>p(Ke)&&p(Ke)(...e)),class:"space-y-8"},[b("div",J,[f(s,{class:"p-5 space-y-5"},{default:c((()=>[f(p(R),{name:"name"},{default:c((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[f(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,r],error:a,disabled:p($e),type:"text",label:"Name",placeholder:"Enter name",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),f(p(R),{name:"currency"},{default:c((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[f(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,r],error:a,disabled:p($e),type:"text",label:"Currency",placeholder:"Enter currency",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})])),_:1}),f(s,{class:"p-5"},{default:c((()=>[b("div",Q,[f(n,{modelValue:p(We),"onUpdate:modelValue":a[2]||(a[2]=e=>y(We)?We.value=e:null)},{default:c((({open:r,remove:t,preview:o,drop:s,files:n})=>[b("div",{class:"",onDragenter:a[0]||(a[0]=g((()=>{}),["stop","prevent"])),onDragover:a[1]||(a[1]=g((()=>{}),["stop","prevent"])),onDrop:s},[n?.length?(m(),x("ul",re,[(m(!0),x(k,null,w(n,(a=>(m(),x("li",{key:a.name},[b("div",le,[b("div",te,[b("div",oe,[a.type.startsWith("image")?(m(),x("img",{key:0,class:"h-14 w-14 rounded-xl object-cover object-center",src:o(a).value,alt:"Image preview"},null,8,se)):(m(),x("img",de))]),b("div",ne,[b("span",ue,v(a.name),1),b("span",ie,v(("formatFileSize"in e?e.formatFileSize:p($))(a.size)),1)])]),b("div",{class:j(["ms-auto w-32 px-4 transition-opacity duration-300","opacity-100"])},[f(d,{value:0,size:"xs",color:"success"})]),b("div",ce,[b("button",me,[f(l,{name:"lucide:slash",class:"h-4 w-4"}),pe]),b("button",he,[f(l,{name:"lucide:arrow-up",class:"h-4 w-4"}),ve]),b("button",{class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Remove",onClick:g((e=>t(a)),["prevent"])},[f(l,{name:"lucide:x",class:"h-4 w-4"}),be],8,fe)])])])))),128))])):(m(),x("div",{key:0,class:"nui-focus border-muted-300 dark:border-muted-700 hover:border-muted-400 focus:border-muted-400 dark:hover:border-muted-600 dark:focus:border-muted-700 group cursor-pointer rounded-lg border-[3px] border-dashed transition-colors duration-300",tabindex:"0",role:"button",onClick:r,onKeydown:_(g(r,["prevent"]),["enter"])},[b("div",Y,[f(l,{name:"mdi-light:cloud-upload",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 mb-2 h-10 w-10 transition-colors duration-300"}),b("h4",Z,v(e.$t("Drop file to upload")),1),b("div",null,[b("span",ee,v(e.$t("Or")),1)]),b("label",ae,v(e.$t("Select Image")),1)])],40,X))],40,H)])),_:1},8,["modelValue"]),p(Re)?(m(),x("div",ye,[b("img",{src:p(Re),alt:"Image Preview",class:"max-h-full max-w-full object-cover object-center"},null,8,ge)])):B("",!0)])])),_:1})]),f(s,{class:"p-5"},{default:c((()=>[b("div",xe,[f(p(R),{name:"project_id"},{default:c((({field:a,errorMessage:r,handleChange:l,handleBlur:t})=>[f(u,{"model-value":a.value,error:r,items:e.projects?.map((e=>({label:e.name,value:e.id}))),properties:{label:"label",value:"value"},placeholder:"Select a project",label:"Project",shape:"rounded","onUpdate:modelValue":l,onBlur:t},null,8,["model-value","error","items","onUpdate:modelValue","onBlur"])])),_:1}),f(p(R),{name:"chain"},{default:c((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[f(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,r],error:a,disabled:p($e),type:"text",label:"Chain",placeholder:"Enter chain",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),f(p(R),{name:"address"},{default:c((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[f(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,r],error:a,disabled:p($e),type:"text",label:"Address",placeholder:"Enter address",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),f(p(R),{name:"total_supply"},{default:c((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[f(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,r],error:a,disabled:p($e),type:"number",label:"Total Supply",placeholder:"Enter total supply",shape:"rounded",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),f(p(R),{name:"purchase_wallet_type"},{default:c((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[f(u,{"model-value":e.value,error:a,items:Ae,label:"Purchase Wallet Type",placeholder:"Select wallet type",shape:"rounded","onUpdate:modelValue":r,onBlur:l},null,8,["model-value","error","onUpdate:modelValue","onBlur"])])),_:1}),f(p(R),{name:"purchase_currency"},{default:c((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[f(u,{"model-value":e.value,error:a,items:p(Me),label:"Purchase Currency",placeholder:"Select purchase currency",disabled:!p(ze)?.purchase_wallet_type||""===p(ze)?.purchase_wallet_type,"onUpdate:modelValue":r,onBlur:l},null,8,["model-value","error","items","disabled","onUpdate:modelValue","onBlur"])])),_:1}),f(p(R),{name:"status"},{default:c((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[f(u,{"model-value":e.value,error:a,items:["PENDING","ACTIVE","COMPLETED","CANCELLED"],placeholder:"Select a status",label:"Status",shape:"rounded","onUpdate:modelValue":r,onBlur:l},null,8,["model-value","error","onUpdate:modelValue","onBlur"])])),_:1})])])),_:1}),f(s,{class:"p-5"},{default:c((()=>[f(p(R),{name:"description"},{default:c((({field:e,errorMessage:a,handleChange:r,handleBlur:l})=>[f(F,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,r],error:a,label:"Description",shape:"rounded",placeholder:"Write a description",class:"w-full",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1})])),_:1}),f(N,null,{default:c((()=>[f(t,{type:"submit",color:"primary",disabled:p($e),class:"w-full"},{default:c((()=>[h(v(e.$t("Update Token")),1)])),_:1},8,["disabled"])])),_:1})],32)])),_:1})}}});export{_e as default};
