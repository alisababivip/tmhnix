import{a as e,z as t,ac as a,r as s,E as l,c as o,aL as n,ad as r,o as i,O as c,w as u,u as d,t as f,q as p,e as h,f as m,b as y,k as v,p as g,F as w,_ as x,x as $,X as b,Y as k}from"../e/entry-8qgg5CL-.js";import{_}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as C}from"./BaseInput.vue-iInHQMIA.js";import{_ as T}from"./BaseIconBox.vue-qjQCKz6R.js";import{_ as E}from"./BaseButtonAction.vue-hzSHyI6o.js";import{_ as I}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as j}from"./wallet-n04aoRPe.js";import{u as L}from"./useWallet-8iHzU2hV.js";import{Q as S}from"./index-m04Or-0K.js";const D=""+globalThis.__publicAssetsURL("img/guide/deposit/txHash.png"),V={key:0,class:"space-y-5"},z={class:"list-disc pl-8"},A={key:1,class:"space-y-5 min-h-screen pb-20"},P=m("hr",{class:"border-gray-200 dark:border-gray-700"},null,-1),B={class:"grid gap-5 grid-cols-1 sm:grid-cols-12 pl-8"},U={class:"flex items-end gap-5"},N={class:"w-full flex gap-5"},W={class:"w-full"},R={key:0,class:"w-full"},G=m("hr",{class:"border-gray-200 dark:border-gray-700"},null,-1),O={class:"pl-8 space-y-5"},F={for:"guide",class:"text-muted-800 dark:text-white"},M=m("img",{id:"guide",src:D,class:"rounded-lg shadow"},null,-1),H=m("hr",{class:"border-gray-200 dark:border-gray-700"},null,-1),X={key:2},Y={key:0,class:"h-[calc(80vh)] flex justify-center items-center"},q={class:"my-auto text-center flex-col justify-center space-y-5"},K={class:"text-2xl font-bold"},Q={key:1,class:"h-[calc(80vh)] flex justify-center items-center"},J={class:"my-auto text-center flex-col justify-center space-y-5"},Z={class:"text-2xl font-bold"},ee={key:2,class:"h-[calc(80vh)] flex justify-center items-center"},te={class:"my-auto text-center flex-col justify-center space-y-5"},ae={class:"text-2xl font-bold"},se={key:3,class:"h-[calc(80vh)] flex justify-center items-center"},le={class:"my-auto text-center flex-col justify-center space-y-5"},oe={class:"text-2xl font-bold"},ne={key:4,class:"h-[calc(80vh)] flex justify-center items-center"},re={class:"my-auto text-center flex-col justify-center space-y-5"},ie={class:"text-2xl font-bold"},ce={key:5,class:"h-[calc(80vh)] flex justify-center items-center"},ue={class:"my-auto text-center flex-col justify-center space-y-5"},de={class:"text-2xl font-bold"},fe={key:6,class:"h-[calc(80vh)] flex justify-center items-center"},pe={class:"my-auto text-center flex-col justify-center space-y-5"},he={class:"text-2xl font-bold"},me=e({__name:"index",props:{flutter:{type:Boolean,default:!1}},setup(e){const D=e,me=t(),ye=a(),ve=me.params.currency.toUpperCase(),ge=j(),{getSpotTransaction:we,cancelSpotDepositTransaction:xe,createSpotDepositTransaction:$e}=L(),be=s(null),ke=s(""),_e=s(1);l((async()=>{await ge.fetchWallet(ve,"SPOT"),ge.wallet||ye.push(`/user/${D.flutter?"flutter/":""}wallets/spot/${ve.toLowerCase()}`)}));const Ce=o((()=>ge.wallet)),Te=o((()=>be.value?Ce.value.addresses[be.value].address:"")),Ee=o((()=>be.value?Ce.value.addresses[be.value].tag:"")),Ie=()=>{_e.value=2},je=async()=>{if(ke.value){try{const e=await $e(Ce.value?.id,ke.value,be.value);"success"===e.status?Se():"fail"===e.status&&("Transaction already exists"===e.error.message?Pe.value="USED":Pe.value="INVALID")}catch(e){"Transaction already exists"===e.error.message?Pe.value="USED":Pe.value="INVALID"}_e.value=3}},Le=s(1800),Se=()=>{Le.value=1800,Be.postMessage(Le.value),Be.onmessage=e=>{"CHECK_TRANSACTION"!==e.data?"EXPIRED"!==e.data?Le.value=e.data:Pe.value="EXPIRED":async function(){try{const e=await we(ke.value);if("fail"===e.status)return void(Pe.value="FAILED");e.data.result&&(Ae.value=e.data.result,Pe.value=e.data.result.status)}catch(e){Pe.value="FAILED"}}()}};n((()=>{Be.terminate()}));const De=o((()=>`${Math.floor(Le.value/60)}:${(Le.value%60).toString().padStart(2,"0")}`)),{toast:Ve}=r(),ze=()=>{navigator.clipboard.writeText(Te.value).then((()=>{Ve.info("Address copied to clipboard")}),(e=>{Ve.warning("Failed to copy address to clipboard")}))},Ae=s(null),Pe=s("PENDING");const Be=new Worker(URL.createObjectURL(new Blob(["\nself.addEventListener('message', function (e) {\n  let remainingSeconds = e.data\n  const intervalId = setInterval(() => {\n    if (remainingSeconds <= 0) {\n      clearInterval(intervalId)\n      postMessage('EXPIRED')\n      return\n    }\n\n    remainingSeconds--\n\n    // Check transaction every 30 seconds\n    if (remainingSeconds % 20 === 0) {\n      postMessage('CHECK_TRANSACTION')\n    }\n\n    postMessage(remainingSeconds)\n  }, 1000)\n}, false)\n    "],{type:"text/javascript"})));async function Ue(){const e=await xe(ke.value);Ve.response(e),"success"===e.status&&(Be.terminate(),Pe.value="CANCELLED",ye.push(`/user/${D.flutter?"flutter/":""}wallets/spot/${ve.toLowerCase()}`))}const Ne=o((()=>Ce.value?.addresses?Object.keys(Ce.value.addresses).map((e=>e)):[]));return(t,a)=>{const s=x,l=$,o=b,n=_,r=C,j=k,L=T,D=E,me=I;return i(),c(me,null,{left:u((()=>[h(s,{size:"xl"},{default:u((()=>[p(f(d(ve))+" "+f(t.$t("Deposit")),1)])),_:1})])),right:u((()=>[m("div",null,[h(o,{to:`/user/${e.flutter?"flutter/":""}wallets/spot/${d(ve).toLowerCase()}`,color:"muted",flavor:"pastel"},{default:u((()=>[h(l,{name:"line-md:chevron-left",class:"h-4 w-4"}),m("span",null,f(t.$t("Cancel")),1)])),_:1},8,["to"])])])),default:u((()=>[1===d(_e)?(i(),y("div",V,[h(s,{as:"h3",size:"2xl",weight:"bold",class:"text-muted-800 dark:text-white"},{default:u((()=>[p(f(t.$t("Deposit Instructions")),1)])),_:1}),m("ul",z,[m("li",null,[m("strong",null,f(t.$t("Time Limit"))+":",1),p(" "+f(t.$t("You have 30 minutes to complete the deposit after selecting a chain"))+". ",1)]),m("li",null,[m("strong",null,f(t.$t("Select Chain"))+":",1),p(" "+f(t.$t("Choose the desired blockchain network for your deposit"))+". ",1)]),m("li",null,[m("strong",null,f(t.$t("Send Funds"))+":",1),p(" "+f(t.$t("You will receive a deposit address and a QR code. Send your funds to this address"))+". ",1)]),m("li",null,[m("strong",null,f(t.$t("Enter Transaction Hash"))+":",1),p(" "+f(t.$t("After sending the funds, enter the transaction hash for verification"))+". ",1)]),m("li",null,[m("strong",null,f(t.$t("Verification"))+":",1),p(" "+f(t.$t("The transaction will be verified within 30 minutes. Please do not refresh or leave the page"))+". ",1)])]),h(o,{color:"primary",onClick:Ie},{default:u((()=>[p(f(t.$t("Next"))+" ",1),h(l,{name:"ph:arrow-right-bold",class:"h-4 w-4 ml-2"})])),_:1})])):v("",!0),2===d(_e)?(i(),y("div",A,[m("div",null,[h(s,{as:"h3",size:"2xl",weight:"bold",class:"text-muted-800 dark:text-white items-center flex"},{default:u((()=>[d(be)?(i(),c(l,{key:1,name:"line-md:confirm-circle",class:"h-6 w-6 mr-2"})):(i(),c(l,{key:0,name:"line-md:loading-alt-loop",class:"h-6 w-6 mr-2"})),p(" "+f(t.$t("Select Chain")),1)])),_:1}),h(n,{class:"max-w-sm mt-5 pl-8 z-50",modelValue:d(be),"onUpdate:modelValue":a[0]||(a[0]=e=>g(be)?be.value=e:null),items:d(Ne),placeholder:"Select a chain",shape:"rounded"},null,8,["modelValue","items"])]),d(be)?(i(),y(w,{key:0},[P,h(s,{as:"h3",size:"2xl",weight:"bold",class:"text-muted-800 dark:text-white"},{default:u((()=>[h(l,{name:"line-md:uploading-loop",class:"h-6 w-6 mr-2"}),p(" "+f(t.$t("Send Transaction")),1)])),_:1}),m("div",B,[h(j,{class:"p-5 col-span-1 sm:col-span-8 md:col-span-9 lg:col-span-10"},{default:u((()=>[m("div",U,[m("div",N,[m("div",W,[h(r,{modelValue:d(Te),"onUpdate:modelValue":a[1]||(a[1]=e=>g(Te)?Te.value=e:null),shape:"rounded",type:"text",icon:"ph:copy-fill",label:"Deposit to the address",disabled:""},null,8,["modelValue"])]),d(Ee)?(i(),y("div",R,[h(r,{modelValue:d(Ee),"onUpdate:modelValue":a[2]||(a[2]=e=>g(Ee)?Ee.value=e:null),shape:"rounded",type:"text",icon:"ph:copy-fill",label:"Use this tag",disabled:""},null,8,["modelValue"])])):v("",!0)]),h(o,{color:"info",flavor:"outline",onClick:ze},{default:u((()=>[p(f(t.$t("Copy")),1)])),_:1})])])),_:1}),h(d(S),{class:"col-span-1 sm:col-span-4 md:col-span-3 lg:col-span-2",type:"image/webp",color:{dark:"#000000ff",light:"#ffffffff"},value:d(Te),options:{width:100}},null,8,["value"])]),G,h(s,{as:"h3",size:"2xl",weight:"bold",class:"text-muted-800 dark:text-white"},{default:u((()=>[h(l,{name:"line-md:loading-twotone-loop",class:"h-6 w-6 mr-2"}),p(" "+f(t.$t("Submit Transaction")),1)])),_:1}),m("div",O,[m("p",null,f(t.$t("After you have sent the transaction, please enter the transaction hash below"))+". ",1),h(r,{modelValue:d(ke),"onUpdate:modelValue":a[3]||(a[3]=e=>g(ke)?ke.value=e:null),id:"transactionHash",shape:"rounded",label:"Enter the transaction hash:",placeholder:"Enter the transaction hash..."},null,8,["modelValue"]),m("div",null,[m("label",F,f(t.$t("Example of a transaction hash"))+":",1),M])]),H,m("div",null,[h(o,{class:"w-full",color:"success",onClick:je,disabled:!d(ke)},{default:u((()=>[p(f(t.$t("Submit")),1)])),_:1},8,["disabled"])])],64)):v("",!0)])):v("",!0),3===d(_e)?(i(),y("div",X,["PENDING"===d(Pe)?(i(),y("div",Y,[m("div",q,[h(L,{size:"2xl",shape:"full",color:"info"},{default:u((()=>[h(l,{name:"svg-spinners:blocks-shuffle-3",class:"h-12 w-12"})])),_:1}),m("h1",K,f(t.$t("Waiting for Verification")),1),m("p",null,f(t.$t("Your transaction is currently pending and is waiting to be verified. Please refrain from closing the modal or refreshing the page until the verification process is complete. This may take a few moments, but rest assured that we are working diligently to ensure that your transaction is processed as quickly and securely as possible. Thank you for your patience and cooperation"))+". ",1),m("p",null,f(t.$t("Remaining time"))+": "+f(d(De)),1),h(D,{onClick:Ue,color:"danger",flavor:"outline"},{default:u((()=>[h(l,{name:"lucide:arrow-left",class:"h-3 w-3"}),m("span",null,f(t.$t("Cancel")),1)])),_:1})])])):v("",!0),"CANCELLED"===d(Pe)?(i(),y("div",Q,[m("div",J,[h(L,{size:"2xl",shape:"full",color:"danger"},{default:u((()=>[h(l,{name:"line-md:sunny-filled-loop-to-moon-alt-filled-loop-transition",class:"h-12 w-12"})])),_:1}),m("h1",Z,f(t.$t("Transaction Cancelled")),1),m("p",null,f(t.$t("We're sorry to inform you that your transaction has been cancelled. We apologize for any inconvenience this may have caused. Please try again at your earliest convenience. If you continue to experience difficulties with your transaction, please contact our customer support team for assistance. Thank you for your understanding"))+". ",1),h(D,{to:`/user/${e.flutter?"flutter/":""}wallets/spot/${d(ve).toLowerCase()}`},{default:u((()=>[h(l,{name:"lucide:arrow-left",class:"h-3 w-3"}),m("span",null,f(t.$t("Go Back")),1)])),_:1},8,["to"])])])):v("",!0),"FAILED"===d(Pe)?(i(),y("div",ee,[m("div",te,[h(L,{size:"2xl",shape:"full",color:"danger"},{default:u((()=>[h(l,{name:"line-md:sunny-filled-loop-to-moon-alt-filled-loop-transition",class:"h-12 w-12"})])),_:1}),m("h1",ae,f(t.$t("Transaction Failed")),1),m("p",null,f(t.$t("We're sorry to inform you that your transaction has failed. Please double-check that the information you entered is correct and try again. If you continue to experience difficulties, please contact our customer support team for assistance"))+". ",1),h(D,{to:`/user/${e.flutter?"flutter/":""}wallets/spot/${d(ve).toLowerCase()}`},{default:u((()=>[h(l,{name:"line-md:close",class:"h-3 w-3"}),m("span",null,f(t.$t("Go Back")),1)])),_:1},8,["to"])])])):v("",!0),"USED"===d(Pe)?(i(),y("div",se,[m("div",le,[h(L,{size:"2xl",shape:"full",color:"danger"},{default:u((()=>[h(l,{name:"ph:check-circle-duotone",class:"h-12 w-12"})])),_:1}),m("h1",oe,f(t.$t("Transaction Used")),1),m("p",null,f(t.$t("We're sorry, but the transaction hash you entered is invalid or has already been used. Please double-check that the information you entered is correct and try again. If you believe there has been an error, please contact our customer support team for assistance"))+". ",1),h(D,{to:`/user/${e.flutter?"flutter/":""}wallets/spot/${d(ve).toLowerCase()}`},{default:u((()=>[h(l,{name:"line-md:close",class:"h-3 w-3"}),m("span",null,f(t.$t("Go Back")),1)])),_:1},8,["to"])])])):v("",!0),"COMPLETED"===d(Pe)?(i(),y("div",ne,[m("div",re,[h(L,{size:"2xl",shape:"full",color:"success"},{default:u((()=>[h(l,{name:"ph:check-circle-duotone",class:"h-12 w-12"})])),_:1}),m("h1",ie,f(t.$t("Transaction Verified")),1),m("p",null,f(t.$t("Congratulations! Your transaction has been successfully verified and completed. Thank you for choosing our service to carry out your transaction. If you have any questions or concerns regarding your transaction, please do not hesitate to contact our customer support team for assistance. Thank you for your trust in us, and we look forward to serving you again in the future"))+". ",1),h(D,{to:`/user/${e.flutter?"flutter/":""}wallets/spot/${d(ve).toLowerCase()}`},{default:u((()=>[h(l,{name:"lucide:arrow-left",class:"h-3 w-3"}),m("span",null,f(t.$t("Go Back")),1)])),_:1},8,["to"])])])):v("",!0),"EXPIRED"===d(Pe)?(i(),y("div",ce,[m("div",ue,[h(L,{size:"2xl",shape:"full",color:"danger"},{default:u((()=>[h(l,{name:"line-md:sunny-filled-loop-to-moon-alt-filled-loop-transition",class:"h-12 w-12"})])),_:1}),m("h1",de,f(t.$t("Transaction Expired")),1),m("p",null,f(t.$t("We're sorry to inform you that your transaction has expired. This may be due to inactivity or an issue with your payment method. Please double-check that the information you entered is correct and try again. If you continue to experience difficulties, please contact our customer support team for assistance"))+". ",1),h(D,{to:`/user/${e.flutter?"flutter/":""}wallets/spot/${d(ve).toLowerCase()}`},{default:u((()=>[h(l,{name:"lucide:arrow-left",class:"h-3 w-3"}),m("span",null,f(t.$t("Go Back")),1)])),_:1},8,["to"])])])):v("",!0),"TIMEOUT"===d(Pe)?(i(),y("div",fe,[m("div",pe,[h(L,{size:"2xl",shape:"full",color:"danger"},{default:u((()=>[h(l,{name:"line-md:sunny-filled-loop-to-moon-alt-filled-loop-transition",class:"h-12 w-12"})])),_:1}),m("h1",he,f(t.$t("Transaction Timeout")),1),m("p",null,f(t.$t("We're sorry to inform you that your transaction has timed out. This may be due to inactivity or an issue with your payment method. Please double-check that the information you entered is correct and try again. If you continue to experience difficulties, please contact our customer support team for assistance"))+". ",1),h(D,{to:`/user/${e.flutter?"flutter/":""}wallets/spot/${d(ve).toLowerCase()}`},{default:u((()=>[h(l,{name:"lucide:arrow-left",class:"h-3 w-3"}),m("span",null,f(t.$t("Go Back")),1)])),_:1},8,["to"])])])):v("",!0)])):v("",!0)])),_:1})}}});export{me as _};
