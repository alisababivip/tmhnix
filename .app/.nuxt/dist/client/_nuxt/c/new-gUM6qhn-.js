import{_ as e}from"./BaseAvatar.vue-XYSxxLJP.js";import{d as a,a as t,c as s,ad as l,ac as n,r as u,E as r,b as i,f as o,e as c,w as d,F as m,B as p,u as x,W as f,_ as v,g,C as h,Y as b,o as w,t as y,q as _,O as k,p as j,k as P,x as B,X as z}from"../e/entry-8qgg5CL-.js";import{_ as I}from"./BaseRadioHeadless.vue-ZJY_gl7l.js";import{_ as T}from"./BaseTag.vue-NMkN1Uk8.js";import{_ as V}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as $}from"./BaseInput.vue-iInHQMIA.js";import{u as A}from"./useForex-v_V55_1y.js";import{u as S}from"./investment-78egZz0k.js";import{u as F}from"./account-JB-kYMyf.js";import"./input-id-wZ-Ta08j.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./use-text-value-9iwzs_EA.js";const E=a({id:"forexPlan",state:()=>({plans:[],loading:!1,selectedPlan:null}),getters:{getPlanById:e=>a=>e.plans.find((e=>e.id===a))},actions:{async fetchForexPlans(){this.loading=!0;try{const{getForexPlans:e}=A(),a=await e();this.plans=a.data.result}catch(e){console.error("Error fetching deposit plans:",e)}this.loading=!1},async selectPlan(e){this.selectedPlan=e},async selectPlanById(e){this.selectedPlan=this.plans.find((a=>a.id===e))||null}}}),C={class:"mb-8 flex flex-col justify-between md:flex-row md:items-center"},L={class:"ltablet:max-w-full flex max-w-[425px] flex-col items-center gap-4 text-center md:flex-row md:text-left lg:max-w-full"},U={class:"text-muted-500"},Y={class:"mt-4 flex items-center justify-center gap-2 md:mt-0 md:justify-start"},D={class:"dark:border-muted-800 mb-10 grid gap-4 pb-10 md:grid-cols-2 xl:gap-8"},M={class:"flex flex-col gap-3"},N={class:"child border-muted-200 dark:border-muted-700 dark:bg-muted-800 absolute end-3 top-3 flex h-7 w-7 items-center justify-center rounded-full border bg-white opacity-0"},O={class:"flex items-center justify-start gap-5"},X=["src"],q={class:"flex gap-12"},H=["src"],R={class:"space-y-4"},W={class:"px-5"},G={class:"flex justify-between items-start"},J={class:"font-sans text-xs px-5"},K={class:"flex items-center gap-2 text-success-500"},Q={class:"text-muted-400"},Z={class:"text-gray-800 dark:text-gray-200"},ee={class:"flex items-center gap-2 text-success-500"},ae={class:"text-muted-400"},te={class:"text-gray-800 dark:text-gray-200"},se={class:"border-t pt-2 border-gray-200 dark:border-gray-700 space-y-2 p-5"},le={class:"flex justify-between items-center text-xs pt-2"},ne={class:"text-muted-800 dark:text-muted-200"},ue={class:"text-muted-800 dark:text-muted-200 items-center flex gap-1"},re=t({__name:"new",setup(a){const t=E(),re=S(),ie=F(),oe=s((()=>ie.accounts.LIVE)),{createInvestment:ce}=A(),{toast:de}=l(),me=n(),pe=u(),xe=u(!1),fe=u(re.investment?.plan?.name||""),ve=u(null);r((async()=>{0===ie.accounts?.length&&await ie.fetchAccounts(),0===t.plans.length&&await t.fetchForexPlans(),0===t.plans.length&&(me.push("/user/forex/invest"),de.dangerText("No investment plan available, please check back later")),ge.value.length>0&&(fe.value=ge.value[0].name),re.investment||await re.fetchInvestment()}));const ge=s((()=>t.plans.filter((e=>e.status)))),he=s((()=>ge.value.find((e=>e.name===fe.value)))),be=async()=>{if(he.value)if(pe.value)if(pe.value<he.value.min_amount)de.dangerText("Amount is less than minimum amount");else if(pe.value>he.value.max_amount)de.dangerText("Amount is greater than maximum amount");else if(oe.value)if(pe.value>oe.value?.balance)de.dangerText("Insufficient balance");else{xe.value=!0;try{const e=await ce(oe.value?.account_id,he.value?.id,ve.value?.value,pe.value);de.response(e),"success"===e.status&&(re.investment=e.data.result,await ie.fetchAccounts(),me.push("/user/forex/invest"))}catch(e){de.danger(e)}xe.value=!1}else de.dangerText("You don't have a live account, please create one to continue");else de.dangerText("Please enter amount");else de.dangerText("Please select a plan")};return(a,t)=>{const s=e,l=v,n=g,u=B,r=z,A=h,S=b,F=I,E=T,re=V,ie=$;return w(),i("form",{action:"",method:"POST",onSubmit:t[3]||(t[3]=f((()=>{}),["prevent"])),class:"mx-auto w-full max-w-4xl pb-16"},[o("div",C,[o("div",L,[c(s,{src:"/img/illustrations/wizard/finish.svg",size:"xl"}),o("div",null,[c(l,{as:"h2",size:"xl",weight:"light",lead:"tight",class:"text-muted-800 dark:text-white"},{default:d((()=>[o("span",null,y(a.$t("Select a plan")),1)])),_:1}),c(n,null,{default:d((()=>[o("span",U,y(a.$t("Select a plan that works for you. You can always change your plan later"))+". ",1)])),_:1})])]),o("div",Y,[c(A,{to:"/user/forex/invest"},{default:d((()=>[c(r,{type:"submit",color:"muted"},{default:d((()=>[c(u,{name:"line-md:arrow-small-left",class:"h-5 w-5 text-current mr-2"}),_(" "+y(a.$t("Back")),1)])),_:1})])),_:1})])]),o("div",D,[o("div",M,[(w(!0),i(m,null,p(x(ge),(e=>(w(),k(F,{modelValue:x(fe),"onUpdate:modelValue":t[0]||(t[0]=e=>j(fe)?fe.value=e:null),name:"radio_custom",value:e.name},{default:d((()=>[c(S,{shape:"rounded",class:"text-muted-400/50 peer-checked:!border-success-500 peer-checked:text-success-500 group relative text-center peer-checked:[&_.child]:!opacity-100"},{default:d((()=>[o("div",N,[c(u,{name:"lucide:check",class:"h-3 w-3 text-current"})]),o("div",O,[o("img",{src:e?.image||"/img/placeholder.png",loading:"lazy",class:"rounded-l w-16 h-16 object-cover"},null,8,X),c(l,{as:"h4",size:"sm",weight:"medium",class:"text-muted-800 dark:text-white"},{default:d((()=>[_(y(e.title),1)])),_:2},1024)])])),_:2},1024)])),_:2},1032,["modelValue","value"])))),256))]),o("div",null,[c(S,{shape:"rounded"},{default:d((()=>[o("div",q,[o("img",{src:x(he)?.image||"/img/placeholder.png",loading:"lazy",class:"w-full mb-4 rounded-t-lg h-64 object-cover"},null,8,H)]),o("div",R,[o("div",W,[o("div",G,[o("div",null,[c(n,{size:"xl"},{default:d((()=>[_(y(x(he)?.title),1)])),_:1}),c(n,{size:"sm",lead:"tight",class:"text-muted-500 dark:text-muted-400"},{default:d((()=>[_(y(x(he)?.description),1)])),_:1})]),x(he)?.trending?P("",!0):(w(),k(E,{key:0,color:"primary",size:"sm",class:"text-muted-500 dark:text-muted-400"},{default:d((()=>[_("Trending")])),_:1}))])]),o("div",J,[o("div",null,[o("ul",null,[o("li",K,[c(u,{name:"fluent:chevron-right-12-filled",class:"h-3 w-3 text-current"}),o("span",Q,[_(y(a.$t("Minimum Amount"))+": ",1),o("span",Z,y(x(he)?.min_amount),1)])]),o("li",ee,[c(u,{name:"fluent:chevron-right-12-filled",class:"h-3 w-3 text-current"}),o("span",ae,[_(y(a.$t("Maximum Amount"))+": ",1),o("span",te,y(x(he)?.max_amount),1)])])])])]),o("div",se,[c(re,{class:"z-40",modelValue:x(ve),"onUpdate:modelValue":t[1]||(t[1]=e=>j(ve)?ve.value=e:null),label:"Duration",items:x(he)?.forex_plan_duration?.length>0?x(he)?.forex_plan_duration?.map((e=>({label:`${e.duration.duration} ${e.duration.timeframe.toLowerCase()}`,value:e.duration.id}))):[{label:"No duration available",value:null}],properties:{label:"label",value:"value"},placeholder:"Select a duration",shape:"rounded"},null,8,["modelValue","items"]),c(ie,{modelValue:x(pe),"onUpdate:modelValue":t[2]||(t[2]=e=>j(pe)?pe.value=e:null),type:"number",label:"Amount",placeholder:"Enter amount",shape:"rounded",class:"w-full",min:x(he)?.min_amount,max:x(he)?.max_amount,autocomplete:"off"},null,8,["modelValue","min","max"]),o("div",le,[o("span",ne,y(a.$t("Balance")),1),o("span",ue,[_(y(x(oe)?.balance||0)+" ",1),x(oe)?.account_id?(w(),k(A,{key:0,to:`/user/forex/${x(oe)?.account_id}/deposit`,"data-nui-tooltip":"Deposit"},{default:d((()=>[c(u,{name:"ei:plus",class:"h-5 w-5 text-success-500"})])),_:1},8,["to"])):P("",!0)])]),c(r,{type:"submit",color:"success",onClick:be,disabled:x(xe),class:"px-4 py-2 bg-success-500 text-white rounded hover:bg-success-600 w-full"},{default:d((()=>[_(y(a.$t("Start Investing")),1)])),_:1},8,["disabled"])])])])),_:1})])])],32)}}});export{re as default};
