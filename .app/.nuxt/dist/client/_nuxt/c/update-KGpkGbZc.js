import{a as e,r as a,at as s,ad as t,E as l,b as u,u as c,F as n,f as o,e as r,w as i,t as d,O as p,_ as v,Y as y,o as f,q as m,p as x,k as g,x as h,X as w}from"../e/entry-8qgg5CL-.js";import{_}from"./BaseIconBox.vue-qjQCKz6R.js";import{_ as b}from"./BaseInput.vue-iInHQMIA.js";import{_ as k}from"./BaseMessage.vue-Kpn2u5Rn.js";import{_ as j}from"./TairoContentWrapper.vue-JqAKR4O_.js";import"./input-id-wZ-Ta08j.js";const V={key:0,class:"h-[calc(80vh)] flex justify-center items-center"},$={class:"my-auto text-center flex-col justify-center space-y-5"},U={class:"text-2xl font-bold"},C={key:1,class:"mx-auto w-full max-w-5xl flex-col px-4 text-start"},E={class:"mt-8"},L={key:0,class:"h-[calc(80vh)] flex justify-center items-center"},P={class:"my-auto text-center flex-col justify-center space-y-5"},B={class:"text-2xl font-bold"},M={class:"text-start mx-auto max-w-2xl space-y-5 mb-20"},T={key:1,class:"space-y-5"},z={class:"text-gray-800 dark:text-gray-200 font-semibold text-lg"},H=["innerHTML"],I=e({__name:"update",setup(e){const I=a({status:!1,message:"",changelog:null,update_id:"",version:""}),q=a(""),A=a(""),F=a(""),N=a("bicrypto"),O=a(""),W=a(!1),X=a(!1),Y=a(!1),{activateLicense:D,checkUpdate:G,downloadUpdate:J,getProduct:K,verifyLicense:Q}=s(),R=a(!1),{toast:S}=t(),Z=async()=>{try{const e=await J(F.value,I.value.update_id,I.value.version,N.value);O.value=I.value.version,S.response(e),await ee()}catch(e){S.danger(e)}},ee=async()=>{R.value=!0;try{const e=await G(F.value,O.value);I.value=e.data.result,I.value.message=e.data.message}catch(e){S.danger(e)}R.value=!1};l((async()=>{const e=await K(N.value);F.value=e.data.result.id,O.value=e.data.result.version,await ae()}));const ae=async()=>{Y.value=!0;try{const e=await Q(F.value);W.value="success"===e.status,await ee()}catch(e){S.danger(e)}Y.value=!1};return(e,a)=>{const s=h,t=_,l=v,N=b,O=w,G=y,J=k,K=j;return f(),u("div",null,[c(W)?(f(),u(n,{key:1},[c(R)?(f(),u("div",L,[o("div",P,[r(t,{size:"2xl",shape:"full",color:"info"},{default:i((()=>[r(s,{name:"svg-spinners:blocks-shuffle-3",class:"h-12 w-12"})])),_:1}),o("h1",B,d(e.$t("Checking for updates"))+"... ",1),o("p",null,d(e.$t("Please wait while we check for updates"))+".",1)])])):(f(),p(K,{key:1},{default:i((()=>[o("div",M,[c(I).status?(f(),p(J,{key:0,type:"info",icon:""},{default:i((()=>[m(d(e.$t("Please backup your database and script files before upgrading"))+".",1)])),_:1})):g("",!0),r(J,null,{default:i((()=>[m(d(c(I).message),1)])),_:1}),c(I).status?(f(),u("div",T,[r(G,{class:"p-5 space-y-5"},{default:i((()=>[o("span",z,d(e.$t("Update Notes")),1),o("div",{class:"pl-5 post-body changelog text-start",innerHTML:c(I).changelog},null,8,H)])),_:1}),r(O,{onClick:Z,color:"success",class:"w-full",type:"submit",disabled:""===c(I).update_id},{default:i((()=>[m(d("Update"))])),_:1},8,["disabled"])])):g("",!0)])])),_:1}))],64)):(f(),u(n,{key:0},[c(Y)?(f(),u("div",V,[o("div",$,[r(t,{size:"2xl",shape:"full",color:"primary"},{default:i((()=>[r(s,{name:"svg-spinners:blocks-shuffle-3",class:"h-12 w-12"})])),_:1}),o("h1",U,d(e.$t("Verifying your license"))+"... ",1),o("p",null,d(e.$t("Please wait while we verify your license"))+".",1)])])):(f(),u("div",C,[r(l,{class:"text-center"},{default:i((()=>[m(d(e.$t("Verify your license")),1)])),_:1}),r(G,{class:"mt-8 p-5 max-w-md mx-auto space-y-5"},{default:i((()=>[r(N,{modelValue:c(q),"onUpdate:modelValue":a[0]||(a[0]=e=>x(q)?q.value=e:null),type:"text",label:"Purchase Code",placeholder:"Enter your purchase code"},null,8,["modelValue"]),r(N,{modelValue:c(A),"onUpdate:modelValue":a[1]||(a[1]=e=>x(A)?A.value=e:null),type:"text",label:"Envato Username",placeholder:"Enter your Envato username"},null,8,["modelValue"]),o("div",E,[r(O,{color:"primary",class:"w-full",onClick:a[2]||(a[2]=e=>(async()=>{X.value=!0;try{const e=await D(F.value,q.value,A.value);W.value="success"===e.status,S.response(e)}catch(e){S.danger(e)}X.value=!1})()),disabled:c(X),loading:c(X)},{default:i((()=>[o("span",null,d(e.$t("Activate License")),1)])),_:1},8,["disabled","loading"])])])),_:1})]))],64))])}}});export{I as default};
