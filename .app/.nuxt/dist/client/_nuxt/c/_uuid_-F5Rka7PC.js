import{a as e,c as a,ad as t,r as s,z as l,ac as n,E as u,b as o,e as r,w as i,u as c,an as d,o as m,f as p,t as v,q as f,F as x,B as b,k as g,O as h,_ as y,x as j,X as w,Y as T,ao as N}from"../e/entry-8qgg5CL-.js";import{_ as B,a as k,b as _}from"./Transactions.vue-zBG-Mjsv.js";import{_ as E}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{_ as C}from"./BaseInput.vue-iInHQMIA.js";import{u as F}from"./useWallet-8iHzU2hV.js";import{u as A}from"./currency-9FjTf2Bf.js";import{z as D,u as I,t as $,F as O}from"./vee-validate.esm-n59zZCC5.js";import"./AddonApexcharts.vue-7Mw5ynfb.js";import"./client-only-nGApKnAn.js";import"./BaseSelect.vue-p0KYznCX.js";import"./input-id-wZ-Ta08j.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./FlexTableRow.vue-LmGXINIn.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./FlexTableCell.vue-Rbj2Whgl.js";import"./BaseTag.vue-NMkN1Uk8.js";import"./TairoButtonIcon.vue-KqKLsAHm.js";import"./TairoFlexTable-zdoraqRc.js";import"./BasePagination.vue-eKZkqxB7.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";import"./strings-rQgUKePI.js";import"./useExchange-VMAYQu3P.js";const P={class:"relative"},S={class:"flex flex-col gap-6 md:pb-20"},M={class:"grid gap-5 grid-cols-12"},R={class:"mb-4 flex items-center justify-between"},W={class:"text-xs flex gap-5 justify-between"},G={class:"text-info-500"},z={class:"flex w-full items-center justify-between p-4 md:p-6"},U={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},V={class:"p-4 md:p-6"},L={class:"mx-auto w-full text-start"},q={class:"font-heading text-muted-800 text-lg font-medium leading-6 dark:text-white"},H={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},X={class:"flex flex-col gap-3"},Y=e({__name:"[uuid]",setup(e){const Y=D.object({amount:D.number().min(1e-8,"Amount must be greater than 0")}),J=$(Y),K=a((()=>({amount:0}))),{handleSubmit:Q,isSubmitting:Z}=I({validationSchema:J,initialValues:K}),{adminGetWallet:ee,updateBalance:ae}=F(),te=A(),se=a((()=>te.currencies)),le=a((()=>se.value.find((e=>e.currency===oe.value?.currency)))),{countDecimals:ne}=t(),ue=a((()=>Math.abs(Number(ne(Number(le.value?.precision)))||8))),oe=s(null),re=a((()=>{if(!oe.value)return 0;return oe.value.transactions.filter((e=>!("DEPOSIT"!==e.type&&"INCOMING_TRANSFER"!==e.type||"COMPLETED"!==e.status&&"PENDING"!==e.status))).reduce(((e,a)=>e+a.amount),0)})),ie=a((()=>{if(!oe.value)return 0;return oe.value.transactions.filter((e=>!("WITHDRAW"!==e.type&&"OUTGOING_TRANSFER"!==e.type||"COMPLETED"!==e.status&&"PENDING"!==e.status))).reduce(((e,a)=>e+a.amount),0)})),ce=l(),de=n();u((async()=>{try{const e=await ee(ce.params.uuid);"success"===e.status?oe.value=e.data.result:(me.danger(e),de.back())}catch(e){console.log(e)}}));const{toast:me}=t(),pe=Q((async e=>{if(oe.value){try{const a=await ae(oe.value.uuid,"ADD",e.amount);me.response(a),"success"===a.status&&(oe.value=a.data.result)}catch(a){console.log(a.message),me.danger(a)}fe.value=!1}})),ve=Q((async e=>{if(oe.value){try{const a=await ae(oe.value.uuid,"SUBTRACT",e.amount);oe.value=a.data.result,me.response(a)}catch(a){console.log(a.message),me.danger(a)}fe.value=!1}})),fe=s(!1),xe=()=>{fe.value=!0};return(e,a)=>{const t=y,s=j,l=w,n=T,u=B,F=k,A=_,D=E,I=N,$=C,Y=d;return m(),o("div",null,[r(D,null,{left:i((()=>[r(t,{as:"h3",size:"md",weight:"semibold",lead:"tight",class:"text-muted-800 dark:text-white"},{default:i((()=>[p("span",null,v(c(oe)?.currency)+" "+v(e.$t("Wallet")),1)])),_:1})])),right:i((()=>[r(l,{color:"muted",onClick:a[0]||(a[0]=e=>c(de).back())},{default:i((()=>[r(s,{name:"line-md:chevron-left",class:"h-4 w-4 mr-2"}),f(" "+v(e.$t("Back")),1)])),_:1})])),default:i((()=>[p("div",P,[p("div",S,[p("div",M,[r(n,{class:"overflow-hidden p-6 col-span-12 lg:col-span-7",shape:"curved"},{default:i((()=>[p("div",R,[r(t,{as:"h4",size:"md",weight:"semibold",lead:"tight",class:"text-muted-800 dark:text-white"},{default:i((()=>[p("span",null,v("ECO"!==c(oe)?.type?e.$t("Details"):e.$t("Chain Details")),1)])),_:1}),r(l,{color:"primary",onClick:xe,size:"sm"},{default:i((()=>[f(v(e.$t("Modify Balance")),1)])),_:1})]),p("div",null,["ECO"===c(oe)?.type?(m(!0),o(x,{key:0},b(c(oe)?.addresses,((e,a,t)=>(m(),o("div",null,[p("div",W,[p("span",null,[p("span",G,v(a),1),f(": "+v(e.address),1)]),p("span",null,v(e.balance),1)])])))),256)):g("",!0)])])),_:1}),c(oe)?(m(),h(u,{class:"overflow-hidden p-6 col-span-12 lg:col-span-5",key:c(oe).transactions.length,balance:Number(c(oe).balance).toFixed(Number(c(ue))),currency:c(oe).currency,uuid:c(oe).uuid,income:Number(c(re)).toFixed(Number(c(ue))),expenses:Number(c(ie)).toFixed(Number(c(ue))),incomeText:"Income",expensesText:"Expenses",uuidFormated:!1},null,8,["balance","currency","uuid","income","expenses"])):g("",!0)]),c(oe)?(m(),h(F,{key:c(oe).transactions.length,incomeText:"Income",expensesText:"Expenses",income:Number(c(re)).toFixed(Number(c(ue))),expenses:Number(c(ie)).toFixed(Number(c(ue))),wallet:c(oe)},null,8,["income","expenses","wallet"])):g("",!0),c(oe)?(m(),h(A,{key:c(oe).transactions.length,precision:c(ue),wallet:c(oe),viewPath:"/admin/finance/log"},null,8,["precision","wallet"])):g("",!0)])])])),_:1}),r(Y,{open:c(fe),size:"sm",onClose:a[4]||(a[4]=e=>fe.value=!1)},{header:i((()=>[p("div",z,[p("h3",U,v(e.$t("Modify Wallet Balance")),1),r(I,{onClick:a[1]||(a[1]=e=>fe.value=!1)})])])),default:i((()=>[p("div",V,[p("div",L,[p("h3",q,v(e.$t("Enter Amount")),1),p("p",H,v(e.$t("Please enter the amount you want to add or subtract from the wallet balance"))+". ",1),p("div",X,[r(c(O),{name:"amount"},{default:i((({field:e,errorMessage:a,handleChange:t,handleBlur:s})=>[r($,{"model-value":e.value,error:a,disabled:c(Z),label:"Amount",type:"number",placeholder:"Enter amount","onUpdate:modelValue":t,onBlur:s},null,8,["model-value","error","disabled","onUpdate:modelValue","onBlur"])])),_:1}),r(l,{color:"primary",onClick:a[2]||(a[2]=e=>c(pe)())},{default:i((()=>[f(v(e.$t("Add Balance")),1)])),_:1}),r(l,{color:"danger",onClick:a[3]||(a[3]=e=>c(ve)())},{default:i((()=>[f(v(e.$t("Subtract Balance")),1)])),_:1})])])])])),_:1},8,["open"])])}}});export{Y as default};
