import{a as e,ad as a,ac as l,z as r,c as s,ap as t,Q as o,E as n,J as u,O as d,w as i,o as m,u as p,q as c,t as h,e as f,f as g,_ as y,x as v,X as b,Y as B}from"../e/entry-8qgg5CL-.js";import{_ as V}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_}from"./BaseInput.vue-iInHQMIA.js";import{_ as k}from"./BaseTextarea.vue-8st5U0qk.js";import{_ as C}from"./TairoFormSave.vue-aLVbwikq.js";import{_ as x}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as E}from"./useStaking-1DgbeL2_.js";import{u as S}from"./currency-9FjTf2Bf.js";import{z as w,u as j,t as P,F as U}from"./vee-validate.esm-n59zZCC5.js";import{u as T}from"./admin-Nwh6nXjV.js";import{u as M}from"./pools-MsQdbYRA.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";import"./input-id-wZ-Ta08j.js";import"./useExchange-VMAYQu3P.js";import"./useEcosystem-9eBUNbsT.js";const I={class:"grid gap-5 grid-cols-1 sm:grid-cols-2"},A=g("small",null,[g("span",{class:"text-warning-500 text-xs"},"Capital letters only, e.g. BSC, ETH, etc. ")],-1),O=e({__name:"[id]",setup(e){const{toast:O}=a(),N=l(),{id:$}=r().params,q=M(),{updateAdminStakingPool:F}=E(),D=s((()=>q.selectedPool||q.getPoolById($))),L=t(),W=s((()=>L.extensions)),z=s((()=>W.value?.find((e=>"ecosystem"===e.name)))),J=o(),Q=s((()=>J.settings)),H=S(),X=s((()=>H.currencies)),Y=T(),G=s((()=>Y.tokens)),K=[];n((async()=>{const e=Number($);0===q.pools.length&&await q.fetchStakingPools(),await q.selectPoolById(e),0===L.extensions.length&&await L.fetchExtensions(),Q.value?.spot_exchange&&(K.push("SPOT"),0===H.currencies.length&&await H.fetchCurrencies()),z.value?.status&&(K.push("ECO"),0===Y.tokens.length&&await Y.fetchTokensAll()),re()}));const R=s((()=>{let e=[];"SPOT"===te.type?e=X.value.map((e=>e.currency)):"ECO"===te.type&&(e=G.value.map((e=>e.currency)));return[...new Set(e)]})),Z=w.object({name:w.string().nonempty("Name is required"),description:w.string().nullable(),currency:w.string().nonempty("Currency is required"),chain:w.string().nonempty("Chain is required"),type:w.enum(K),min_stake:w.number().min(0,"Min stake must be greater than 0"),max_stake:w.number().min(0,"Max stake must be greater than 0"),status:w.enum(["ACTIVE","INACTIVE","COMPLETED"])}),ee=s((()=>({...D.value}))),{handleSubmit:ae,isSubmitting:le,resetForm:re,setFieldValue:se,values:te}=j({validationSchema:P(Z),initialValues:ee});u((()=>te.type),(e=>{e&&se("currency","")}));const oe=ae((async e=>{try{const a=await F(Number($),e.name,e.description,e.currency,e.chain,e.type,e.min_stake,e.max_stake,e.status);O.response(a),"success"===a.status&&(await q.fetchStakingPools(),N.push("/admin/extensions/staking/pools"))}catch(a){O.danger(a)}}));return(e,a)=>{const l=y,r=v,s=b,t=V,o=_,n=k,u=B,E=C,S=x;return m(),d(S,null,{left:i((()=>[(m(),d(l,{size:"lg",key:p(D)?.name},{default:i((()=>[c(h(e.$t(`\n        Editing ${p(D)?.name??"Staking Pool"} Pool\n      `)),1)])),_:1}))])),right:i((()=>[f(s,{type:"button",color:"muted",class:"hover:bg-gray-300 dark:hover:bg-gray-800",to:"/admin/extensions/staking/pools"},{default:i((()=>[f(r,{name:"line-md:chevron-left",class:"h-4 w-4 mr-2"}),c(" "+h(e.$t("Back")),1)])),_:1}),f(s,{type:"submit",color:"primary",disabled:p(le),class:"w-full",onClick:p(oe)},{default:i((()=>[c(h(e.$t("Update Pool")),1)])),_:1},8,["disabled","onClick"])])),default:i((()=>[g("form",{onSubmit:a[0]||(a[0]=(...e)=>p(oe)&&p(oe)(...e)),class:"space-y-8"},[f(u,{class:"p-5 space-y-5"},{default:i((()=>[g("div",I,[f(p(U),{name:"type"},{default:i((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[f(t,{"model-value":e.value,error:a,items:K,label:"Purchase Wallet Type",placeholder:"Select wallet type",shape:"rounded","onUpdate:modelValue":l,onBlur:r},null,8,["model-value","error","onUpdate:modelValue","onBlur"])])),_:1}),f(p(U),{name:"currency"},{default:i((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[f(t,{"model-value":e.value,error:a,items:p(R),label:"Purchase Currency",placeholder:"Select purchase currency",disabled:!p(te)?.type||""===p(te)?.type,"onUpdate:modelValue":l,onBlur:r},null,8,["model-value","error","items","disabled","onUpdate:modelValue","onBlur"])])),_:1}),f(p(U),{name:"name"},{default:i((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[f(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:p(le),type:"text",label:"Name",placeholder:"Enter name",shape:"rounded",class:"w-full",onBlur:r},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),g("div",null,[f(p(U),{name:"chain"},{default:i((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[f(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:p(le),type:"text",label:"Pool Chain",placeholder:"Enter chain",shape:"rounded",class:"w-full",onBlur:r},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"]),A])),_:1})]),f(p(U),{name:"status"},{default:i((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[f(t,{"model-value":e.value,error:a,items:["ACTIVE","INACTIVE","COMPLETED"],placeholder:"Select a status",label:"Status",shape:"rounded","onUpdate:modelValue":l,onBlur:r},null,8,["model-value","error","onUpdate:modelValue","onBlur"])])),_:1}),f(p(U),{name:"min_stake"},{default:i((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[f(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:p(le),type:"number",label:"Min Stake",placeholder:"Enter min stake",shape:"rounded",class:"w-full",onBlur:r},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),f(p(U),{name:"max_stake"},{default:i((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[f(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:p(le),type:"number",label:"Max Stake",placeholder:"Enter max stake",shape:"rounded",class:"w-full",onBlur:r},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})]),f(p(U),{name:"description"},{default:i((({field:e,errorMessage:a,handleChange:l,handleBlur:r})=>[f(n,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,label:"Description",shape:"rounded",placeholder:"Write a description",class:"w-full",onBlur:r},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1})])),_:1}),f(E,null,{default:i((()=>[f(s,{type:"submit",color:"primary",disabled:p(le),class:"w-full"},{default:i((()=>[c(h(e.$t("Update Pool")),1)])),_:1},8,["disabled"])])),_:1})],32)])),_:1})}}});export{O as default};
