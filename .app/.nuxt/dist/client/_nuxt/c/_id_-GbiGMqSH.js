import{a as e,ad as r,ac as a,z as t,c as o,E as s,r as l,J as d,O as n,w as i,o as u,u as m,q as c,t as p,e as f,f as b,p as v,W as h,b as g,A as y,F as x,B as w,n as j,k,_,x as B,X as V,Y as C}from"../e/entry-8qgg5CL-.js";import{_ as P}from"./BaseInput.vue-iInHQMIA.js";import{_ as I}from"./BaseProgress.vue-xH0Mhn3Z.js";import{_ as U}from"./BaseInputFileHeadless.vue-LOgyN9kF.js";import{_ as D}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as E}from"./BaseTextarea.vue-8st5U0qk.js";import{_ as S}from"./TairoFormSave.vue-aLVbwikq.js";import{_ as N}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as T}from"./useIco-3A31FykS.js";import{u as $}from"./fetch-i3Y1jjTS.js";import{b as W}from"./strings-rQgUKePI.js";import{_ as F}from"./placeholder-file-IxKzOaSl.js";import{z as L,u as M,t as A,F as q}from"./vee-validate.esm-n59zZCC5.js";import{u as z}from"./projects-GkXQIzMj.js";import"./input-id-wZ-Ta08j.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";const O={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},R={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},G=["onDrop"],J=["onClick","onKeydown"],K={class:"p-5 text-center"},H={class:"text-muted-400 font-sans text-sm"},Q={class:"text-muted-400 font-sans text-[0.7rem] font-semibold uppercase"},X={for:"file",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 cursor-pointer font-sans text-sm underline underline-offset-4 transition-colors duration-300"},Y={key:1,class:"mt-6 space-y-2"},Z={class:"border-muted-200 dark:border-muted-700 dark:bg-muted-800 relative flex items-center justify-end gap-2 rounded-xl border bg-white p-3"},ee={class:"flex items-center gap-2"},re={class:"shrink-0"},ae=["src"],te={key:1,class:"h-14 w-14 rounded-xl object-cover object-center",src:F,alt:"Image preview"},oe={class:"font-sans"},se={class:"text-muted-800 dark:text-muted-100 line-clamp-1 block text-sm"},le={class:"text-muted-400 block text-xs"},de={class:"flex gap-2"},ne={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300 disabled:cursor-not-allowed disabled:opacity-60",disabled:"",type:"button",tooltip:"Cancel"},ie=b("span",{class:"sr-only"},"Cancel",-1),ue={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Upload"},me=b("span",{class:"sr-only"},"Upload",-1),ce=["onClick"],pe=b("span",{class:"sr-only"},"Remove",-1),fe={key:0,class:"mb-4 h-36 w-full flex items-center justify-center overflow-hidden rounded-xl"},be=["src"],ve=e({__name:"[id]",setup(e){const{toast:F}=r(),ve=a(),{id:he}=t().params,ge=z(),{updateIcoProject:ye}=T(),xe=o((()=>ge.selectedProject||ge.getProjectById(he)));s((async()=>{const e=Number(he);0===ge.projects.length&&await ge.fetchIcoProjects(),await ge.selectProjectById(e),Ce.value=xe.value?.image||null}));const we=L.object({name:L.string().nonempty("Name is required"),description:L.string().nonempty("Description is required"),website:L.string().nonempty("Website is required"),whitepaper:L.string().nonempty("Whitepaper is required"),status:L.enum(["PENDING","ACTIVE","COMPLETED","CANCELLED"])}),je=o((()=>({...xe.value}))),{handleSubmit:ke,isSubmitting:_e,errors:Be}=M({validationSchema:A(we),initialValues:je}),Ve=l(null),Ce=l(xe.value?.image||null);d(Ve,(e=>{const r=e?.item(0)||null;if(Ve.value){const e=new FileReader;e.onload=e=>{Ce.value=e.target?.result},e.readAsDataURL(r)}}));const Pe=ke((async e=>{try{let r={...e,image:Ce.value??""};if(Ve.value){const e=new FormData;e.append("files",Ve.value[0]),e.append("type","icoProject");const a=await $("/api/upload",{method:"POST",body:e},"$MGUTQbkxD6");a&&""!==a.data.value&&(r.image=a.data.value[0])}const a=await ye(Number(he),r.name,r.description,r.website,r.whitepaper,r.image,r.status);F.response(a),"success"===a.status&&(await ge.fetchIcoProjects(),ve.push("/admin/extensions/ico/projects"))}catch(r){F.danger(r)}}));return(e,r)=>{const a=_,t=B,o=V,s=P,l=C,d=I,T=U,$=D,F=E,L=S,M=N;return u(),n(M,null,{left:i((()=>[(u(),n(a,{size:"lg",key:m(xe)?.name},{default:i((()=>[c(p(e.$t(`\n        Editing ${m(xe)?.name??"ICO Project"} Project\n      `)),1)])),_:1}))])),right:i((()=>[f(o,{type:"button",color:"muted",class:"hover:bg-gray-300 dark:hover:bg-gray-800",to:"/admin/extensions/ico/projects"},{default:i((()=>[f(t,{name:"line-md:chevron-left",class:"h-4 w-4 mr-2"}),c(" "+p(e.$t("Back")),1)])),_:1}),f(o,{type:"submit",color:"primary",disabled:m(_e),class:"w-full",onClick:m(Pe)},{default:i((()=>[c(p(e.$t("Update Project")),1)])),_:1},8,["disabled","onClick"])])),default:i((()=>[b("form",{onSubmit:r[3]||(r[3]=(...e)=>m(Pe)&&m(Pe)(...e)),class:"space-y-8"},[b("div",O,[f(l,{class:"p-5 space-y-5"},{default:i((()=>[f(m(q),{name:"name"},{default:i((({field:e,errorMessage:r,handleChange:a,handleBlur:t})=>[f(s,{modelValue:e.value,"onUpdate:modelValue":[r=>e.value=r,a],error:r,disabled:m(_e),type:"text",label:"Name",placeholder:"Enter name",shape:"rounded",class:"w-full",onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),f(m(q),{name:"website"},{default:i((({field:e,errorMessage:r,handleChange:a,handleBlur:t})=>[f(s,{modelValue:e.value,"onUpdate:modelValue":[r=>e.value=r,a],error:r,disabled:m(_e),type:"text",label:"Website",placeholder:"Enter website",shape:"rounded",class:"w-full",onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})])),_:1}),f(l,{class:"p-5"},{default:i((()=>[b("div",R,[f(T,{modelValue:m(Ve),"onUpdate:modelValue":r[2]||(r[2]=e=>v(Ve)?Ve.value=e:null)},{default:i((({open:a,remove:o,preview:s,drop:l,files:n})=>[b("div",{class:"",onDragenter:r[0]||(r[0]=h((()=>{}),["stop","prevent"])),onDragover:r[1]||(r[1]=h((()=>{}),["stop","prevent"])),onDrop:l},[n?.length?(u(),g("ul",Y,[(u(!0),g(x,null,w(n,(r=>(u(),g("li",{key:r.name},[b("div",Z,[b("div",ee,[b("div",re,[r.type.startsWith("image")?(u(),g("img",{key:0,class:"h-14 w-14 rounded-xl object-cover object-center",src:s(r).value,alt:"Image preview"},null,8,ae)):(u(),g("img",te))]),b("div",oe,[b("span",se,p(r.name),1),b("span",le,p(("formatFileSize"in e?e.formatFileSize:m(W))(r.size)),1)])]),b("div",{class:j(["ms-auto w-32 px-4 transition-opacity duration-300","opacity-100"])},[f(d,{value:0,size:"xs",color:"success"})]),b("div",de,[b("button",ne,[f(t,{name:"lucide:slash",class:"h-4 w-4"}),ie]),b("button",ue,[f(t,{name:"lucide:arrow-up",class:"h-4 w-4"}),me]),b("button",{class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Remove",onClick:h((e=>o(r)),["prevent"])},[f(t,{name:"lucide:x",class:"h-4 w-4"}),pe],8,ce)])])])))),128))])):(u(),g("div",{key:0,class:"nui-focus border-muted-300 dark:border-muted-700 hover:border-muted-400 focus:border-muted-400 dark:hover:border-muted-600 dark:focus:border-muted-700 group cursor-pointer rounded-lg border-[3px] border-dashed transition-colors duration-300",tabindex:"0",role:"button",onClick:a,onKeydown:y(h(a,["prevent"]),["enter"])},[b("div",K,[f(t,{name:"mdi-light:cloud-upload",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 mb-2 h-10 w-10 transition-colors duration-300"}),b("h4",H,p(e.$t("Drop file to upload")),1),b("div",null,[b("span",Q,p(e.$t("Or")),1)]),b("label",X,p(e.$t("Select Image")),1)])],40,J))],40,G)])),_:1},8,["modelValue"]),m(Ce)?(u(),g("div",fe,[b("img",{src:m(Ce),alt:"Image Preview",class:"max-h-full max-w-full object-cover object-center"},null,8,be)])):k("",!0)])])),_:1})]),f(l,{class:"p-5"},{default:i((()=>[f(m(q),{name:"status"},{default:i((({field:e,errorMessage:r,handleChange:a,handleBlur:t})=>[f($,{"model-value":e.value,error:r,items:["PENDING","ACTIVE","COMPLETED","CANCELLED"],placeholder:"Select a status",label:"Status",shape:"rounded","onUpdate:modelValue":a,onBlur:t},null,8,["model-value","error","onUpdate:modelValue","onBlur"])])),_:1})])),_:1}),f(l,{class:"p-5"},{default:i((()=>[f(m(q),{name:"description"},{default:i((({field:e,errorMessage:r,handleChange:a,handleBlur:t})=>[f(F,{modelValue:e.value,"onUpdate:modelValue":[r=>e.value=r,a],error:r,label:"Description",shape:"rounded",placeholder:"Write a description",class:"w-full",onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1})])),_:1}),f(l,{class:"p-5"},{default:i((()=>[f(m(q),{name:"whitepaper"},{default:i((({field:e,errorMessage:r,handleChange:a,handleBlur:t})=>[f(F,{modelValue:e.value,"onUpdate:modelValue":[r=>e.value=r,a],error:r,label:"Whitepaper",shape:"rounded",placeholder:"Write a whitepaper",class:"w-full",onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","onBlur"])])),_:1})])),_:1}),f(L,null,{default:i((()=>[f(o,{type:"submit",color:"primary",disabled:m(_e),class:"w-full"},{default:i((()=>[c(p(e.$t("Update Project")),1)])),_:1},8,["disabled"])])),_:1})],32)])),_:1})}}});export{ve as default};
