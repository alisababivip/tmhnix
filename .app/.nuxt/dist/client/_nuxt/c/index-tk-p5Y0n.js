import{_ as e}from"./BaseInput.vue-iInHQMIA.js";import{_ as a}from"./BaseSelect.vue-p0KYznCX.js";import{d as s,a as t,z as l,r as o,c as r,E as i,ad as u,b as n,e as c,w as d,u as p,an as m,o as w,p as f,f as v,t as h,O as g,F as y,B as b,q as k,k as _,ag as x,ao as j,X as E}from"../e/entry-8qgg5CL-.js";import{_ as P,a as C}from"./FlexTableRow.vue-LmGXINIn.js";import{_ as B}from"./FlexTableCell.vue-Rbj2Whgl.js";import{_ as $,a as I}from"./BaseDropdown.vue-wSpyT9xX.js";import{_ as F}from"./TairoFlexTable-zdoraqRc.js";import{_ as V}from"./BasePagination.vue-eKZkqxB7.js";import{_ as A}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as S}from"./useP2P-NV4dmDWU.js";import{_ as T,a as D}from"./placeholder-search-4-dark-Jht91LnM.js";import"./input-id-wZ-Ta08j.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./menu-KWZreDHB.js";import"./use-text-value-9iwzs_EA.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";const L=s({id:"adminP2PEscrow",state:()=>({escrows:[],loading:!1,selectedEscrow:null}),getters:{getEscrowById:e=>a=>e.escrows.find((e=>e.id===a))},actions:{async fetchP2PEscrows(){this.loading=!0;try{const{getAdminP2PEscrows:e}=S(),a=await e();this.escrows=a.data.result}catch(e){console.error("Error fetching P2P escrows:",e)}this.loading=!1},async removeEscrow(e){const a=this.escrows.findIndex((a=>a.id===e));-1!==a&&this.escrows.splice(a,1)},async selectEscrow(e){this.selectedEscrow=e},async selectEscrowById(e){this.selectedEscrow=this.getEscrowById(e)}}}),U={value:10},q={value:25},z={value:50},N={value:100},O=v("img",{class:"block dark:hidden",src:T,alt:"Placeholder image"},null,-1),R=v("img",{class:"hidden dark:block",src:D,alt:"Placeholder image"},null,-1),W={key:1,class:"w-full"},X={class:"mt-6"},G={class:"flex w-full items-center justify-between p-4 md:p-6"},H={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},J={class:"p-4 md:p-6"},K={class:"mx-auto w-full text-center"},M={class:"font-heading text-muted-800 text-lg font-medium leading-6 dark:text-white"},Q={class:"p-4 md:p-6"},Y={class:"flex gap-x-2"},Z=t({__name:"index",setup(s){const t=L(),{updateAdminP2PEscrow:T}=S(),D=l(),Z=o(""),ee=o(10),ae=r((()=>parseInt(D.query.page??"1"))),se=r((()=>t.escrows.filter((e=>e.status?.toLowerCase().includes(Z.value.toLowerCase()))))),te=r((()=>{const e=(ae.value-1)*ee.value,a=e+ee.value;return se.value.slice(e,a)}));i((async()=>{0===t.escrows.length&&(t.loading=!0,await t.fetchP2PEscrows(),t.loading=!1)}));const{toast:le}=u(),oe=o(!1),re=o(!1),ie=o(null);return(s,l)=>{const o=e,r=a,i=x,u=P,S=B,D=$,L=I,ue=C,ne=F,ce=V,de=A,pe=j,me=E,we=m;return w(),n("div",null,[c(de,null,{left:d((()=>[c(o,{modelValue:p(Z),"onUpdate:modelValue":l[0]||(l[0]=e=>f(Z)?Z.value=e:null),icon:"lucide:search",classes:{wrapper:"w-full sm:w-auto"},placeholder:"Filter escrows..."},null,8,["modelValue"]),c(r,{modelValue:p(ee),"onUpdate:modelValue":l[1]||(l[1]=e=>f(ee)?ee.value=e:null),label:"",classes:{wrapper:"w-full sm:w-40"}},{default:d((()=>[v("option",U,"10 "+h(s.$t("per page")),1),v("option",q,"25 "+h(s.$t("per page")),1),v("option",z,"50 "+h(s.$t("per page")),1),v("option",N,"100 "+h(s.$t("per page")),1)])),_:1},8,["modelValue"])])),default:d((()=>[v("div",null,[p(t).loading||0!==p(te).length?(w(),n("div",W,[c(ne,{class:"pt-5"},{default:d((()=>[(w(!0),n(y,null,b(p(te),((e,a)=>(w(),g(ue,{key:e.id,spaced:""},{start:d((()=>[c(u,{label:"Escrow","hide-label":a>0,title:`ID: ${e.id}`,subtitle:`Amount: ${e.amount}`},null,8,["hide-label","title","subtitle"])])),end:d((()=>[c(S,{label:"Status","hide-label":a>0},{default:d((()=>[k(h(e.status),1)])),_:2},1032,["hide-label"]),c(S,{label:"Actions","hide-label":a>0},{default:d((()=>[c(L,{flavor:"context",label:"Dropdown",orientation:"end"},{default:d((()=>[c(D,{onClick:a=>s.viewEscrowDetails(e),title:"View Details"},null,8,["onClick"]),c(D,{onClick:a=>function(e){ie.value=e,oe.value=!0}(e),title:"Update Status"},null,8,["onClick"])])),_:2},1024)])),_:2},1032,["hide-label"])])),_:2},1024)))),128))])),_:1})])):(w(),g(i,{key:0,title:p(Z)&&""!==p(Z)?"No matching results":"No results",subtitle:p(Z)&&""!==p(Z)?"Looks like we couldn't find any matching results for your search terms. Try other search terms.":"Looks like we don't have any data here yet."},{image:d((()=>[O,R])),_:1},8,["title","subtitle"])),v("div",X,[p(se).length>p(ee)?(w(),g(ce,{key:0,"total-items":p(se).length,"current-page":p(ae),"item-per-page":p(ee)},null,8,["total-items","current-page","item-per-page"])):_("",!0)])])])),_:1}),c(we,{open:p(oe),size:"sm",onClose:l[5]||(l[5]=()=>oe.value=!1)},{header:d((()=>[v("div",G,[v("h3",H,h(s.$t("Update Escrow Status")),1),c(pe,{onClick:l[2]||(l[2]=()=>oe.value=!1)})])])),footer:d((()=>[v("div",Q,[v("div",Y,[c(me,{onClick:l[3]||(l[3]=()=>oe.value=!1)},{default:d((()=>[k(h(s.$t("Cancel")),1)])),_:1}),c(me,{color:"success",flavor:"solid",onClick:l[4]||(l[4]=e=>async function(e){if(ie.value){re.value=!0;try{await T(ie.value.id,e),le.success("Escrow status updated successfully")}catch(a){le.error("Failed to update escrow status")}oe.value=!1,re.value=!1,ie.value=null}}("newStatus")),disabled:p(re),loading:p(re)},{default:d((()=>[k(h(s.$t("Update Status")),1)])),_:1},8,["disabled","loading"])])])])),default:d((()=>[v("div",J,[v("div",K,[v("h3",M,h(s.$t("Are you sure you want to update the status of this escrow?")),1)])])])),_:1},8,["open"])])}}});export{Z as default};
