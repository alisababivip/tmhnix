import{a as e,U as l,Q as s,c as a,ad as t,b as r,f as n,e as i,w as m,W as o,Y as u,av as d,o as v,q as c,t as p,l as y,O as b,u as f,k as g,_ as h,a0 as _,X as B}from"../e/entry-8qgg5CL-.js";import{_ as E}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as I}from"./BaseInput.vue-iInHQMIA.js";import{_ as L,a as w}from"./BaseList.vue-M2vzPMWB.js";import{z as S,u as N,t as U,F as x}from"./vee-validate.esm-n59zZCC5.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";import"./input-id-wZ-Ta08j.js";const j={class:"flex items-center justify-between p-4"},V={class:"flex items-center gap-2"},R={class:"px-8"},A={class:"mx-auto space-y-12 py-8"},C={class:"grid grid-cols-12 gap-4 pt-2"},M={class:"col-span-12 sm:col-span-6"},Y={key:0,class:"col-span-12 sm:col-span-6"},T={key:1,class:"col-span-12 sm:col-span-6"},k={class:"col-span-12 pt-5 border-t border-gray-300 dark:border-gray-700"},D=e({__name:"index",setup(e){const{updateSettings:D}=l(),O=s(),q=a((()=>O.settings)),$=a((()=>q.value?.mlm_system?q.value?.mlm_system:"DIRECT")),{toast:z}=t(),P=S.object({mlm_system:S.enum(["DIRECT","BINARY","UNILEVEL"]),binary:S.object({levels:S.number().min(1).max(7)}).optional().refine((e=>"BINARY"!==G.mlm_system||void 0!==e),{message:"Binary levels are required when 'BINARY' system is selected",path:["binary"]}),unilevel:S.object({levels:S.number().min(1).max(7)}).optional().refine((e=>"UNILEVEL"!==G.mlm_system||void 0!==e),{message:"Unilevel levels are required when 'UNILEVEL' system is selected",path:["unilevel"]})}).refine((e=>"DIRECT"!==e.mlm_system||void 0===e.binary&&void 0===e.unilevel),{message:"No additional settings are needed for 'DIRECT' system",path:["mlm_system"]}),F=U(P),J=a((()=>{const e=q.value.mlm_settings?q.value.mlm_settings:{binary:{levels:3},unilevel:{levels:3}};return{mlm_system:$.value,binary:"BINARY"===$.value?{levels:e.binary.levels}:void 0,unilevel:"UNILEVEL"===$.value?{levels:e.unilevel.levels}:void 0}})),{handleSubmit:Q,isSubmitting:W,meta:X,values:G}=N({validationSchema:F,initialValues:J}),H=Q((async e=>{try{const l={...q.value.mlm_settings},s=(e,l)=>new Array(l).fill(null).map(((l,s)=>{const a=s+1;return e.find((e=>e.level===a))||{level:a,value:0}}));switch(e.mlm_system){case"BINARY":l.binary=l.binary||{},l.binary.levels=e.binary?.levels,l.binary.levels_percentage=s(l.binary.levels_percentage||[],e.binary?.levels);break;case"UNILEVEL":l.unilevel=l.unilevel||{},l.unilevel.levels=e.unilevel?.levels,l.unilevel.levels_percentage=s(l.unilevel.levels_percentage||[],e.unilevel?.levels)}const a=JSON.stringify(l),t=await D({mlm_settings:a,mlm_system:e.mlm_system});z.response(t),"success"===t.status&&O.setSettings(Object.values(t.data.result))}catch(l){z.danger(l)}}));return(e,l)=>{const s=h,a=_,t=B,S=E,N=I,U=L,D=w,O=u,q=d("can");return v(),r("div",null,[n("form",{method:"POST",action:"",class:"w-full pb-16",onSubmit:l[0]||(l[0]=o(((...e)=>f(H)&&f(H)(...e)),["prevent"]))},[i(O,null,{default:m((()=>[n("div",j,[n("div",null,[i(s,{tag:"h2",size:"sm",weight:"medium",lead:"normal",class:"uppercase tracking-wider"},{default:m((()=>[c(p(e.$t("System Settings")),1)])),_:1}),i(a,{size:"xs",class:"text-muted-400"},{default:m((()=>[c(p(e.$t("Configure your mlm system settings")),1)])),_:1})]),n("div",V,[y((v(),b(t,{type:"submit",color:"primary",class:"w-24",disabled:f(W)||!f(X).dirty,loading:f(W)},{default:m((()=>[c(p(e.$t("Save")),1)])),_:1},8,["disabled","loading"])),[[q,"Edit Settings"]])])]),n("div",R,[n("div",A,[n("div",C,[n("div",M,[i(f(x),{name:"mlm_system"},{default:m((({field:e,errorMessage:l,handleChange:s,handleBlur:a})=>[i(S,{"model-value":e.value,error:l,disabled:f(W),items:["DIRECT","BINARY","UNILEVEL"],placeholder:"Select mlm system",label:"System",shape:"rounded","onUpdate:modelValue":s,onBlur:a},null,8,["model-value","error","disabled","onUpdate:modelValue","onBlur"])])),_:1})]),"BINARY"===f(G).mlm_system?(v(),r("div",Y,[i(f(x),{name:"binary.levels"},{default:m((({field:e,errorMessage:l,handleChange:s,handleBlur:a})=>[i(N,{"model-value":e.value,error:l,disabled:f(W),type:"number",min:"2",max:"7",step:"1",placeholder:"Enter binary levels",label:"Levels","onUpdate:modelValue":s,onBlur:a},null,8,["model-value","error","disabled","onUpdate:modelValue","onBlur"])])),_:1})])):g("",!0),"UNILEVEL"===f(G).mlm_system?(v(),r("div",T,[i(f(x),{name:"unilevel.levels"},{default:m((({field:e,errorMessage:l,handleChange:s,handleBlur:a})=>[i(N,{"model-value":e.value,error:l,disabled:f(W),type:"number",min:"2",max:"7",step:"1",placeholder:"Enter unilevel levels",label:"Levels","onUpdate:modelValue":s,onBlur:a},null,8,["model-value","error","disabled","onUpdate:modelValue","onBlur"])])),_:1})])):g("",!0),n("div",k,[i(D,null,{default:m((()=>[i(U,{title:"Direct MLM System",subtitle:"is a single level system where each user is directly connected to the sponsor, and there are no levels in between."}),i(U,{title:"Binary MLM System",subtitle:"is a two level system where each user can have two direct referrals, and each of those referrals can have two direct referrals."}),i(U,{title:"Unilevel MLM System",subtitle:"is a multi level system where each user can have multiple direct referrals, and each of those referrals can have multiple direct referrals."})])),_:1})])])])])])),_:1})],32)])}}});export{D as default};
