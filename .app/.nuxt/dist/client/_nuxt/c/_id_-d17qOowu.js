import{a as e,z as a,ad as l,ac as s,c as t,E as o,O as r,w as d,o as u,e as n,q as i,t as m,u as c,f as p,b as f,B as v,F as h,W as g,_ as b,x as _,X as V,Y as B}from"../e/entry-8qgg5CL-.js";import{_ as y}from"./BaseInput.vue-iInHQMIA.js";import{_ as j}from"./BaseSelect.vue-p0KYznCX.js";import{_ as C}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as U}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as x}from"./useEcommerce-2nLxpPKu.js";import{z as D,u as w,t as E,F as S}from"./vee-validate.esm-n59zZCC5.js";import{u as I}from"./discounts-4CSnF0MZ.js";import"./input-id-wZ-Ta08j.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";const k=["value"],M=e({__name:"[id]",setup(e){const{id:M}=a().params,{toast:P}=l(),A=s(),F=I(),{updateAdminDiscount:N}=x(),T=t((()=>F.selectedDiscount??F.getDiscountById(Number(M))));o((async()=>{0===F.discounts.length&&(F.loading=!0,await F.fetchDiscounts(),F.loading=!1)}));const q=D.object({code:D.string().nonempty("Discount code is required"),percentage:D.number().min(0,"Percentage must be greater than 0").max(100,"Percentage cannot exceed 100"),valid_until:D.date().optional(),product_id:D.number().positive("Product ID is required")}),{handleSubmit:$,isSubmitting:z,values:L,setFieldValue:W,resetForm:O}=w({validationSchema:E(q),initialValues:t((()=>T.value))}),X=$((async e=>{try{const a=await N(Number(M),e.code,e.percentage,e.valid_until,e.product_id);P.response(a),"success"===a.status&&(await F.fetchDiscounts(),A.push("/admin/extensions/ecommerce/discounts"))}catch(a){P.danger(a)}}));return(e,a)=>{const l=b,s=_,t=V,o=y,x=j,D=C,w=B,E=U;return u(),r(E,null,{left:d((()=>[n(l,{size:"lg"},{default:d((()=>[i(m(e.$t("Edit Discount")),1)])),_:1})])),right:d((()=>[n(t,{type:"button",color:"muted",class:"hover:bg-gray-300 dark:hover:bg-gray-800",to:"/admin/extensions/ecommerce/discounts"},{default:d((()=>[n(s,{name:"line-md:chevron-left",class:"h-4 w-4 mr-2"}),i(" "+m(e.$t("Back to Discounts")),1)])),_:1}),n(t,{type:"submit",color:"primary",disabled:c(z),class:"ml-2",onClick:c(X)},{default:d((()=>[i(m(e.$t("Save Changes")),1)])),_:1},8,["disabled","onClick"])])),default:d((()=>[p("form",{onSubmit:a[0]||(a[0]=g(((...e)=>c(X)&&c(X)(...e)),["prevent"])),class:"space-y-8"},[n(w,{class:"p-5 space-y-5"},{default:d((()=>[n(c(S),{name:"code"},{default:d((({field:e,errorMessage:a,handleChange:l,handleBlur:s})=>[n(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:c(z),type:"text",label:"Code",placeholder:"Enter code",shape:"rounded",class:"w-full",onBlur:s},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),n(c(S),{name:"percentage"},{default:d((({field:e,errorMessage:a,handleChange:l,handleBlur:s})=>[n(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:c(z),type:"number",label:"Percentage",placeholder:"Enter percentage",shape:"rounded",class:"w-full",onBlur:s},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),n(c(S),{name:"valid_until"},{default:d((({field:e,errorMessage:a,handleChange:l,handleBlur:s})=>[n(o,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:c(z),type:"date",label:"Valid Until",placeholder:"Enter valid until",shape:"rounded",class:"w-full",onBlur:s},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),n(c(S),{name:"product_id"},{default:d((({field:a,errorMessage:l})=>[n(x,{modelValue:a.value,"onUpdate:modelValue":e=>a.value=e,error:l,label:"Product",shape:"rounded"},{default:d((()=>[(u(!0),f(h,null,v(e.products,(e=>(u(),f("option",{key:e.id,value:e.id},m(e.name),9,k)))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","error"])])),_:1}),n(c(S),{name:"status"},{default:d((({field:e,errorMessage:a,handleChange:l,handleBlur:s})=>[n(D,{"model-value":e.value,error:a,items:["ACTIVE","INACTIVE"],placeholder:"Select a status",label:"Status",shape:"rounded","onUpdate:modelValue":l,onBlur:s},null,8,["model-value","error","onUpdate:modelValue","onBlur"])])),_:1})])),_:1})],32)])),_:1})}}});export{M as default};
