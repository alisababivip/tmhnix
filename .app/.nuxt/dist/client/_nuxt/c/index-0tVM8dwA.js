import{_ as e}from"./BaseInput.vue-iInHQMIA.js";import{d as t,a,ad as l,z as s,r,c as o,E as i,J as n,b as d,e as u,w as c,u as m,an as p,o as f,p as g,f as v,t as x,F as h,B as y,af as b,O as w,q as k,k as j,W as _,A as S,n as C,x as F,X as V,s as $,Y as B,ag as I,_ as D,g as T,ao as z}from"../e/entry-8qgg5CL-.js";import{_ as P}from"./TairoButtonIcon.vue-KqKLsAHm.js";import{_ as U}from"./BasePagination.vue-eKZkqxB7.js";import{_ as A}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{_ as L}from"./BaseProgress.vue-xH0Mhn3Z.js";import{_ as E}from"./BaseInputFileHeadless.vue-LOgyN9kF.js";import{_ as q}from"./BaseSwitchThin.vue-BxMY_B8T.js";import{u as N}from"./useForex-v_V55_1y.js";import{u as R}from"./fetch-i3Y1jjTS.js";import{b as W}from"./strings-rQgUKePI.js";import{_ as O,a as J}from"./placeholder-search-1-dark-6GG3FkNl.js";import{_ as K}from"./placeholder-file-IxKzOaSl.js";import{z as M,u as X,t as H,F as Y}from"./vee-validate.esm-n59zZCC5.js";import"./input-id-wZ-Ta08j.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";const G=t({id:"forexSignal",state:()=>({signals:[],loading:!1,selectedSignal:null}),getters:{getSignalById:e=>t=>e.signals.find((e=>e.id===t))},actions:{async fetchForexSignals(){this.loading=!0;try{const{getForexSignals:e}=N(),t=await e();this.signals=t.data.result}catch(e){console.error("Error fetching signals:",e)}this.loading=!1},async removeSignal(e){const t=this.signals.findIndex((t=>t.id===e));this.signals.splice(t,1)},async selectSignal(e){this.selectedSignal=e},async selectSignalById(e){this.selectedSignal=this.signals.find((t=>t.id===e))||null}}}),Q={class:"pb-10"},Z={class:"w-full"},ee={key:0,class:"space-y-4"},te={class:"flex flex-col items-center justify-center gap-3 text-center sm:flex-row sm:justify-start sm:text-left"},ae={class:"space-y-2"},le={class:"flex flex-col gap-4 pt-4 sm:ms-auto sm:flex-row sm:items-center sm:justify-end sm:pt-0"},se={class:"flex w-full items-center justify-center sm:w-[160px] sm:justify-end"},re={class:"ptablet:hidden divide-muted-200 dark:divide-muted-700 flex items-center justify-center divide-x"},oe={class:"flex flex-col gap-1 px-4 text-center"},ie={class:"flex flex-col gap-1 px-4 text-center"},ne={class:"flex flex-col gap-1 px-4 text-center"},de={class:"ptablet:hidden flex w-full items-center justify-center gap-1 py-3 sm:w-[160px] sm:justify-end sm:py-0"},ue={class:"sm:ms-6"},ce={key:1},me=v("img",{class:"block dark:hidden",src:O,alt:"Placeholder image"},null,-1),pe=v("img",{class:"hidden dark:block",src:J,alt:"Placeholder image"},null,-1),fe={key:2,class:"space-y-4"},ge={class:"flex flex-col items-center justify-start gap-3 text-center sm:flex-row sm:justify-start sm:text-left"},ve=["src"],xe={class:"flex flex-col gap-4 pt-4 sm:ms-auto sm:flex-row sm:items-center sm:justify-end sm:pt-0"},he={class:"divide-muted-200 dark:divide-muted-700 flex items-center justify-center divide-x"},ye={class:"flex flex-col gap-1 px-4 text-center"},be={class:"flex w-full items-center justify-between p-4 md:p-6"},we={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},ke={class:"p-4 md:p-6"},je={class:"mx-auto w-full text-start"},_e={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},Se={class:"space-y-5"},Ce={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},Fe=["onDrop"],Ve=["onClick","onKeydown"],$e={class:"p-5 text-center"},Be={class:"text-muted-400 font-sans text-sm"},Ie={class:"text-muted-400 font-sans text-[0.7rem] font-semibold uppercase"},De={for:"file",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 cursor-pointer font-sans text-sm underline underline-offset-4 transition-colors duration-300"},Te={key:1,class:"mt-6 space-y-2"},ze={class:"border-muted-200 dark:border-muted-700 dark:bg-muted-800 relative flex items-center justify-end gap-2 rounded-xl border bg-white p-3"},Pe={class:"flex items-center gap-2"},Ue={class:"shrink-0"},Ae=["src"],Le={key:1,class:"h-14 w-14 rounded-xl object-cover object-center",src:K,alt:"Image preview"},Ee={class:"font-sans"},qe={class:"text-muted-800 dark:text-muted-100 line-clamp-1 block text-sm"},Ne={class:"text-muted-400 block text-xs"},Re={class:"flex gap-2"},We={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300 disabled:cursor-not-allowed disabled:opacity-60",disabled:"",type:"button",tooltip:"Cancel"},Oe=v("span",{class:"sr-only"},"Cancel",-1),Je={class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Upload"},Ke=v("span",{class:"sr-only"},"Upload",-1),Me=["onClick"],Xe=v("span",{class:"sr-only"},"Remove",-1),He={key:0,class:"mb-4 h-36 w-full flex items-center justify-center overflow-hidden rounded-xl"},Ye=["src"],Ge={class:"p-4 md:p-6"},Qe={class:"flex gap-x-2"},Ze={class:"flex w-full items-center justify-between p-4 md:p-6"},et={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},tt={class:"p-4 md:p-6"},at={class:"mx-auto w-full text-center"},lt={class:"font-heading text-muted-800 text-lg font-medium leading-6 dark:text-white"},st={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},rt={class:"p-4 md:p-6"},ot={class:"flex gap-x-2"},it=a({__name:"index",setup(t){const{toast:a}=l(),O=s(),J=r(!0),{createForexSignal:K,deleteForexSignal:it}=N(),nt=G(),dt=o((()=>nt.signals));i((async()=>{J.value=!0,0===nt.signals.length&&await nt.fetchForexSignals(),J.value=!1}));const ut=r(""),ct=r(10),mt=o((()=>parseInt(O.query.page??"1"))),pt=r(!1),ft=o((()=>dt.value&&Array.isArray(dt.value)?dt.value.filter((e=>e.title.toLowerCase().includes(ut.value.toLowerCase()))):[])),gt=o((()=>{const e=(mt.value-1)*ct.value,t=e+ct.value;return ft.value.slice(e,t)})),vt=M.object({title:M.string().nonempty("Title cannot be empty"),status:M.boolean()}),xt=o((()=>({title:"",status:!0}))),{handleSubmit:ht,isSubmitting:yt,meta:bt,resetForm:wt}=X({validationSchema:H(vt),initialValues:xt}),kt=r(null),jt=r(null);n(kt,(e=>{const t=e?.item(0)||null;if(kt.value){const e=new FileReader;e.onload=e=>{jt.value=e.target?.result},e.readAsDataURL(t)}}));const _t=ht((async e=>{if(dt.value&&dt.value.length>0&&dt.value.some((t=>t.title===e.title)))return a.warning("Signal already exists"),void(pt.value=!1);const t={title:e.title,image:"",status:e.status?"ACTIVE":"INACTIVE"};if(kt.value){const e=new FormData;e.append("files",kt.value[0]),e.append("type","forexSignal");const a=await R("/api/upload",{method:"POST",body:e},"$ILWPwATJDz");a&&""!==a.data.value&&(t.image=a.data.value[0])}try{const e=await K(t.title,t.image,t.status);a.response(e),"success"===e.status&&(await nt.fetchForexSignals(),wt())}catch(l){a.danger(l)}pt.value=!1})),St=r(!1),Ct=r(!1),Ft=r(null);return(t,l)=>{const s=e,r=F,o=V,i=$,n=B,N=I,R=D,O=T,K=P,M=U,X=A,H=z,G=L,ft=E,vt=q,xt=p;return f(),d("div",Q,[u(X,null,{left:c((()=>[u(s,{modelValue:m(ut),"onUpdate:modelValue":l[0]||(l[0]=e=>g(ut)?ut.value=e:null),icon:"lucide:search",placeholder:"Filter signals...",classes:{wrapper:"w-full sm:w-auto"}},null,8,["modelValue"])])),right:c((()=>[v("div",Z,[u(o,{color:"success",class:"w-full",onClick:l[1]||(l[1]=e=>pt.value=!0),flavor:"outline"},{default:c((()=>[u(r,{name:"line-md:plus",class:"h-4 w-4"}),v("span",null,x(t.$t("Create Signal")),1)])),_:1})])])),default:c((()=>[v("div",null,[m(J)?(f(),d("div",ee,[(f(),d(h,null,y(3,(e=>u(n,{key:e,class:"flex flex-col p-5 sm:flex-row sm:items-center"},{default:c((()=>[v("div",te,[u(i,{class:"h-16 w-16 shrink-0 rounded-full"}),v("div",ae,[u(i,{class:"mx-auto h-3 w-[100px] rounded-lg sm:mx-0"}),u(i,{class:"mx-auto h-3 w-[75px] rounded-lg sm:mx-0"})])]),v("div",le,[v("div",se,[u(i,{class:"h-6 w-24 rounded-full"})]),v("div",re,[v("div",oe,[u(i,{class:"h-3 w-16 rounded-lg"})]),v("div",ie,[u(i,{class:"h-3 w-16 rounded-lg"})]),v("div",ne,[u(i,{class:"h-3 w-16 rounded-lg"})])]),v("div",de,[u(i,{class:"h-8 w-8 shrink-0 rounded-full"}),u(i,{class:"h-8 w-8 shrink-0 rounded-full"}),u(i,{class:"hidden h-3 w-12 rounded-full sm:block"})]),v("div",ue,[u(i,{class:"mx-auto h-8 w-40 rounded-lg sm:mx-0 sm:w-20"})])])])),_:2},1024))),64))])):m(J)||0!==m(gt).length?(f(),d("div",fe,[u(b,{"enter-active-class":"transform-gpu","enter-from-class":"opacity-0 -translate-x-full","enter-to-class":"opacity-100 translate-x-0","leave-active-class":"absolute transform-gpu","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 -translate-x-full"},{default:c((()=>[(f(!0),d(h,null,y(m(gt),(e=>(f(),w(n,{key:e.id,class:"flex flex-col p-5 sm:flex-row sm:items-center"},{default:c((()=>[v("div",ge,[v("img",{src:e.image,class:"h-16 w-16 shrink-0 rounded-lg"},null,8,ve),u(R,{tag:"h3",size:"sm",weight:"medium",class:"text-muted-800 dark:text-muted-100"},{default:c((()=>[k(x(e.title),1)])),_:2},1024)]),v("div",xe,[v("div",he,[v("div",ye,[u(R,{tag:"h3",size:"md",weight:"semibold",class:"text-muted-800 dark:text-muted-100"},{default:c((()=>[v("span",null,x(e.forex_accounts?.length??0),1)])),_:2},1024),u(O,{lead:"none",weight:"semibold",class:"text-muted-400 !text-[0.65rem] uppercase"},{default:c((()=>[v("span",null,x(t.$t("Plans")),1)])),_:1})]),v("div",null,[u(K,{onClick:t=>function(e){Ft.value=e,St.value=!0}(e),color:"danger",flavor:"outline","data-nui-tooltip":"Delete Signal",condensed:"",class:"ml-4"},{default:c((()=>[u(r,{name:"line-md:close",class:"h-4 w-4"})])),_:2},1032,["onClick"])])])])])),_:2},1024)))),128))])),_:1}),v("div",null,[m(dt).length>m(ct)?(f(),w(M,{key:0,"total-items":m(dt).length,"item-per-page":m(ct),"current-page":m(mt),shape:"full"},null,8,["total-items","item-per-page","current-page"])):j("",!0)])])):(f(),d("div",ce,[u(N,{title:m(ut)&&""!==m(ut)?"No matching results":"No results",subtitle:m(ut)&&""!==m(ut)?"Looks like we couldn't find any matching results for your search terms. Try other search terms.":"Looks like we don't have any data here yet."},{image:c((()=>[me,pe])),_:1},8,["title","subtitle"])]))])])),_:1}),u(xt,{open:m(pt),size:"xl",onClose:l[7]||(l[7]=e=>pt.value=!1)},{header:c((()=>[v("div",be,[v("h3",we,x(t.$t("Create New Signal")),1),u(H,{onClick:l[2]||(l[2]=e=>pt.value=!1)})])])),footer:c((()=>[v("div",Ge,[v("div",Qe,[u(o,{onClick:l[6]||(l[6]=e=>pt.value=!1)},{default:c((()=>[k(x(t.$t("Cancel")),1)])),_:1}),u(o,{color:"primary",flavor:"solid",onClick:m(_t),disabled:m(yt),loading:m(yt)},{default:c((()=>[k(x(t.$t("Create")),1)])),_:1},8,["onClick","disabled","loading"])])])])),default:c((()=>[v("div",ke,[v("div",je,[v("p",_e,x(t.$t("Please provide a unique signal and timeframe for the new signal"))+". ",1),v("div",Se,[u(m(Y),{name:"title"},{default:c((({field:e,errorMessage:t,handleChange:a,handleBlur:l})=>[u(s,{modelValue:e.value,"onUpdate:modelValue":[t=>e.value=t,a],error:t,disabled:m(yt),type:"text",label:"title",placeholder:"Enter title",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),u(n,{class:"p-5"},{default:c((()=>[v("div",Ce,[u(ft,{modelValue:m(kt),"onUpdate:modelValue":l[5]||(l[5]=e=>g(kt)?kt.value=e:null)},{default:c((({open:e,remove:a,preview:s,drop:o,files:i})=>[v("div",{class:"",onDragenter:l[3]||(l[3]=_((()=>{}),["stop","prevent"])),onDragover:l[4]||(l[4]=_((()=>{}),["stop","prevent"])),onDrop:o},[i?.length?(f(),d("ul",Te,[(f(!0),d(h,null,y(i,(e=>(f(),d("li",{key:e.name},[v("div",ze,[v("div",Pe,[v("div",Ue,[e.type.startsWith("image")?(f(),d("img",{key:0,class:"h-14 w-14 rounded-xl object-cover object-center",src:s(e).value,alt:"Image preview"},null,8,Ae)):(f(),d("img",Le))]),v("div",Ee,[v("span",qe,x(e.name),1),v("span",Ne,x(("formatFileSize"in t?t.formatFileSize:m(W))(e.size)),1)])]),v("div",{class:C(["ms-auto w-32 px-4 transition-opacity duration-300","opacity-100"])},[u(G,{value:0,size:"xs",color:"success"})]),v("div",Re,[v("button",We,[u(r,{name:"lucide:slash",class:"h-4 w-4"}),Oe]),v("button",Je,[u(r,{name:"lucide:arrow-up",class:"h-4 w-4"}),Ke]),v("button",{class:"border-muted-200 hover:border-primary-500 text-muted-700 dark:text-muted-200 hover:text-primary-600 dark:border-muted-700 dark:bg-muted-900 dark:hover:border-primary-500 dark:hover:text-primary-600 relative flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border bg-white transition-colors duration-300",type:"button",tooltip:"Remove",onClick:_((t=>a(e)),["prevent"])},[u(r,{name:"lucide:x",class:"h-4 w-4"}),Xe],8,Me)])])])))),128))])):(f(),d("div",{key:0,class:"nui-focus border-muted-300 dark:border-muted-700 hover:border-muted-400 focus:border-muted-400 dark:hover:border-muted-600 dark:focus:border-muted-700 group cursor-pointer rounded-lg border-[3px] border-dashed transition-colors duration-300",tabindex:"0",role:"button",onClick:e,onKeydown:S(_(e,["prevent"]),["enter"])},[v("div",$e,[u(r,{name:"mdi-light:cloud-upload",class:"text-muted-400 group-hover:text-primary-500 group-focus:text-primary-500 mb-2 h-10 w-10 transition-colors duration-300"}),v("h4",Be,x(t.$t("Drop file to upload")),1),v("div",null,[v("span",Ie,x(t.$t("Or")),1)]),v("label",De,x(t.$t("Select Image")),1)])],40,Ve))],40,Fe)])),_:1},8,["modelValue"]),m(jt)?(f(),d("div",He,[v("img",{src:m(jt),alt:"Image Preview",class:"max-h-full max-w-full object-cover object-center"},null,8,Ye)])):j("",!0)])])),_:1}),u(m(Y),{name:"status"},{default:c((({field:e,errorMessage:t,handleChange:a,handleBlur:l})=>[u(vt,{modelValue:e.value,"onUpdate:modelValue":[t=>e.value=t,a],error:t,disabled:m(yt),label:"Status",color:"success",onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})])])])])),_:1},8,["open"]),u(xt,{open:m(St),size:"sm",onClose:l[11]||(l[11]=e=>St.value=!1)},{header:c((()=>[v("div",Ze,[v("h3",et,x(t.$t("Delete"))+" "+x(t.$t("Forex Signal")),1),u(H,{onClick:l[8]||(l[8]=e=>St.value=!1)})])])),footer:c((()=>[v("div",rt,[v("div",ot,[u(o,{onClick:l[9]||(l[9]=e=>St.value=!1)},{default:c((()=>[k(x(t.$t("Cancel")),1)])),_:1}),u(o,{color:"danger",flavor:"solid",onClick:l[10]||(l[10]=e=>async function(){Ct.value=!0;try{const e=await it(Ft.value?.id);a.response(e),"success"===e.status&&nt.removeSignal(Ft.value?.id)}catch(e){a.danger(e)}St.value=!1,Ct.value=!1,Ft.value=null}()),disabled:m(Ct),loading:m(Ct)},{default:c((()=>[k(x(t.$t("Delete")),1)])),_:1},8,["disabled","loading"])])])])),default:c((()=>[v("div",tt,[v("div",at,[v("h3",lt,x(t.$t("Are you sure?")),1),v("p",st,x(t.$t("Do you really want to delete this"))+" "+x(t.$t("signal"))+" "+x(t.$t("This process cannot be undone"))+". ",1)])])])),_:1},8,["open"])])}}});export{it as default};
