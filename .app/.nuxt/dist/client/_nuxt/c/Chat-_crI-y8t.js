import{_ as e}from"./Logo.vue-Ap1LDK0R.js";import{a as t,S as a,c as s,ad as l,z as n,r as i,E as r,G as o,J as u,K as c,a3 as d,o as m,b as f,f as p,e as h,w as v,n as g,u as w,p as x,A as y,O as k,k as b,t as _,F as S,B as j,W as C,q as I,Z as E,C as $,x as D,cV as O,X as T,s as L,_ as z,al as B,c7 as P,c5 as A,y as N}from"../e/entry-8qgg5CL-.js";import{_ as V}from"./AccountMenu.vue-fQ4Lp7sc.js";import{_ as W}from"./BaseInput.vue-iInHQMIA.js";import{_ as U}from"./BaseButtonIcon.vue-6tAU_b7C.js";import{_ as G}from"./BaseAvatar.vue-XYSxxLJP.js";import{_ as H}from"./BaseFullscreenDropfile.vue-QiSzg2sB.js";import{_ as M}from"./BaseInputFileHeadless.vue-LOgyN9kF.js";import{_ as q}from"./BaseTag.vue-NMkN1Uk8.js";import{u as F}from"./useSupport-ffNMpQhG.js";import{u as R}from"./composables-Om4eAUXX.js";import{u as J}from"./fetch-i3Y1jjTS.js";import{u as K}from"./user-j76Gmn-L.js";import{u as X}from"./admin-rBAA3x0i.js";import{P as Y}from"./emoji-picker.es-0AYyr9rU.js";/* empty css              */const Z={class:"relative"},Q={class:"bg-muted-100 dark:bg-muted-900 flex min-h-screen"},ee={class:"border-muted-200 dark:border-muted-700 dark:bg-muted-800 relative z-10 hidden h-screen w-20 border-r bg-white sm:block"},te={class:"flex h-full flex-col justify-between"},ae={class:"flex flex-col"},se={class:"ltablet:w-full flex h-16 w-16 shrink-0 items-center justify-center lg:w-full"},le={class:"ltablet:w-full flex h-16 w-16 shrink-0 items-center justify-center lg:w-full"},ne={class:"flex flex-col"},ie={class:"flex h-16 w-full items-center justify-center"},re={class:"flex w-full flex-col"},oe={class:"flex h-16 w-full items-center justify-between px-4 sm:px-8 gap-4"},ue={class:"flex items-center gap-2"},ce={class:"mr-2"},de={class:"mt-12 space-y-12"},me={class:"flex w-full max-w-md gap-4"},fe={class:"grow space-y-2"},pe={class:"flex w-full max-w-md gap-4"},he={class:"grow space-y-2"},ve={class:"ms-auto flex w-full max-w-md flex-row-reverse justify-end gap-4"},ge={class:"grow space-y-2"},we={class:"ms-auto flex w-full max-w-md flex-row-reverse justify-end gap-4"},xe={class:"grow space-y-2"},ye={class:"flex w-full max-w-md gap-4"},ke={class:"grow space-y-2"},be={class:"flex w-full max-w-md gap-4"},_e={class:"grow space-y-2"},Se=["data-index"],je={class:"shrink-0"},Ce={class:"flex max-w-md flex-col"},Ie={key:0,class:"max-w-xs"},Ee={class:"image-container"},$e=["src","alt","onClick"],De=["onClick"],Oe={class:"font-sans text-sm"},Te={class:"w-full rounded-xl overflow-hidden"},Le=["src","alt"],ze={class:"pl-2"},Be={key:0,class:"text-muted-800 dark:text-muted-100 font-sans text-sm mb-1"},Pe={key:1,class:"text-muted-800 dark:text-muted-100 font-sans"},Ae={class:"text-muted-400 font-sans text-xs"},Ne={class:"rounded-xl overflow-hidden"},Ve=["src","alt"],We={class:"px-1 py-2"},Ue={key:0,class:"text-muted-800 dark:text-muted-100 font-sans text-sm mb-1"},Ge={key:1,class:"text-muted-800 dark:text-muted-100 font-sans"},He={class:"text-muted-400 font-sans text-xs"},Me={key:0},qe={class:"image-container"},Fe=["src","alt","onClick"],Re=["onClick"],Je={class:"font-sans text-sm"},Ke={key:1},Xe=(e=>(P("data-v-1d51cd51"),e=e(),A(),e))((()=>p("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[p("div",{class:"border-muted-300/50 dark:border-muted-800 w-full border-t"})],-1))),Ye={class:"relative flex justify-center"},Ze={class:"bg-muted-100 dark:bg-muted-900 text-muted-400 px-3 font-sans text-xs uppercase"},Qe={class:"relative w-full"},et={key:0,class:"absolute bottom-12 right-0 z-50"},tt={class:"absolute end-2 top-0 flex h-12 items-center gap-1"},at={"data-nui-tooltip":"Upload image",class:"text-muted-400 hover:text-primary-500 flex items-center justify-center transition-colors duration-300 mr-2"},st={class:"flex h-16 w-full items-center justify-between px-8"},lt={class:"relative flex w-full flex-col px-8"},nt={key:0,class:"mt-8"},it={class:"mb-3 flex items-center justify-center"},rt={class:"flex flex-col items-center"},ot={class:"my-4 flex w-full flex-col items-center"},ut={class:"mb-6 flex w-full items-center justify-center"},ct={class:"px-4"},dt={class:"px-4"},mt={class:"w-full"},ft={key:1,class:"mt-8"},pt={class:"flex items-center justify-center"},ht={class:"flex flex-wrap items-end gap-4"},vt={class:"text-muted-600 dark:text-gray-300"},gt={class:""},wt={class:"flex justify-center items-center gap-2"},xt={class:"space-y-1"},yt={class:"col-span-2 lg:col-span-1 text-muted-600 dark:text-gray-300"},kt={class:"block md:inline"},bt={class:"col-span-2 lg:col-span-1 text-muted-600 dark:text-gray-300"},_t={class:"block md:inline"},St={class:"mr-2"},jt={class:"mr-2"},Ct=N(t({__name:"Chat",props:{isSupport:{type:Boolean,required:!0}},setup(t){const P=t,{sendMessage:A,closeTicket:N,openTicket:Ct,getMetadata:It}=F();let Et;Et=P.isSupport?X():K();const $t=a(),Dt=s((()=>$t.getProfile)),{toast:Ot}=l(),Tt=n(),{uuid:Lt}=Tt.params,zt=s((()=>Et.tickets.find((e=>e.uuid===Lt)))),Bt=s((()=>Et?.chat)),Pt=s((()=>Bt?.value?.uuid)),At=s((()=>Bt.value?.user_id)),Nt=s((()=>Bt.value?.agent_id)),{assignAgent:Vt}=F(),Wt=e=>{if(P.isSupport){return e.agent_id===Dt.value?.id&&"agent"===e.type||e.agent_id!==Dt.value?.id&&"client"===e.type}return e.user_id===Dt.value?.id&&"client"===e.type||e.user_id!==Dt.value?.id&&"agent"===e.type},Ut=E();let Gt;const Ht=i(),Mt=i(),qt=R(),Ft=i(!qt.isGreaterOrEquals("sm")),Rt=i(!1),Jt=i(""),Kt=i(!1),Xt=i(null);let Yt=null;function Zt(){Mt.value?Mt.value.scrollTo({top:Mt.value.scrollHeight,behavior:"smooth"}):console.error("ChatBody.value is null")}r((async()=>{if(0===Et.tickets.length&&await Et.fetchTickets(),P.isSupport&&null===zt.value?.chat?.agent_id){const e=await Vt(zt.value?.uuid);Ot.response(e),"success"===e.status&&(Et.tickets.find((e=>e.uuid===Lt)).chat.agent_id=e.data.result.agent_id)}null===Et.chat&&await Et.fetchChat(Lt),function(){if(Bt.value){Bt.value.messages||(Bt.value.messages={});for(const e of Object.values(Bt.value.messages))e.attachments&&e.attachments[0]&&wa(e.attachments[0].image);setTimeout(Zt,300)}}()})),o((()=>{Gt&&Gt.close()})),u((()=>Bt.value?.id),(e=>{e!==Yt&&(Gt&&Gt.readyState===WebSocket.OPEN&&Gt.close(),function(){Gt||function(){if(null!==Nt.value){const e=`${Ut.public.appWebSocketUrl}/chat/?chatUuid=${Pt.value}&clientId=${At.value}&agentId=${Nt.value}&isSupport=${P.isSupport}`;Gt=new WebSocket(e),Gt.onopen=()=>{console.log("WebSocket is open now.")},Gt.onerror=e=>{console.log("WebSocket Error: ",e)}}else console.error("No agent assigned to this chat.")}();Gt&&(setInterval((()=>{Gt.readyState===WebSocket.OPEN&&Gt.send("heartbeat")}),3e4),Gt.addEventListener("message",(e=>{e.data instanceof Blob?function(e){let t=new FileReader;t.addEventListener("loadend",(()=>{const e=JSON.parse(t.result);Qt(e)})),t.readAsText(e.data)}(e):"string"==typeof e.data?function(e){const t=JSON.parse(e.data);Qt(t)}(e):console.error("Received non-string, non-blob message:",e.data)})))}(),Yt=e)})),u(Xt,(e=>{e?.length&&async function(e){if(Kt.value)return;Kt.value=!0;try{const t=new FormData;for(let s=0;s<e.length;s++){const a=e.item(s);a&&t.append("files",a)}t.append("user_id",At.value),t.append("agent_id",Nt.value),t.append("type","chat");const a=await J("/api/upload",{method:"POST",body:t},"$SxkW8juH67");if(!a||"success"!==a.status.value)throw new Error(a.error.message);{const e=ea({type:P.isSupport?"agent":"client",text:"",time:(new Date).toISOString(),user_id:At.value,agent_id:Nt.value,attachments:a.data.value.map((e=>({type:"image",image:e,text:""})))});await ta(e),Xt.value=null,await c(),Zt()}}catch(t){Ot.danger(t)}finally{Kt.value=!1}}(e)}));const Qt=e=>{let t=[];e.attachments&&Array.isArray(e.attachments)&&(t=function(e){return e.map((e=>"image"===e.type?{type:"image",image:e.image,text:e.text||""}:"link"===e.type?{type:"link",url:e.url,image:e.image,title:e.title,description:e.description}:void 0))}(e.attachments));const a=function(e,t){const a=(new Date).toLocaleString();let s;s=P.isSupport?"client":"agent";return{type:s,text:e.text,time:a,user_id:e.user_id,agent_id:e.agent_id,attachments:t}}(e,t);aa(a),Et.tickets.find((e=>e.uuid===Lt)).status="REPLIED",setTimeout(Zt,300)};function ea({type:e,text:t,time:a,user_id:s,agent_id:l,attachments:n}){return{type:e,text:t,time:a,user_id:s,agent_id:l,attachments:n}}async function ta(e){if(!At.value||!Nt.value)return Ot.dangerText("User ID or Agent ID is missing.");if("PENDING"===zt.value?.status&&!P.isSupport)return Ot.dangerText("Please wait for a reply from the support team.");if("CLOSED"===zt.value?.status)return Ot.dangerText("You cannot send a message to a closed ticket. Please open a new ticket.");try{const a=await A(zt.value?.uuid,e,P.isSupport);if("fail"===a.status)return Ot.danger(a),void(404===a.error.status&&(Et.tickets.find((e=>e.uuid===Lt)).status="CLOSED"));try{Gt.send(JSON.stringify(e))}catch(t){console.error("Error sending message to websocket:",t),Ot.danger(t)}aa(e),Et.tickets.find((e=>e.uuid===Lt)).status=P.isSupport?"REPLIED":"OPEN"}catch(t){Ot.danger(t)}}function aa(e){let t=Object.values(Et.chat.messages);t.push(e),Et.chat.messages={...t}}const sa=i(""),la=i(0),na=i([]);function ia(){const e=sa.value?.trim().toLowerCase();if(e){na.value=[],la.value=0;const t=Bt.value?.messages||[];for(let a=0;a<t.length;a++){const s=t[a];if(s.text&&s.text.toLowerCase().includes(e))na.value.push(a);else if(s.attachments)for(let t=0;t<s.attachments.length;t++){const l=s.attachments[t];if("file"===l.type&&l.name.toLowerCase().includes(e)){na.value.push(a);break}}}na.value.length>0&&ra(na.value[0])}}function ra(e){const t=Array.from(Ht.value?.children||[]).find((t=>t.getAttribute("data-index")===String(e)));t&&t.scrollIntoView({behavior:"smooth"})}function oa(){na.value.length>0&&(la.value=(la.value+1)%na.value.length,ra(na.value[la.value]))}function ua(){na.value.length>0&&(la.value=(la.value-1+na.value.length)%na.value.length,ra(na.value[la.value]))}function ca(){na.value.length>0?oa():ia()}const da=i(null),ma=i(!1);function fa(e){da.value=e,ma.value=!0}function pa(){ma.value=!1}const ha=i(!1),va=e=>{Jt.value+=e.i,ha.value=!1},ga=i({}),wa=e=>{let t=new Image;t.onload=function(){ga.value[e]={width:this.width,height:this.height}},t.src=e},xa=e=>{const t=ga.value[e];return t&&t.width<=246&&t.height<=246};function ya(e){const t=((new Date).getTime()-e.getTime())/1e3;return t<60?`${parseInt(t)} ${1===parseInt(t)?"second":"seconds"}`:t<3600?`${parseInt(t/60)} ${1===parseInt(t/60)?"minute":"minutes"}`:t<=86400?`${parseInt(t/3600)} ${1===parseInt(t/3600)?"hour":"hours"}`:t>86400&&t<=604800?`${parseInt(t/86400)} ${1===parseInt(t/86400)?"day":"days"}`:t>604800&&t<=2592e3?`${parseInt(t/604800)} ${1===parseInt(t/604800)?"week":"weeks"}`:t>2592e3?"long time":void 0}async function ka(){if(Jt.value&&!Kt.value){na.value=[],la.value=0,Kt.value=!0;try{const e=(new Date).toLocaleString(),t=/(https?:\/\/[^\s]+)/g,a=Jt.value.match(t),s=a&&a.length>0?a[0]:null;let l=null;if(s){const e=(await It(s)).data.result;e.title&&e.image&&(l={type:"link",image:e.image,url:s,title:e.title,description:e.description},Jt.value.trim()===s&&(Jt.value=""))}const n=ea({type:P.isSupport?"agent":"client",text:Jt.value,time:e,user_id:At.value,agent_id:Nt.value,attachments:l?[l]:[]});await ta(n),Jt.value="",Kt.value=!1,await c();let i=document.getElementById("messageInput");i&&i.focus(),Zt()}catch(e){console.log(e),Ot.danger(e)}finally{Kt.value=!1}}}const ba=e=>{switch(e){case"PENDING":return"warning";case"OPEN":return"success";case"CLOSED":return"danger";case"REPLIED":return"primary";default:return"info"}},_a=e=>{switch(e){case"LOW":default:return"info";case"MEDIUM":return"warning";case"HIGH":return"danger"}};return(a,s)=>{const l=e,n=$,i=D,r=V,o=W,u=U,c=O,E=T,P=L,A=G,F=H,R=M,J=z,K=q,X=B,It=d("VueEasyLightbox");return m(),f("div",Z,[p("div",Q,[p("div",ee,[p("div",te,[p("div",ae,[p("div",se,[h(n,{to:"/",class:"flex items-center justify-center"},{default:v((()=>[h(l,{class:"text-primary-600 h-10"})])),_:1})]),p("div",le,[h(n,{to:t.isSupport?"/admin/support":"/user/support","data-nui-tooltip":"Back","data-nui-tooltip-position":"right",class:"text-muted-400 hover:text-primary-500 hover:bg-primary-500/20 flex h-12 w-12 items-center justify-center rounded-2xl transition-colors duration-300"},{default:v((()=>[h(i,{name:"lucide:arrow-left",class:"h-5 w-5"})])),_:1},8,["to"])])]),p("div",ne,[p("div",ie,[h(r)])])])]),p("div",{class:g(["relative w-full transition-all duration-500",w(Ft)?"":"ltablet:max-w-[calc(100%_-_470px)] lg:max-w-[calc(100%_-_470px)]"])},[p("div",re,[p("div",oe,[p("div",ue,[h(o,{modelValue:w(sa),"onUpdate:modelValue":s[0]||(s[0]=e=>x(sa)?sa.value=e:null),shape:"curved",icon:"lucide:search",placeholder:"Search",onChange:ia,onKeyup:y(ca,["enter"])},null,8,["modelValue"]),w(na).length>0?(m(),k(u,{key:0,class:"hidden sm:block",shape:"curved",onClick:ua},{default:v((()=>[h(i,{name:"lucide:arrow-left",class:"h-5 w-5"})])),_:1})):b("",!0),w(na).length>0?(m(),k(u,{key:1,class:"hidden sm:block",shape:"curved",onClick:oa},{default:v((()=>[h(i,{name:"lucide:arrow-right",class:"h-5 w-5"})])),_:1})):b("",!0)]),h(c,{class:"relative -end-4 z-20 flex h-16 w-full scale-90 items-center justify-end gap-2 sm:end-0 sm:scale-100"}),a.$viewport.isGreaterOrEquals("sm")&&w(Ft)?(m(),k(E,{key:0,onClick:s[1]||(s[1]=e=>Ft.value=!1)},{default:v((()=>[p("span",ce,_(a.$t("Details")),1),h(i,{name:"lucide:arrow-right",class:"h-4 w-4"})])),_:1})):b("",!0),a.$viewport.isLessThan("sm")&&w(Ft)?(m(),f("span",{key:1,onClick:s[2]||(s[2]=e=>Ft.value=!1),class:"disabled:opacity-60 disabled:cursor-not-allowed hover:shadow-none false text-primary-500 border-2 border-primary-500 hover:bg-primary-500/20 false rounded-full h-8 w-8 p-2 nui-focus relative inline-flex items-center justify-center space-x-1 font-sans text-sm font-normal leading-5 no-underline outline-none transition-all duration-300"},[h(i,{name:"line-md:chevron-right",class:"h-5 w-5"})])):b("",!0)]),p("div",{ref_key:"ChatBody",ref:Mt,class:g(["relative h-[calc(100vh_-_128px)] w-full p-4 sm:p-8",w(Rt)?"overflow-hidden":"overflow-y-auto slimscroll"])},[p("div",{class:g(["bg-muted-100 dark:bg-muted-900 pointer-events-none absolute inset-0 z-10 h-full w-full p-8 transition-opacity duration-300",w(Rt)?"opacity-100":"opacity-0 pointer-events-none"])},[p("div",de,[p("div",me,[h(P,{class:"h-8 w-8 shrink-0 rounded-full",width:32,height:32}),p("div",fe,[h(P,{class:"h-3 w-full max-w-[14rem] rounded"}),h(P,{class:"h-3 w-full max-w-[8rem] rounded"})])]),p("div",pe,[h(P,{class:"h-8 w-8 shrink-0 rounded-full",width:32,height:32}),p("div",he,[h(P,{class:"h-3 w-full max-w-[16rem] rounded"}),h(P,{class:"h-3 w-full max-w-[12rem] rounded"})])]),p("div",ve,[h(P,{class:"h-8 w-8 shrink-0 rounded-full",width:32,height:32}),p("div",ge,[h(P,{class:"ms-auto h-3 w-full max-w-[16rem] rounded"}),h(P,{class:"ms-auto h-3 w-full max-w-[12rem] rounded"})])]),p("div",we,[h(P,{class:"h-8 w-8 shrink-0 rounded-full",width:32,height:32}),p("div",xe,[h(P,{class:"ms-auto h-3 w-full max-w-[14rem] rounded"}),h(P,{class:"ms-auto h-3 w-full max-w-[8rem] rounded"})])]),p("div",ye,[h(P,{class:"h-8 w-8 shrink-0 rounded-full",width:32,height:32}),p("div",ke,[h(P,{class:"h-3 w-full max-w-[14rem] rounded"}),h(P,{class:"h-3 w-full max-w-[8rem] rounded"})])]),p("div",be,[h(P,{class:"h-8 w-8 shrink-0 rounded-full",width:32,height:32}),p("div",_e,[h(P,{class:"h-3 w-full max-w-[16rem] rounded"}),h(P,{class:"h-3 w-full max-w-[12rem] rounded"})])])])],2),w(Bt)&&w(Bt).messages?(m(),f("div",{key:0,class:"space-y-8",ref_key:"SearchElement",ref:Ht},[(m(!0),f(S,null,j(w(Bt)?.messages,((e,t)=>(m(),f("div",{key:t,"data-index":t,class:g(["relative flex w-full gap-4",[Wt(e)?"flex-row-reverse":"flex-row","separator"===e.type?"justify-center":""]])},["separator"!==e.type?(m(),f(S,{key:0},[p("div",je,[Wt(e)?(m(),k(A,{key:0,src:w(Dt)?.avatar,size:"xs"},null,8,["src"])):(m(),k(A,{key:1,src:w(zt)?.user?.avatar||"/img/avatars/1.svg",size:"xs"},null,8,["src"]))]),p("div",Ce,[e.attachments?.length>0?(m(),f(S,{key:0},[1===e.attachments.length?(m(),f("div",{key:0,class:g(Wt(e)?"text-right rounded-se-none":"text-left rounded-ss-none")},["image"===e.attachments[0].type?(m(),f("div",Ie,[p("div",Ee,[p("img",{loading:"lazy",src:e.attachments[0].image,alt:e.attachments[0].text,class:"dark:bg-muted-800 rounded-2xl bg-white p-1",onClick:t=>fa(e.attachments[0].image)},null,8,$e),p("div",{class:"overlay",onClick:t=>fa(e.attachments[0].image)},[h(i,{name:"lucide:zoom-in",class:"h-5 w-5 zoom-icon"})],8,De)])])):(m(),f(S,{key:1},[e.text?(m(),f("div",{key:0,class:g(["bg-muted-200 dark:bg-muted-800 rounded-xl p-4 mb-2 text-left",Wt(e)?"rounded-se-none":"rounded-ss-none"])},[p("p",Oe,_(e.text),1)],2)):b("",!0),p("div",null,[h(n,{to:e.attachments[0].url,target:"_blank",class:g(["flex text-left",Wt(e)?"justify-end":"justify-start"])},{default:v((()=>[xa(e.attachments[0].image)?(m(),f("div",{key:0,class:g(["flex max-w-sm rounded-2xl bg-white dark:bg-muted-800 p-2 overflow-hidden",Wt(e)?"rounded-se-none ":"rounded-ss-none"])},[p("div",Te,[p("img",{loading:"lazy",src:e.attachments[0].image,alt:e.attachments[0].title,class:"w-24 h-24 transform transition-all duration-300 hover:scale-105"},null,8,Le)]),p("div",ze,[e.attachments[0].title?(m(),f("p",Be,_(e.attachments[0].title),1)):(m(),f("p",Pe,_(e.attachments[0].url?.replace(/(^\w+:|^)\/\//,"")),1)),p("p",Ae,_(e.attachments[0].description),1)])],2)):(m(),f("div",{key:1,class:g(["max-w-xs rounded-2xl bg-white dark:bg-muted-800 p-2",Wt(e)?"rounded-se-none ":"rounded-ss-none"])},[p("div",Ne,[p("img",{loading:"lazy",src:e.attachments[0].image,alt:e.attachments[0].title,class:"transform transition-all duration-300 hover:scale-105"},null,8,Ve)]),p("div",We,[e.attachments[0].title?(m(),f("p",Ue,_(e.attachments[0].title),1)):(m(),f("p",Ge,_(e.attachments[0].url?.replace(/(^\w+:|^)\/\//,"")),1)),p("p",He,_(e.attachments[0].description),1)])],2))])),_:2},1032,["to","class"])])],64))],2)):(m(),f("div",{key:1,class:g(["grid grid-cols-2 gap-2",[Wt(e)?"rounded-se-none":"rounded-ss-none"]])},[(m(!0),f(S,null,j(e.attachments,((e,t)=>(m(),f(S,{key:t},["image"===e.type?(m(),f("div",Me,[p("div",qe,[p("img",{loading:"lazy",src:e.image,alt:e.text,class:"dark:bg-muted-800 rounded-2xl bg-white p-1",onClick:t=>fa(e.image)},null,8,Fe),p("div",{class:"overlay",onClick:t=>fa(e.image)},[h(i,{name:"lucide:zoom-in",class:"h-5 w-5 zoom-icon"})],8,Re)])])):b("",!0)],64)))),128))],2))],64)):(m(),f("div",{key:1,class:g(["bg-muted-200 dark:bg-muted-800 rounded-xl p-4 text-left",Wt(e)?"rounded-se-none":"rounded-ss-none"])},[p("p",Je,_(e.text),1)],2)),p("div",{class:g(["text-muted-400 mt-1 font-sans text-xs",Wt(e)?"text-right":"text-left"])},_(ya(new Date(e.time)))+" ago ",3)])],64)):(m(),f("div",Ke,[Xe,p("div",Ye,[p("span",Ze,_(e.time),1)])]))],10,Se)))),128))],512)):b("",!0)],2),p("form",{method:"POST",action:"",onSubmit:C(ka,["prevent"]),class:"bg-muted-100 dark:bg-muted-900 flex h-16 w-full items-center px-4 sm:px-8"},[p("div",Qe,[h(o,{id:"messageInput",modelValue:w(Jt),"onUpdate:modelValue":s[3]||(s[3]=e=>x(Jt)?Jt.value=e:null),modelModifiers:{trim:!0},disabled:w(Kt),shape:"full",classes:{input:"h-12 ps-6 pe-24"},placeholder:"Write a message..."},null,8,["modelValue","disabled"]),w(ha)?(m(),f("div",et,[h(w(Y),{native:!0,onSelect:va,theme:"auto","display-recent":!0,"disable-skin-tones":!0})])):b("",!0),p("div",tt,[p("button",{type:"button",class:"text-muted-400 hover:text-primary-500 flex h-12 w-10 items-center justify-center transition-colors duration-300",onClick:s[4]||(s[4]=e=>ha.value=!w(ha))},[h(i,{name:"lucide:smile",class:"h-5 w-5"})]),h(F,{icon:"ph:image-duotone","filter-file-dropped":e=>e.type.startsWith("image"),onDrop:s[5]||(s[5]=e=>{Xt.value=e})},null,8,["filter-file-dropped"]),h(R,{accept:"image/*",multiple:"",modelValue:w(Xt),"onUpdate:modelValue":s[6]||(s[6]=e=>x(Xt)?Xt.value=e:null)},{default:v((({open:e,remove:t,preview:a,files:s})=>[p("div",at,[h(i,{name:"lucide:paperclip",class:"h-5 w-5",onClick:e},null,8,["onClick"])])])),_:1},8,["modelValue"])])])],32)])],2),p("div",{class:g(["ltablet:w-[310px] dark:bg-muted-800 fixed end-0 top-0 z-20 h-full w-[390px] bg-white transition-transform duration-500",w(Ft)?"translate-x-full":"translate-x-0"])},[p("div",st,[h(J,{tag:"h3",size:"lg",class:"text-muted-800 dark:text-white"},{default:v((()=>[p("span",null,_(a.$t("Ticket details")),1)])),_:1}),h(u,{small:"",onClick:s[7]||(s[7]=e=>Ft.value=!0)},{default:v((()=>[h(i,{name:"lucide:arrow-right",class:"pointer-events-none h-4 w-4"})])),_:1})]),p("div",lt,[w(Rt)?(m(),f("div",nt,[p("div",it,[h(P,{class:"h-24 w-24 shrink-0 rounded-full",width:96,height:96})]),p("div",rt,[h(P,{class:"mb-2 h-3 w-full max-w-[10rem] rounded"}),h(P,{class:"mb-2 h-3 w-full max-w-[6rem] rounded"}),p("div",ot,[h(P,{class:"mb-2 h-2 w-full max-w-[15rem] rounded"}),h(P,{class:"mb-2 h-2 w-full max-w-[13rem] rounded"})]),p("div",ut,[p("div",ct,[h(P,{class:"h-3 w-[3.5rem] rounded"})]),p("div",dt,[h(P,{class:"h-3 w-[3.5rem] rounded"})])]),p("div",mt,[h(P,{class:"h-10 w-full rounded-xl"}),h(P,{class:"mx-auto mt-3 h-3 w-[7.5rem] rounded"})])])])):(m(),f("div",ft,[p("div",pt,[p("div",ht,[h(A,{src:t.isSupport?w(zt)?.user?.avatar:w(zt)?.agent?.avatar||"/img/avatars/1.svg",size:"2xl",shape:"full"},null,8,["src"])])]),(m(),f("div",{class:"text-center space-y-5 mt-5",key:w(zt)?.status},[p("div",vt,[p("strong",null,_(t.isSupport?"Client":"Agent")+": ",1),p("span",gt,_(t.isSupport?w(zt)?.user?.first_name+" "+w(zt)?.user?.last_name:null!==w(zt)?.chat?.agent?w(zt)?.chat?.agent?.first_name+" "+w(zt)?.chat?.agent?.last_name:"N/A"),1)]),h(J,{as:"h4",size:"lg",weight:"semibold",class:"text-muted-800 dark:text-white"},{default:v((()=>[I(" Ticket: #"+_(w(zt)?.uuid),1)])),_:1}),p("div",wt,[h(K,{color:ba(w(zt)?.status),flavor:"pastel"},{default:v((()=>[I(_(w(zt)?.status),1)])),_:1},8,["color"]),h(K,{color:_a(w(zt)?.importance),flavor:"pastel"},{default:v((()=>[I(_(w(zt)?.importance),1)])),_:1},8,["color"])]),p("div",xt,[p("div",yt,[p("strong",null,_(a.$t("Subject"))+":",1),p("span",kt,_(w(zt)?.subject),1)]),p("div",bt,[p("strong",null,_(a.$t("Created At"))+":",1),p("span",_t,_(new Date(w(zt)?.created_at).toLocaleString()),1)])]),p("div",null,["CLOSED"!==w(zt)?.status?(m(),k(E,{key:0,onClick:s[8]||(s[8]=e=>(async()=>{try{const e=await N(Lt);Ot.response(e),await Et.fetchTickets()}catch(e){Ot.danger(e)}})()),class:"w-full",color:"danger"},{default:v((()=>[h(i,{name:"line-md:close",class:"h-4 w-4"}),p("span",St,_(a.$t("Close Ticket")),1)])),_:1})):b("",!0),t.isSupport&&"CLOSED"===w(zt)?.status?(m(),k(E,{key:1,onClick:s[9]||(s[9]=e=>(async()=>{try{const e=await Ct(Lt);Ot.response(e),await Et.fetchTickets()}catch(e){Ot.danger(e)}})()),class:"w-full",color:"success"},{default:v((()=>[h(i,{name:"line-md:confirm",class:"h-4 w-4"}),p("span",jt,_(a.$t("Open Ticket")),1)])),_:1})):b("",!0)])]))]))])],2)]),h(X),h(It,{visible:w(ma),imgs:[w(da)],onHide:pa},null,8,["visible","imgs"])])}}}),[["__scopeId","data-v-1d51cd51"]]);export{Ct as _};
