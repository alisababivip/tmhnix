import{a as e,z as l,c as a,E as s,ad as t,ac as o,O as d,w as r,o as n,e as u,q as i,t as m,u as p,f as c,b as f,B as b,n as h,F as v,W as _,_ as y,x as B,X as V,Y as g}from"../e/entry-8qgg5CL-.js";import{_ as x}from"./BaseInput.vue-iInHQMIA.js";import{_ as j}from"./BaseSwitchBall.vue-Xcs_6krq.js";import{_ as w}from"./BaseListbox.vue-1Dy9Ui3z.js";import{_ as T}from"./BaseButtonIcon.vue-6tAU_b7C.js";import{_ as U}from"./TairoButtonIcon.vue-KqKLsAHm.js";import{_ as C}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as k}from"./useKyc-y1ecMeTj.js";import{z as S,u as $,t as q,F as M}from"./vee-validate.esm-n59zZCC5.js";import{u as F}from"./template-_415AK_u.js";import"./input-id-wZ-Ta08j.js";import"./IconCheck-JvP9GQU1.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";const E={class:"flex xs:flex-col sm:flex-row justify-start xs:items-start sm:items-center gap-5"},I={class:"flex xs:flex-col sm:flex-row justify-start xs:items-start sm:items-center gap-5"},z={class:"flex justify-between items-center"},K={class:"text-xl font-semibold"},L={class:"grid grid-cols-1 sm:grid-cols-12 gap-5"},N={class:"col-span-1 sm:col-span-4"},D={class:"col-span-1 sm:col-span-3"},O={class:"col-span-1 sm:col-span-5"},P={class:"flex xs:flex-col sm:flex-row justify-start xs:items-start sm:items-center gap-5"},R={class:"sm:pt-6"},A={class:"sm:pt-6"},W={class:"flex items-center justify-center"},Y=e({__name:"[id]",setup(e){const Y=l().params.id,X=F(),{updateKycTemplate:Z}=k(),G=a((()=>X.selectedTemplate||X.getTemplateById(Y)));s((async()=>{const e=Number(Y);0===X.templates.length&&await X.fetchKycTemplates(),X.selectTemplateById(e),X.selectedTemplate||J.push("/admin/kyc/templates")}));const{toast:H}=t(),J=o(),Q=()=>S.object({enabled:S.boolean().nullable().optional().default(!1),required:S.boolean().nullable().optional().default(!1),level:S.enum(["1","2","3"])}),ee=S.object({title:S.string().nonempty(),options:S.object({first_name:Q(),last_name:Q(),email:Q(),phone:Q(),address:Q(),city:Q(),state:Q(),country:Q(),zip:Q(),dob:Q(),ssn:Q(),document_passport:Q(),document_drivers_license:Q(),document_id_card:Q(),custom_fields:S.array(S.object({title:S.string().nonempty(),required:S.boolean().nullable().optional().default(!1),type:S.enum(["input","textarea","file upload"]),level:S.enum(["1","2","3"])}).nullable().optional())})}),le=a((()=>({title:G.value?.title||"",options:G.value?.options||{}}))),{handleSubmit:ae,isSubmitting:se,setFieldValue:te,errors:oe,setFieldError:de}=$({validationSchema:q(ee),initialValues:le}),re=a((()=>X.selectedTemplate?.options?.custom_fields||[])),ne=()=>{const e=[...re.value,{title:"",required:!1,type:"input",level:"1"}];X.selectedTemplate?.options&&X.selectedTemplate.options.custom_fields&&X.selectedTemplate.options.custom_fields.push({title:"",required:!1,type:"input",level:"1"}),te("options.custom_fields",e)},ue=ae((async e=>{if(X.templates.find((l=>l.title===e.title))&&X.selectedTemplate?.title!==e.title)return de("title","Template with this title already exists"),void window.scrollTo({top:0,behavior:"smooth"});try{const l=await Z(Y,e);H.response(l),"success"===l.status&&(await X.fetchKycTemplates(),J.push("/admin/kyc/templates"))}catch(l){H.danger(l)}})),ie={first_name:"First Name",last_name:"Last Name",email:"Email",phone:"Phone",address:"Address",city:"City",state:"State",country:"Country",zip:"Zip",dob:"Date of Birth",ssn:"SSN",document_passport:"Passport",document_drivers_license:"Driver License",document_id_card:"ID Card",custom_fields:"Custom Fields"},me=["document_passport","document_drivers_license","document_id_card"],pe=Object.keys(ee.shape.options.shape).filter((e=>!me.includes(e)&&"custom_fields"!==e));return(e,l)=>{const a=y,s=B,t=V,o=x,k=g,S=j,$=w,q=T,F=U,Y=C;return n(),d(Y,null,{left:r((()=>[u(a,{size:"lg"},{default:r((()=>[i(m(e.$t("Edit"))+" "+m(p(X).selectedTemplate?.title)+" "+m(e.$t("Template")),1)])),_:1})])),right:r((()=>[u(t,{type:"button",color:"muted",to:"/admin/kyc/templates"},{default:r((()=>[u(s,{name:"line-md:chevron-left",class:"h-4 w-4 mr-2"}),i(" "+m(e.$t("Back")),1)])),_:1})])),default:r((()=>[c("form",{action:"",method:"POST",onSubmit:l[0]||(l[0]=_(((...e)=>p(ue)&&p(ue)(...e)),["prevent"])),class:"space-y-10"},[u(k,{class:"p-5 space-y-5"},{default:r((()=>[u(p(M),{name:"title"},{default:r((({field:e,errorMessage:l,handleChange:a,handleBlur:s})=>[u(o,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:p(se),type:"text",label:"Title",placeholder:"Enter template title",shape:"rounded",class:"w-full",onBlur:s},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})])),_:1}),u(k,null,{default:r((()=>[(n(!0),f(v,null,b(p(pe),((e,l)=>(n(),f("div",{key:l,class:h(["p-5 flex xs:flex-col sm:flex-row justify-between items-start gap-5",{" border-b border-muted-300 dark:border-muted-700":"ssn"!==e}])},[c("span",null,m(ie[e]),1),c("div",E,[u(p(M),{name:`options.${e}.enabled`},{default:r((({field:e,errorMessage:l,handleChange:a,handleBlur:s})=>[u(S,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:p(se),onBlur:s,label:"Enabled",color:"success"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:2},1032,["name"]),u(p(M),{name:`options.${e}.required`},{default:r((({field:e,errorMessage:l,handleChange:a,handleBlur:s})=>[u(S,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:p(se),onBlur:s,label:"Required",color:"primary"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:2},1032,["name"]),u(p(M),{name:`options.${e}.level`},{default:r((({field:e,errorMessage:l,handleChange:a,handleBlur:s})=>[u($,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:p(se),onBlur:s,items:["1","2","3"],placeholder:"Select a level",shape:"rounded",condensed:"",class:"min-w-[96px]"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:2},1032,["name"])])],2)))),128))])),_:1}),u(k,null,{default:r((()=>[(n(),f(v,null,b(me,((e,l)=>c("div",{key:l,class:h(["p-5 flex xs:flex-col sm:flex-row justify-between items-start gap-5",{" border-b border-muted-300 dark:border-muted-700":"document_id_card"!==e}])},[c("span",null,m(ie[e]),1),c("div",I,[u(p(M),{name:`options.${e}.enabled`},{default:r((({field:e,errorMessage:l,handleChange:a,handleBlur:s})=>[u(S,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:p(se),onBlur:s,label:"Enabled",color:"success"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:2},1032,["name"]),u(p(M),{name:`options.${e}.required`},{default:r((({field:e,errorMessage:l,handleChange:a,handleBlur:s})=>[u(S,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:p(se),onBlur:s,label:"Required",color:"primary"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:2},1032,["name"]),u(p(M),{name:`options.${e}.level`},{default:r((({field:e,errorMessage:l,handleChange:a,handleBlur:s})=>[u($,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:p(se),onBlur:s,items:["1","2","3"],placeholder:"Select a level",shape:"rounded",condensed:"",class:"min-w-[96px]"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:2},1032,["name"])])],2))),64))])),_:1}),u(k,{class:"p-5 space-y-5"},{default:r((()=>[c("div",z,[c("h3",K,m(e.$t("Custom Fields")),1),u(q,{type:"button",color:"primary",onClick:ne,condensed:""},{default:r((()=>[u(s,{name:"line-md:plus",class:"h-5 w-5"})])),_:1})]),(n(!0),f(v,null,b(p(re),((e,l)=>(n(),f("div",{key:l,class:"space-y-4"},[c("div",L,[c("div",N,[u(p(M),{name:`options.custom_fields[${l}].title`},{default:r((({field:e,errorMessage:l,handleChange:a,handleBlur:s})=>[u(o,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:p(se),onBlur:s,type:"text",label:"Field Title",placeholder:"Ex: username",shape:"rounded",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:2},1032,["name"])]),c("div",D,[u(p(M),{name:`options.custom_fields[${l}].type`},{default:r((({field:e,errorMessage:l,handleChange:a,handleBlur:s})=>[u($,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:p(se),onBlur:s,label:"Field Type",items:["input","textarea","file upload"],placeholder:"Select a type",shape:"rounded"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:2},1032,["name"])]),c("div",O,[c("div",P,[u(p(M),{name:`options.custom_fields[${l}].level`},{default:r((({field:e,errorMessage:l,handleChange:a,handleBlur:s})=>[u($,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:p(se),onBlur:s,items:["1","2","3"],label:"Field Level",placeholder:"Select a level",shape:"rounded",class:"min-w-[96px]"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:2},1032,["name"]),c("span",R,[u(p(M),{name:`options.custom_fields[${l}].required`},{default:r((({field:e,errorMessage:l,handleChange:a,handleBlur:s})=>[u(S,{modelValue:e.value,"onUpdate:modelValue":[l=>e.value=l,a],error:l,disabled:p(se),onBlur:s,label:"Required",color:"primary"},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:2},1032,["name"])]),c("span",A,[u(F,{type:"button",color:"danger",onClick:e=>(e=>{const l=(X.selectedTemplate.options?.custom_fields||[]).slice();l.splice(e,1),X.selectedTemplate.options&&(X.selectedTemplate.options.custom_fields=l),te("options.custom_fields",l)})(l)},{default:r((()=>[u(s,{name:"line-md:close",class:"h-4 w-4"})])),_:2},1032,["onClick"])])])])])])))),128))])),_:1}),c("div",W,[u(k,{class:"p-2 w-64"},{default:r((()=>[u(t,{disabled:p(se),loading:p(se),block:!0,color:"primary",type:"submit",class:"w-full"},{default:r((()=>[i(" Save ")])),_:1},8,["disabled","loading"])])),_:1})])],32)])),_:1})}}});export{Y as default};
