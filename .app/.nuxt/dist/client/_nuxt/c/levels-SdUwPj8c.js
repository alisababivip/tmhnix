import{a as e,U as a,Q as t,c as s,ad as l,b as r,f as n,e as i,w as u,W as d,Y as o,av as m,o as c,q as v,t as g,l as p,O as _,u as f,F as b,B as y,_ as h,a0 as w,X as S}from"../e/entry-8qgg5CL-.js";import{_ as x}from"./BaseInput.vue-iInHQMIA.js";import{_ as $,a as j}from"./BaseList.vue-M2vzPMWB.js";import{t as B,u as L,F as O,z as P}from"./vee-validate.esm-n59zZCC5.js";import"./input-id-wZ-Ta08j.js";const k={class:"flex items-center justify-between p-4"},C={class:"flex items-center gap-2"},M={class:"px-8"},U={class:"mx-auto space-y-12 py-8"},V={class:"grid grid-cols-12 gap-4 pt-2"},z={class:"col-span-12 pt-5 border-t border-gray-300 dark:border-gray-700"},A=e({__name:"levels",setup(e){const{updateSettings:A}=a(),E=t(),F=s((()=>E.settings)),{toast:T}=l(),q=s((()=>E.settings.mlm_system?E.settings.mlm_system.toLowerCase():"direct")),I=s((()=>E.settings.mlm_settings[q.value]?.levels||3)),J=s((()=>{let e={};for(let a=1;a<=I.value;a++)e[`level_${a}_percentage`]=P.number().min(0).max(100);return P.object(e)})),N=B(J.value),Q=s((()=>{let e={};(Array.isArray(E.settings.mlm_settings[q.value]?.levels_percentage)?E.settings.mlm_settings[q.value].levels_percentage:[]).forEach((a=>{e[`level_${a.level}_percentage`]=a.value}));for(let a=1;a<=I.value;a++)e[`level_${a}_percentage`]>=0||(e[`level_${a}_percentage`]=0);return e})),{handleSubmit:R,meta:W,values:X,isSubmitting:Y}=L({validationSchema:N,initialValues:Q}),D=R((async e=>{try{const a=[];for(let n=1;n<=I.value;n++)a.push({level:n,value:e[`level_${n}_percentage`]});const t={...E.settings.mlm_settings,[q.value]:{...E.settings.mlm_settings[q.value],levels_percentage:a}},s=JSON.stringify(t),l={...F.value,mlm_settings:s},r=await A(l);T.response(r),"success"===r.status&&E.setSettings(Object.values(r.data.result))}catch(a){T.danger(a)}}));return(e,a)=>{const t=h,s=w,l=S,B=x,L=$,P=j,A=o,E=m("can");return c(),r("div",null,[n("form",{method:"POST",action:"",class:"w-full pb-16",onSubmit:a[0]||(a[0]=d(((...e)=>f(D)&&f(D)(...e)),["prevent"]))},[i(A,null,{default:u((()=>[n("div",k,[n("div",null,[i(t,{tag:"h2",size:"sm",weight:"medium",lead:"normal",class:"uppercase tracking-wider"},{default:u((()=>[v(g(e.$t("Levels Percentage")),1)])),_:1}),i(s,{size:"xs",class:"text-muted-400"},{default:u((()=>[v(g(e.$t("Set the percentage for each level")),1)])),_:1})]),n("div",C,[p((c(),_(l,{type:"submit",color:"primary",class:"w-24",disabled:f(Y)||!f(W).dirty,loading:f(Y)},{default:u((()=>[v(g(e.$t("Save")),1)])),_:1},8,["disabled","loading"])),[[E,"Edit Settings"]])])]),n("div",M,[n("div",U,[n("div",V,[(c(!0),r(b,null,y(f(I),(e=>(c(),r("div",{class:"col-span-4 sm:col-span-3",key:`level_${e}_percentage`},[i(f(O),{name:`level_${e}_percentage`},{default:u((({field:a,errorMessage:t,handleBlur:s,handleChange:l})=>[i(B,{"model-value":a.value,error:t,disabled:f(Y),type:"number",min:"0",max:"100",placeholder:"0",label:`Level ${e} Percentage`,"onUpdate:modelValue":l,onBlur:s},null,8,["model-value","error","disabled","label","onUpdate:modelValue","onBlur"])])),_:2},1032,["name"])])))),128)),n("div",z,[i(P,null,{default:u((()=>[i(L,{title:"MLM Rewards System",subtitle:"Client referrer will get last level percentage * condition reward, next upline will get the next level percentage of the condition reward, and so on."})])),_:1})])])])])])),_:1})],32)])}}});export{A as default};
