import{_ as e}from"./BaseInput.vue-iInHQMIA.js";import{_ as a}from"./BaseSelect.vue-p0KYznCX.js";import{a as l,z as s,r as t,c as o,E as i,ad as n,ac as u,b as r,e as c,w as d,u as m,an as p,o as f,p as v,f as h,t as g,q as b,O as _,F as w,B as k,k as j,x,X as y,ag as C,ao as D}from"../e/entry-8qgg5CL-.js";import{_ as $,a as B}from"./FlexTableRow.vue-LmGXINIn.js";import{_ as T}from"./FlexTableCell.vue-Rbj2Whgl.js";import{_ as V}from"./BaseTag.vue-NMkN1Uk8.js";import{_ as P,a as A}from"./BaseDropdown.vue-wSpyT9xX.js";import{_ as E}from"./TairoFlexTable-zdoraqRc.js";import{_ as F}from"./BasePagination.vue-eKZkqxB7.js";import{_ as I}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as L}from"./useEcommerce-2nLxpPKu.js";import{a as N}from"./strings-rQgUKePI.js";import{_ as U,a as z}from"./placeholder-search-4-dark-Jht91LnM.js";import{u as q}from"./discounts-4CSnF0MZ.js";import"./input-id-wZ-Ta08j.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./menu-KWZreDHB.js";import"./use-text-value-9iwzs_EA.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";const O={value:10},R={value:25},S={value:50},X={value:100},G=h("img",{class:"block dark:hidden",src:U,alt:"Placeholder image"},null,-1),M=h("img",{class:"hidden dark:block",src:z,alt:"Placeholder image"},null,-1),W={key:1,class:"w-full"},H={class:"mt-6"},J={class:"flex items-center justify-between p-4"},K={class:"text-lg font-medium"},Q={class:"p-4"},Y={class:"text-center"},Z={class:"text-lg font-medium"},ee={class:"text-sm my-3"},ae={class:"flex justify-end gap-x-2 p-4"},le=l({__name:"index",setup(l){const U=q(),{deleteAdminDiscount:z}=L(),le=s(),se=t(""),te=t(10),oe=o((()=>parseInt(le.query.page??"1",10))),ie=o((()=>U.discounts.filter((e=>e.code.toLowerCase().includes(se.value.toLowerCase()))))),ne=o((()=>{const e=(oe.value-1)*te.value,a=e+te.value;return ie.value.slice(e,a)}));i((async()=>{0===U.discounts.length&&(U.loading=!0,await U.fetchDiscounts(),U.loading=!1)}));const{toast:ue}=n(),re=u();const ce=t(!1),de=t(!1),me=t(null);const pe=e=>{switch(e){case"ACTIVE":return"success";case"EXPIRED":return"danger";case"UPCOMING":return"warning";default:return"info"}};return(l,s)=>{const t=e,o=a,i=x,n=y,u=C,L=$,q=T,le=V,fe=P,ve=A,he=B,ge=E,be=F,_e=I,we=D,ke=p;return f(),r("div",null,[c(_e,null,{left:d((()=>[c(t,{modelValue:m(se),"onUpdate:modelValue":s[0]||(s[0]=e=>v(se)?se.value=e:null),icon:"lucide:search",classes:{wrapper:"w-full sm:w-auto"},placeholder:"Filter discounts..."},null,8,["modelValue"]),c(o,{modelValue:m(te),"onUpdate:modelValue":s[1]||(s[1]=e=>v(te)?te.value=e:null),label:"",classes:{wrapper:"w-full sm:w-40"}},{default:d((()=>[h("option",O,"10 "+g(l.$t("per page")),1),h("option",R,"25 "+g(l.$t("per page")),1),h("option",S,"50 "+g(l.$t("per page")),1),h("option",X,"100 "+g(l.$t("per page")),1)])),_:1},8,["modelValue"])])),right:d((()=>[c(n,{color:"primary",to:"/admin/extensions/ecommerce/discounts/create"},{default:d((()=>[c(i,{name:"lucide:plus",size:"16",class:"mr-2"}),b(" "+g(l.$t("Create"))+" Discount ",1)])),_:1})])),default:d((()=>[h("div",null,[m(U).loading||0!==m(ne).length?(f(),r("div",W,[c(ge,{class:"pt-5"},{default:d((()=>[(f(!0),r(w,null,k(m(ne),((e,a)=>(f(),_(he,{key:e.id,spaced:""},{start:d((()=>[c(L,{label:"Code","hide-label":a>0,title:e.code,subtitle:`Valid Until ${("formatDate"in l?l.formatDate:m(N))(e.valid_until)}`},null,8,["hide-label","title","subtitle"])])),end:d((()=>[c(q,{label:"Product","hide-label":a>0,class:"w-28 xs:w-full text-xs"},{default:d((()=>[b(g(e.product?.name),1)])),_:2},1032,["hide-label"]),c(q,{label:"Discount","hide-label":a>0,class:"w-20 xs:w-full"},{default:d((()=>[b(g(e.percentage)+"%",1)])),_:2},1032,["hide-label"]),c(q,{label:"Status","hide-label":a>0,class:"w-20 xs:w-full"},{default:d((()=>[c(le,{color:pe(e.status),flavor:"pastel",condensed:""},{default:d((()=>[b(g(e.status),1)])),_:2},1032,["color"])])),_:2},1032,["hide-label"]),c(q,{label:"Actions","hide-label":a>0},{default:d((()=>[c(ve,{flavor:"context",label:"Actions",orientation:"end"},{default:d((()=>[c(fe,{onClick:a=>function(e){U.selectDiscount(e),re.push(`/admin/extensions/ecommerce/discounts/edit/${e.id}`)}(e),title:"Edit Discount"},{start:d((()=>[c(i,{name:"line-md:edit-twotone",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"]),c(fe,{onClick:a=>function(e){me.value=e,ce.value=!0}(e),title:"Delete Discount"},{start:d((()=>[c(i,{name:"line-md:close",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["hide-label"])])),_:2},1024)))),128))])),_:1})])):(f(),_(u,{key:0,title:m(se)&&""!==m(se)?"No matching results":"No results",subtitle:m(se)&&""!==m(se)?"Looks like we couldn't find any matching results for your search terms. Try other search terms.":"Looks like we don't have any data here yet."},{image:d((()=>[G,M])),_:1},8,["title","subtitle"])),h("div",H,[m(ie).length>m(te)?(f(),_(be,{key:0,"total-items":m(ie).length,"current-page":m(oe),"item-per-page":m(te)},null,8,["total-items","current-page","item-per-page"])):j("",!0)])])])),_:1}),c(ke,{open:m(ce),size:"sm",onClose:s[5]||(s[5]=e=>ce.value=!1)},{header:d((()=>[h("div",J,[h("h3",K,g(l.$t("Delete"))+" "+g(l.$t("Discount")),1),c(we,{onClick:s[2]||(s[2]=e=>ce.value=!1)})])])),footer:d((()=>[h("div",ae,[c(n,{onClick:s[3]||(s[3]=e=>ce.value=!1)},{default:d((()=>[b(g(l.$t("Cancel")),1)])),_:1}),c(n,{color:"danger",onClick:s[4]||(s[4]=e=>async function(){if(me.value){de.value=!0;try{const e=await z(me.value.id);ue.response(e),"success"===e.status&&U.removeDiscount(me.value.id)}catch(e){ue.danger(e)}ce.value=!1,de.value=!1,me.value=null}}()),disabled:m(de),loading:m(de)},{default:d((()=>[b(g(l.$t("Delete")),1)])),_:1},8,["disabled","loading"])])])),default:d((()=>[h("div",Q,[h("div",Y,[h("h3",Z,g(l.$t("Are you sure?")),1),h("p",ee,g(l.$t("Do you really want to delete this discount? This process cannot be undone.")),1)])])])),_:1},8,["open"])])}}});export{le as default};
