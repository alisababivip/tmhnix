import{_ as e}from"./BaseInput.vue-iInHQMIA.js";import{_ as a}from"./BaseSelect.vue-p0KYznCX.js";import{a as l,z as t,ad as s,r as o,c as d,ac as u,E as r,b as n,e as i,w as c,u as m,an as p,o as g,p as v,f,t as h,q as x,O as b,af as w,F as y,B as k,k as _,x as T,X as C,ag as $,ao as j}from"../e/entry-8qgg5CL-.js";import{_ as V,a as B}from"./FlexTableRow.vue-LmGXINIn.js";import{_ as U}from"./FlexTableCell.vue-Rbj2Whgl.js";import{_ as S,a as D}from"./BaseDropdown.vue-wSpyT9xX.js";import{_ as F}from"./TairoFlexTable-zdoraqRc.js";import{_ as q}from"./BasePagination.vue-eKZkqxB7.js";import{_ as N}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{u as P}from"./useBlog-0Y19BpbN.js";import{_ as W,a as z}from"./placeholder-search-4-dark-Jht91LnM.js";import{u as M}from"./tag-Rn_CdU8R.js";import{z as A,u as E,t as I,F as L}from"./vee-validate.esm-n59zZCC5.js";import"./input-id-wZ-Ta08j.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./menu-KWZreDHB.js";import"./use-text-value-9iwzs_EA.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";const O={value:10},R={value:25},X={value:50},G={value:100},H={class:"w-full"},J=f("img",{class:"block dark:hidden",src:W,alt:"Placeholder image"},null,-1),K=f("img",{class:"hidden dark:block",src:z,alt:"Placeholder image"},null,-1),Q={key:1,class:"w-full sm:pt-5"},Y={class:"mt-6"},Z={class:"flex w-full items-center justify-between p-4 md:p-6"},ee={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},ae={class:"p-4 md:p-6"},le={class:"mx-auto w-full text-center"},te={class:"font-heading text-muted-800 text-lg font-medium leading-6 dark:text-white"},se={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},oe={class:"p-4 md:p-6"},de={class:"flex gap-x-2"},ue={class:"flex w-full items-center justify-between p-4 md:p-6"},re={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},ne={class:"p-4 md:p-6"},ie={class:"mx-auto w-full text-start"},ce={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},me={class:"space-y-2"},pe={class:"p-4 md:p-6"},ge={class:"flex gap-x-2"},ve={class:"flex w-full items-center justify-between p-4 md:p-6"},fe={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},he={class:"p-4 md:p-6"},xe={class:"mx-auto w-full text-start"},be={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},we={class:"space-y-2"},ye={class:"p-4 md:p-6"},ke={class:"flex gap-x-2"},_e=l({__name:"index",setup(l){const W=M(),z=t(),{toast:_e}=s(),{updateTag:Te,deleteTag:Ce,createTag:$e}=P(),je=o(!1),Ve=o(""),Be=o(10),Ue=d((()=>parseInt(z.query.page??"1"))),Se=u(),De=o(""),Fe=d((()=>W.tags));r((async()=>{je.value=!0,0===W.tags.length&&await W.fetchTags(),je.value=!1}));const qe=d((()=>Fe.value.filter((e=>(Ve.value&&""!==Ve.value&&void 0!==Ve.value&&Ve.value!==De.value&&(Se.push({query:{...z.query,page:"1",filter:Ve.value}}),De.value=Ve.value),!Ve.value||e.name?.includes(Ve.value)))).sort(((e,a)=>new Date(a.created_at).getTime()-new Date(e.created_at).getTime())))),Ne=d((()=>{const e=(Ue.value-1)*Be.value,a=e+Be.value;return qe.value.slice(e,a)})),Pe=o(!1),We=o(!1);const ze=A.object({name:A.string().nonempty("Name is required"),slug:A.string().nonempty("Slug is required")}),Me=d((()=>({name:"",slug:""}))),{isSubmitting:Ae,setFieldValue:Ee,handleSubmit:Ie}=E({validationSchema:I(ze),initialValues:Me}),Le=o(!1);const Oe=Ie((async e=>{if(e.slug!==W.selectedTag?.slug){if(W.tags.find((a=>a.slug===e.slug)))return void _e.dangerText("Slug already exists")}Ae.value=!0;try{const a=await Te(W.selectedTag?.id,e);W.tags=W.tags.map((a=>a.id===W.selectedTag?.id?{...a,...e}:a)),_e.response(a)}catch(a){_e.danger(a)}Le.value=!1,Ae.value=!1,W.selectedTag=null})),Re=o(!1);function Xe(){Re.value=!0}const Ge=Ie((async e=>{if(W.tags.find((a=>a.slug===e.slug)))_e.dangerText("Slug already exists");else{Ae.value=!0;try{const a=await $e(e);W.tags.push(a.data.result),_e.response(a)}catch(a){_e.danger(a)}Re.value=!1,Ae.value=!1,W.selectedTag=null}}));return(l,t)=>{const s=e,o=a,d=T,u=C,r=$,P=V,z=U,M=S,A=D,E=B,I=F,Te=q,$e=N,Se=j,De=p;return g(),n("div",null,[i($e,null,{left:c((()=>[i(s,{modelValue:m(Ve),"onUpdate:modelValue":t[0]||(t[0]=e=>v(Ve)?Ve.value=e:null),icon:"lucide:search",classes:{wrapper:"w-full sm:w-auto"},placeholder:"Search Tag Name..."},null,8,["modelValue"]),i(o,{modelValue:m(Be),"onUpdate:modelValue":t[1]||(t[1]=e=>v(Be)?Be.value=e:null),label:"",classes:{wrapper:"w-full sm:w-40"}},{default:c((()=>[f("option",O,"10 "+h(l.$t("per page")),1),f("option",R,"25 "+h(l.$t("per page")),1),f("option",X,"50 "+h(l.$t("per page")),1),f("option",G,"100 "+h(l.$t("per page")),1)])),_:1},8,["modelValue"])])),right:c((()=>[f("div",H,[i(u,{color:"primary",flavor:"solid",onClick:Xe,disabled:m(Ae),loading:m(Ae)},{default:c((()=>[i(d,{name:"line-md:plus",class:"me-2 block h-5 w-5"}),x(" "+h(l.$t("Create"))+" "+h(l.$t("Tag")),1)])),_:1},8,["disabled","loading"])])])),default:c((()=>[f("div",null,[m(je)||0!==m(Ne)?.length?(g(),n("div",Q,[i(I,null,{default:c((()=>[i(w,{"enter-active-class":"transform-gpu","enter-from-class":"opacity-0 -translate-x-full","enter-to-class":"opacity-100 translate-x-0","leave-active-class":"absolute transform-gpu","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 -translate-x-full"},{default:c((()=>[(g(!0),n(y,null,k(m(Ne),((e,a)=>(g(),b(E,{key:e.id,spaced:""},{start:c((()=>[i(P,{label:"Tag","hide-label":a>0,title:e.name,subtitle:e.slug},null,8,["hide-label","title","subtitle"])])),end:c((()=>[i(z,{label:"Posts","hide-label":a>0,class:"w-20 xs:w-full"},{default:c((()=>[x(h(e.post_tag?.length||0),1)])),_:2},1032,["hide-label"]),i(z,{label:"Actions","hide-label":a>0,class:"w-20 xs:justify-end xs:w-full"},{default:c((()=>[i(A,{flavor:"context",label:"Dropdown",orientation:"end"},{default:c((()=>[i(M,{to:`/blog/tags/${e.slug}`,title:"View Tag"},{start:c((()=>[i(d,{name:"ph:eye-duotone",class:"me-2 block h-5 w-5"})])),_:2},1032,["to"]),i(M,{onClick:a=>{return l=e,W.selectedTag=l,Ee("name",l.name),Ee("slug",l.slug),void(Le.value=!0);var l},title:"Edit Tag"},{start:c((()=>[i(d,{name:"line-md:edit-twotone",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"]),i(M,{onClick:a=>function(e){W.selectedTag=e,Pe.value=!0}(e),title:"Delete Tag"},{start:c((()=>[i(d,{name:"line-md:close",class:"me-2 block h-5 w-5"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["hide-label"])])),_:2},1024)))),128))])),_:1})])),_:1})])):(g(),b(r,{key:0,title:m(Ve)&&""!==m(Ve)?"No matching results":"No results",subtitle:m(Ve)&&""!==m(Ve)?"Looks like we couldn't find any matching results for your search terms. Try other search terms.":"Looks like we don't have any data here yet."},{image:c((()=>[J,K])),_:1},8,["title","subtitle"])),f("div",Y,[m(qe).length>m(Be)?(g(),b(Te,{key:0,"total-items":m(qe).length,"current-page":m(Ue),"item-per-page":m(Be)},null,8,["total-items","current-page","item-per-page"])):_("",!0)])])])),_:1}),i(De,{open:m(Pe),size:"sm",onClose:t[5]||(t[5]=e=>Pe.value=!1)},{header:c((()=>[f("div",Z,[f("h3",ee,h(l.$t("Delete"))+" "+h(l.$t("Tag")),1),i(Se,{onClick:t[2]||(t[2]=e=>Pe.value=!1)})])])),footer:c((()=>[f("div",oe,[f("div",de,[i(u,{onClick:t[3]||(t[3]=e=>Pe.value=!1)},{default:c((()=>[x(h(l.$t("Cancel")),1)])),_:1}),i(u,{color:"danger",flavor:"solid",onClick:t[4]||(t[4]=e=>async function(){We.value=!0;try{const e=await Ce(W.selectedTag?.id);_e.response(e),"success"===e.status&&(W.tags=W.tags.filter((e=>e.id!==W.selectedTag?.id)))}catch(e){_e.danger(e)}Pe.value=!1,We.value=!1,W.selectedTag=null}()),disabled:m(We),loading:m(We)},{default:c((()=>[x(h(l.$t("Delete")),1)])),_:1},8,["disabled","loading"])])])])),default:c((()=>[f("div",ae,[f("div",le,[f("h3",te,h(l.$t("Are you sure?")),1),f("p",se,h(l.$t("Do you really want to delete this"))+" "+h(l.$t("tag"))+" "+h(l.$t("This process cannot be undone"))+". ",1)])])])),_:1},8,["open"]),i(De,{open:m(Le),size:"sm",onClose:t[8]||(t[8]=e=>Le.value=!1)},{header:c((()=>[f("div",ue,[f("h3",re,h(l.$t("Edit"))+" "+h(l.$t("Tag")),1),i(Se,{onClick:t[6]||(t[6]=e=>Le.value=!1)})])])),footer:c((()=>[f("div",pe,[f("div",ge,[i(u,{onClick:t[7]||(t[7]=e=>Le.value=!1)},{default:c((()=>[x(h(l.$t("Cancel")),1)])),_:1}),i(u,{color:"primary",flavor:"solid",onClick:m(Oe),disabled:m(Ae),loading:m(Ae)},{default:c((()=>[x(h(l.$t("Update")),1)])),_:1},8,["onClick","disabled","loading"])])])])),default:c((()=>[f("div",ne,[f("div",ie,[f("p",ce,h(l.$t("Please update the"))+" "+h(l.$t("tag"))+" "+h(l.$t("details"))+". ",1),f("div",me,[i(m(L),{name:"name"},{default:c((({field:e,errorMessage:a,handleChange:l,handleBlur:t})=>[i(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:m(Ae),type:"text",label:"Name",placeholder:"Write a name",shape:"curved",classes:{input:"h-12",wrapper:"max-w-xs"},onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),i(m(L),{name:"slug"},{default:c((({field:e,errorMessage:a,handleChange:l,handleBlur:t})=>[i(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:m(Ae),type:"text",label:"Slug",placeholder:"Write a slug",shape:"curved",classes:{input:"h-12",wrapper:"max-w-xs"},onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})])])])])),_:1},8,["open"]),i(De,{open:m(Re),size:"sm",onClose:t[11]||(t[11]=e=>Re.value=!1)},{header:c((()=>[f("div",ve,[f("h3",fe,h(l.$t("Create"))+" "+h(l.$t("Tag")),1),i(Se,{onClick:t[9]||(t[9]=e=>Re.value=!1)})])])),footer:c((()=>[f("div",ye,[f("div",ke,[i(u,{onClick:t[10]||(t[10]=e=>Re.value=!1)},{default:c((()=>[x(h(l.$t("Cancel")),1)])),_:1}),i(u,{color:"primary",flavor:"solid",onClick:m(Ge),disabled:m(Ae),loading:m(Ae)},{default:c((()=>[x(h(l.$t("Create")),1)])),_:1},8,["onClick","disabled","loading"])])])])),default:c((()=>[f("div",he,[f("div",xe,[f("p",be,h(l.$t("Please enter the"))+" "+h(l.$t("tag"))+" "+h(l.$t("details"))+". ",1),f("div",we,[i(m(L),{name:"name"},{default:c((({field:e,errorMessage:a,handleChange:l,handleBlur:t})=>[i(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:m(Ae),type:"text",label:"Name",placeholder:"Write a name",shape:"curved",classes:{input:"h-12",wrapper:"max-w-xs"},onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),i(m(L),{name:"slug"},{default:c((({field:e,errorMessage:a,handleChange:l,handleBlur:t})=>[i(s,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,l],error:a,disabled:m(Ae),type:"text",label:"Slug",placeholder:"Write a slug",shape:"curved",classes:{input:"h-12",wrapper:"max-w-xs"},onBlur:t},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})])])])])),_:1},8,["open"])])}}});export{_e as default};
