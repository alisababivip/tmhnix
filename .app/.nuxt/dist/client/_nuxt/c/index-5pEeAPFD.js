import{_ as e}from"./BaseInput.vue-iInHQMIA.js";import{d as a,a as t,ad as l,z as s,r as o,c as n,E as i,b as r,e as d,w as u,u as c,an as m,o as p,p as f,f as v,t as x,F as g,B as h,af as y,O as w,q as k,k as b,x as _,X as j,s as C,Y as D,ag as B,_ as S,g as V,ao as $}from"../e/entry-8qgg5CL-.js";import{_ as P}from"./TairoButtonIcon.vue-KqKLsAHm.js";import{_ as I}from"./BasePagination.vue-eKZkqxB7.js";import{_ as A}from"./TairoContentWrapper.vue-JqAKR4O_.js";import{_ as U}from"./BaseListbox.vue-1Dy9Ui3z.js";import{u as T}from"./useStaking-1DgbeL2_.js";import{_ as z,a as F}from"./placeholder-search-1-dark-6GG3FkNl.js";import{z as E,u as L,t as M,F as q}from"./vee-validate.esm-n59zZCC5.js";import{u as N}from"./pools-MsQdbYRA.js";import"./input-id-wZ-Ta08j.js";import"./BaseFocusLoop.vue-E4yqAJcg.js";import"./BaseIconBox.vue-qjQCKz6R.js";import"./BaseAvatar.vue-XYSxxLJP.js";import"./use-text-value-9iwzs_EA.js";const O=a({id:"adminStakingDurations",state:()=>({durations:[],loading:!1}),getters:{getDurationById:e=>a=>e.durations.find((e=>e.id===a))},actions:{async fetchStakingDurations(){this.loading=!0;try{const{getAdminStakingDurations:e}=T(),a=await e();this.durations=a.data.result}catch(e){console.error("Error fetching staking durations:",e)}this.loading=!1},async addDuration(e){this.durations.push(e)},async removeDuration(e){const a=this.durations.findIndex((a=>a.id===e));-1!==a&&this.durations.splice(a,1)}}}),W={class:"pb-10"},X={class:"w-full"},Y={key:0,class:"space-y-4"},G={class:"flex flex-col items-center justify-center gap-3 text-center sm:flex-row sm:justify-start sm:text-left"},H={class:"space-y-2"},J={class:"flex flex-col gap-4 pt-4 sm:ms-auto sm:flex-row sm:items-center sm:justify-end sm:pt-0"},K={class:"flex w-full items-center justify-center sm:w-[160px] sm:justify-end"},Q={class:"ptablet:hidden divide-muted-200 dark:divide-muted-700 flex items-center justify-center divide-x"},R={class:"flex flex-col gap-1 px-4 text-center"},Z={class:"flex flex-col gap-1 px-4 text-center"},ee={class:"flex flex-col gap-1 px-4 text-center"},ae={class:"ptablet:hidden flex w-full items-center justify-center gap-1 py-3 sm:w-[160px] sm:justify-end sm:py-0"},te={class:"sm:ms-6"},le={key:1},se=v("img",{class:"block dark:hidden",src:z,alt:"Placeholder image"},null,-1),oe=v("img",{class:"hidden dark:block",src:F,alt:"Placeholder image"},null,-1),ne={key:2,class:"space-y-4"},ie={class:"flex flex-col items-center justify-start gap-3 text-center sm:flex-row sm:justify-start sm:text-left"},re={class:"flex flex-col gap-4 pt-4 sm:ms-auto sm:flex-row sm:items-center sm:justify-end sm:pt-0"},de={class:"divide-muted-200 dark:divide-muted-700 flex items-center justify-center divide-x"},ue={class:"flex flex-col gap-1 px-4 text-center"},ce={class:"flex w-full items-center justify-between p-4 md:p-6"},me={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},pe={class:"p-4 md:p-6"},fe={class:"mx-auto w-full text-start"},ve={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},xe={class:"space-y-3"},ge={class:"p-4 md:p-6"},he={class:"flex gap-x-2"},ye={class:"flex w-full items-center justify-between p-4 md:p-6"},we={class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"},ke={class:"p-4 md:p-6"},be={class:"mx-auto w-full text-center"},_e={class:"font-heading text-muted-800 text-lg font-medium leading-6 dark:text-white"},je={class:"font-alt text-muted-500 dark:text-muted-400 text-sm leading-5 mb-3"},Ce={class:"p-4 md:p-6"},De={class:"flex gap-x-2"},Be=t({__name:"index",setup(a){const t=N(),{toast:z}=l(),F=s(),Be=o(!0),{createAdminStakingDuration:Se,deleteAdminStakingDuration:Ve}=T(),$e=O(),Pe=n((()=>$e.durations)),Ie=n((()=>t.pools?.map((e=>({label:e.name,value:e.id})))));i((async()=>{Be.value=!0,0===t.pools.length&&await t.fetchStakingPools(),0===$e.durations.length&&await $e.fetchStakingDurations(),Be.value=!1}));const Ae=o(""),Ue=o(10),Te=n((()=>parseInt(F.query.page??"1"))),ze=o(!1),Fe=n((()=>Pe.value&&Array.isArray(Pe.value)?Pe.value.filter((e=>e.duration.toString().includes(Ae.value))):[])),Ee=n((()=>{const e=(Te.value-1)*Ue.value,a=e+Ue.value;return Fe.value.slice(e,a)})),Le=E.object({duration:E.number().gt(0,"Maximum amount must be greater than 0"),interest_rate:E.number().gt(0,"Interest rate must be greater than 0"),pool_id:E.object({label:E.string(),value:E.number().nullable()})}),Me=n((()=>({duration:1,interest_rate:0,pool_id:{label:"Please select a pool",value:null}}))),{handleSubmit:qe,isSubmitting:Ne,meta:Oe,resetForm:We}=L({validationSchema:M(Le),initialValues:Me}),Xe=qe((async e=>{if(e.pool_id.value){try{const a=await Se(e.pool_id.value,e.duration,e.interest_rate);z.response(a),"success"===a.status&&(await $e.fetchStakingDurations(),We())}catch(a){z.danger(a)}ze.value=!1}else z.dangerText("Please select a pool")})),Ye=o(!1),Ge=o(!1),He=o(null);return(a,t)=>{const l=e,s=_,o=j,n=C,i=D,T=B,F=S,E=V,L=P,M=I,N=A,O=$,Se=U,Fe=m;return p(),r("div",W,[d(N,null,{left:u((()=>[d(l,{modelValue:c(Ae),"onUpdate:modelValue":t[0]||(t[0]=e=>f(Ae)?Ae.value=e:null),icon:"lucide:search",placeholder:"Filter durations...",classes:{wrapper:"w-full sm:w-auto"}},null,8,["modelValue"])])),right:u((()=>[v("div",X,[d(o,{color:"primary",class:"w-full",onClick:t[1]||(t[1]=e=>ze.value=!0)},{default:u((()=>[d(s,{name:"line-md:plus",class:"h-4 w-4"}),v("span",null,x(a.$t("Create Duration")),1)])),_:1})])])),default:u((()=>[v("div",null,[c(Be)?(p(),r("div",Y,[(p(),r(g,null,h(3,(e=>d(i,{key:e,class:"flex flex-col p-5 sm:flex-row sm:items-center"},{default:u((()=>[v("div",G,[d(n,{class:"h-16 w-16 shrink-0 rounded-full"}),v("div",H,[d(n,{class:"mx-auto h-3 w-[100px] rounded-lg sm:mx-0"}),d(n,{class:"mx-auto h-3 w-[75px] rounded-lg sm:mx-0"})])]),v("div",J,[v("div",K,[d(n,{class:"h-6 w-24 rounded-full"})]),v("div",Q,[v("div",R,[d(n,{class:"h-3 w-16 rounded-lg"})]),v("div",Z,[d(n,{class:"h-3 w-16 rounded-lg"})]),v("div",ee,[d(n,{class:"h-3 w-16 rounded-lg"})])]),v("div",ae,[d(n,{class:"h-8 w-8 shrink-0 rounded-full"}),d(n,{class:"h-8 w-8 shrink-0 rounded-full"}),d(n,{class:"hidden h-3 w-12 rounded-full sm:block"})]),v("div",te,[d(n,{class:"mx-auto h-8 w-40 rounded-lg sm:mx-0 sm:w-20"})])])])),_:2},1024))),64))])):c(Be)||0!==c(Ee).length?(p(),r("div",ne,[d(y,{"enter-active-class":"transform-gpu","enter-from-class":"opacity-0 -translate-x-full","enter-to-class":"opacity-100 translate-x-0","leave-active-class":"absolute transform-gpu","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 -translate-x-full"},{default:u((()=>[(p(!0),r(g,null,h(c(Ee),(e=>(p(),w(i,{key:e.id,class:"flex flex-col py-3 px-4 sm:flex-row sm:items-center"},{default:u((()=>[v("div",ie,[d(F,{tag:"h3",size:"md",weight:"medium",class:"text-muted-800 dark:text-muted-100"},{default:u((()=>[k(x(e.duration)+" "+x(e.duration>1?"days":"day"),1)])),_:2},1024)]),v("div",re,[v("div",de,[v("div",ue,[d(F,{tag:"h3",size:"sm",weight:"semibold",class:"text-muted-800 dark:text-muted-100"},{default:u((()=>[v("span",null,x(e.pool?.name),1)])),_:2},1024),d(E,{lead:"none",weight:"semibold",class:"text-muted-400 !text-[0.65rem] uppercase"},{default:u((()=>[v("span",null,x(a.$t("Pool")),1)])),_:1})]),v("div",null,[d(L,{onClick:a=>function(e){He.value=e,Ye.value=!0}(e),color:"danger",flavor:"outline","data-nui-tooltip":"Delete Duration",condensed:"",class:"ml-4"},{default:u((()=>[d(s,{name:"line-md:close",class:"h-4 w-4"})])),_:2},1032,["onClick"])])])])])),_:2},1024)))),128))])),_:1}),v("div",null,[c(Pe).length>c(Ue)?(p(),w(M,{key:0,"total-items":c(Pe).length,"item-per-page":c(Ue),"current-page":c(Te),shape:"full"},null,8,["total-items","item-per-page","current-page"])):b("",!0)])])):(p(),r("div",le,[d(T,{title:c(Ae)&&""!==c(Ae)?"No matching results":"No results",subtitle:c(Ae)&&""!==c(Ae)?"Looks like we couldn't find any matching results for your search terms. Try other search terms.":"Looks like we don't have any data here yet."},{image:u((()=>[se,oe])),_:1},8,["title","subtitle"])]))])])),_:1}),d(Fe,{open:c(ze),size:"sm",onClose:t[4]||(t[4]=e=>ze.value=!1)},{header:u((()=>[v("div",ce,[v("h3",me,x(a.$t("Create New Duration")),1),d(O,{onClick:t[2]||(t[2]=e=>ze.value=!1)})])])),footer:u((()=>[v("div",ge,[v("div",he,[d(o,{onClick:t[3]||(t[3]=e=>ze.value=!1)},{default:u((()=>[k(x(a.$t("Cancel")),1)])),_:1}),d(o,{color:"primary",flavor:"solid",onClick:c(Xe),disabled:c(Ne),loading:c(Ne)},{default:u((()=>[k(x(a.$t("Create")),1)])),_:1},8,["onClick","disabled","loading"])])])])),default:u((()=>[v("div",pe,[v("div",fe,[v("p",ve,x(a.$t("Please provide a unique duration and timeframe for the new duration"))+". ",1),v("div",xe,[d(c(q),{name:"pool_id"},{default:u((({field:e,errorMessage:a,handleChange:t,handleBlur:l})=>[d(Se,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],error:a,disabled:c(Ne),label:"Pool",placeholder:"Select pool",items:c(Ie),properties:{label:"label",value:"value"},onBlur:l},null,8,["modelValue","onUpdate:modelValue","error","disabled","items","onBlur"])])),_:1}),d(c(q),{name:"duration"},{default:u((({field:e,errorMessage:a,handleChange:t,handleBlur:s})=>[d(l,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],error:a,disabled:c(Ne),type:"number",label:"Duration",placeholder:"Enter duration",onBlur:s},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1}),d(c(q),{name:"interest_rate"},{default:u((({field:e,errorMessage:a,handleChange:t,handleBlur:s})=>[d(l,{modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],error:a,disabled:c(Ne),type:"number",label:"Interest rate %",placeholder:"Enter interest rate",onBlur:s},null,8,["modelValue","onUpdate:modelValue","error","disabled","onBlur"])])),_:1})])])])])),_:1},8,["open"]),d(Fe,{open:c(Ye),size:"sm",onClose:t[8]||(t[8]=e=>Ye.value=!1)},{header:u((()=>[v("div",ye,[v("h3",we,x(a.$t("Delete"))+" "+x(a.$t("Staking Duration")),1),d(O,{onClick:t[5]||(t[5]=e=>Ye.value=!1)})])])),footer:u((()=>[v("div",Ce,[v("div",De,[d(o,{onClick:t[6]||(t[6]=e=>Ye.value=!1)},{default:u((()=>[k(x(a.$t("Cancel")),1)])),_:1}),d(o,{color:"danger",flavor:"solid",onClick:t[7]||(t[7]=e=>async function(){Ge.value=!0;try{const e=await Ve(He.value?.id);z.response(e),"success"===e.status&&$e.removeDuration(He.value?.id)}catch(e){z.danger(e)}Ye.value=!1,Ge.value=!1,He.value=null}()),disabled:c(Ge),loading:c(Ge)},{default:u((()=>[k(x(a.$t("Delete")),1)])),_:1},8,["disabled","loading"])])])])),default:u((()=>[v("div",ke,[v("div",be,[v("h3",_e,x(a.$t("Are you sure?")),1),v("p",je,x(a.$t("Do you really want to delete this"))+" "+x(a.$t("duration"))+" "+x(a.$t("This process cannot be undone"))+". ",1)])])])),_:1},8,["open"])])}}});export{Be as default};
